(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function i(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=i(r);fetch(r.href,o)}})();function Hp(m){return m&&m.__esModule&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m}var nu={exports:{}},ka={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qg;function Vy(){if(Qg)return ka;Qg=1;var m=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function i(s,r,o){var c=null;if(o!==void 0&&(c=""+o),r.key!==void 0&&(c=""+r.key),"key"in r){o={};for(var u in r)u!=="key"&&(o[u]=r[u])}else o=r;return r=o.ref,{$$typeof:m,type:s,key:c,ref:r!==void 0?r:null,props:o}}return ka.Fragment=t,ka.jsx=i,ka.jsxs=i,ka}var Zg;function Xy(){return Zg||(Zg=1,nu.exports=Vy()),nu.exports}var j=Xy(),su={exports:{}},gt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wg;function Yy(){if(Wg)return gt;Wg=1;var m=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),b=Symbol.iterator;function A(C){return C===null||typeof C!="object"?null:(C=b&&C[b]||C["@@iterator"],typeof C=="function"?C:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,x={};function E(C,F,Y){this.props=C,this.context=F,this.refs=x,this.updater=Y||_}E.prototype.isReactComponent={},E.prototype.setState=function(C,F){if(typeof C!="object"&&typeof C!="function"&&C!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,C,F,"setState")},E.prototype.forceUpdate=function(C){this.updater.enqueueForceUpdate(this,C,"forceUpdate")};function D(){}D.prototype=E.prototype;function T(C,F,Y){this.props=C,this.context=F,this.refs=x,this.updater=Y||_}var B=T.prototype=new D;B.constructor=T,S(B,E.prototype),B.isPureReactComponent=!0;var N=Array.isArray;function k(){}var z={H:null,A:null,T:null,S:null},K=Object.prototype.hasOwnProperty;function Q(C,F,Y){var tt=Y.ref;return{$$typeof:m,type:C,key:F,ref:tt!==void 0?tt:null,props:Y}}function et(C,F){return Q(C.type,F,C.props)}function W(C){return typeof C=="object"&&C!==null&&C.$$typeof===m}function dt(C){var F={"=":"=0",":":"=2"};return"$"+C.replace(/[=:]/g,function(Y){return F[Y]})}var _t=/\/+/g;function ft(C,F){return typeof C=="object"&&C!==null&&C.key!=null?dt(""+C.key):F.toString(36)}function xt(C){switch(C.status){case"fulfilled":return C.value;case"rejected":throw C.reason;default:switch(typeof C.status=="string"?C.then(k,k):(C.status="pending",C.then(function(F){C.status==="pending"&&(C.status="fulfilled",C.value=F)},function(F){C.status==="pending"&&(C.status="rejected",C.reason=F)})),C.status){case"fulfilled":return C.value;case"rejected":throw C.reason}}throw C}function O(C,F,Y,tt,Z){var lt=typeof C;(lt==="undefined"||lt==="boolean")&&(C=null);var ut=!1;if(C===null)ut=!0;else switch(lt){case"bigint":case"string":case"number":ut=!0;break;case"object":switch(C.$$typeof){case m:case t:ut=!0;break;case p:return ut=C._init,O(ut(C._payload),F,Y,tt,Z)}}if(ut)return Z=Z(C),ut=tt===""?"."+ft(C,0):tt,N(Z)?(Y="",ut!=null&&(Y=ut.replace(_t,"$&/")+"/"),O(Z,F,Y,"",function(Xt){return Xt})):Z!=null&&(W(Z)&&(Z=et(Z,Y+(Z.key==null||C&&C.key===Z.key?"":(""+Z.key).replace(_t,"$&/")+"/")+ut)),F.push(Z)),1;ut=0;var Kt=tt===""?".":tt+":";if(N(C))for(var kt=0;kt<C.length;kt++)tt=C[kt],lt=Kt+ft(tt,kt),ut+=O(tt,F,Y,lt,Z);else if(kt=A(C),typeof kt=="function")for(C=kt.call(C),kt=0;!(tt=C.next()).done;)tt=tt.value,lt=Kt+ft(tt,kt++),ut+=O(tt,F,Y,lt,Z);else if(lt==="object"){if(typeof C.then=="function")return O(xt(C),F,Y,tt,Z);throw F=String(C),Error("Objects are not valid as a React child (found: "+(F==="[object Object]"?"object with keys {"+Object.keys(C).join(", ")+"}":F)+"). If you meant to render a collection of children, use an array instead.")}return ut}function G(C,F,Y){if(C==null)return C;var tt=[],Z=0;return O(C,tt,"","",function(lt){return F.call(Y,lt,Z++)}),tt}function J(C){if(C._status===-1){var F=C._result;F=F(),F.then(function(Y){(C._status===0||C._status===-1)&&(C._status=1,C._result=Y)},function(Y){(C._status===0||C._status===-1)&&(C._status=2,C._result=Y)}),C._status===-1&&(C._status=0,C._result=F)}if(C._status===1)return C._result.default;throw C._result}var $=typeof reportError=="function"?reportError:function(C){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var F=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof C=="object"&&C!==null&&typeof C.message=="string"?String(C.message):String(C),error:C});if(!window.dispatchEvent(F))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",C);return}console.error(C)},st={map:G,forEach:function(C,F,Y){G(C,function(){F.apply(this,arguments)},Y)},count:function(C){var F=0;return G(C,function(){F++}),F},toArray:function(C){return G(C,function(F){return F})||[]},only:function(C){if(!W(C))throw Error("React.Children.only expected to receive a single React element child.");return C}};return gt.Activity=y,gt.Children=st,gt.Component=E,gt.Fragment=i,gt.Profiler=r,gt.PureComponent=T,gt.StrictMode=s,gt.Suspense=h,gt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=z,gt.__COMPILER_RUNTIME={__proto__:null,c:function(C){return z.H.useMemoCache(C)}},gt.cache=function(C){return function(){return C.apply(null,arguments)}},gt.cacheSignal=function(){return null},gt.cloneElement=function(C,F,Y){if(C==null)throw Error("The argument must be a React element, but you passed "+C+".");var tt=S({},C.props),Z=C.key;if(F!=null)for(lt in F.key!==void 0&&(Z=""+F.key),F)!K.call(F,lt)||lt==="key"||lt==="__self"||lt==="__source"||lt==="ref"&&F.ref===void 0||(tt[lt]=F[lt]);var lt=arguments.length-2;if(lt===1)tt.children=Y;else if(1<lt){for(var ut=Array(lt),Kt=0;Kt<lt;Kt++)ut[Kt]=arguments[Kt+2];tt.children=ut}return Q(C.type,Z,tt)},gt.createContext=function(C){return C={$$typeof:c,_currentValue:C,_currentValue2:C,_threadCount:0,Provider:null,Consumer:null},C.Provider=C,C.Consumer={$$typeof:o,_context:C},C},gt.createElement=function(C,F,Y){var tt,Z={},lt=null;if(F!=null)for(tt in F.key!==void 0&&(lt=""+F.key),F)K.call(F,tt)&&tt!=="key"&&tt!=="__self"&&tt!=="__source"&&(Z[tt]=F[tt]);var ut=arguments.length-2;if(ut===1)Z.children=Y;else if(1<ut){for(var Kt=Array(ut),kt=0;kt<ut;kt++)Kt[kt]=arguments[kt+2];Z.children=Kt}if(C&&C.defaultProps)for(tt in ut=C.defaultProps,ut)Z[tt]===void 0&&(Z[tt]=ut[tt]);return Q(C,lt,Z)},gt.createRef=function(){return{current:null}},gt.forwardRef=function(C){return{$$typeof:u,render:C}},gt.isValidElement=W,gt.lazy=function(C){return{$$typeof:p,_payload:{_status:-1,_result:C},_init:J}},gt.memo=function(C,F){return{$$typeof:f,type:C,compare:F===void 0?null:F}},gt.startTransition=function(C){var F=z.T,Y={};z.T=Y;try{var tt=C(),Z=z.S;Z!==null&&Z(Y,tt),typeof tt=="object"&&tt!==null&&typeof tt.then=="function"&&tt.then(k,$)}catch(lt){$(lt)}finally{F!==null&&Y.types!==null&&(F.types=Y.types),z.T=F}},gt.unstable_useCacheRefresh=function(){return z.H.useCacheRefresh()},gt.use=function(C){return z.H.use(C)},gt.useActionState=function(C,F,Y){return z.H.useActionState(C,F,Y)},gt.useCallback=function(C,F){return z.H.useCallback(C,F)},gt.useContext=function(C){return z.H.useContext(C)},gt.useDebugValue=function(){},gt.useDeferredValue=function(C,F){return z.H.useDeferredValue(C,F)},gt.useEffect=function(C,F){return z.H.useEffect(C,F)},gt.useEffectEvent=function(C){return z.H.useEffectEvent(C)},gt.useId=function(){return z.H.useId()},gt.useImperativeHandle=function(C,F,Y){return z.H.useImperativeHandle(C,F,Y)},gt.useInsertionEffect=function(C,F){return z.H.useInsertionEffect(C,F)},gt.useLayoutEffect=function(C,F){return z.H.useLayoutEffect(C,F)},gt.useMemo=function(C,F){return z.H.useMemo(C,F)},gt.useOptimistic=function(C,F){return z.H.useOptimistic(C,F)},gt.useReducer=function(C,F,Y){return z.H.useReducer(C,F,Y)},gt.useRef=function(C){return z.H.useRef(C)},gt.useState=function(C){return z.H.useState(C)},gt.useSyncExternalStore=function(C,F,Y){return z.H.useSyncExternalStore(C,F,Y)},gt.useTransition=function(){return z.H.useTransition()},gt.version="19.2.3",gt}var Jg;function Lu(){return Jg||(Jg=1,su.exports=Yy()),su.exports}var ne=Lu();const Ky=Hp(ne);var au={exports:{}},Ba={},ru={exports:{}},lu={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tp;function $y(){return tp||(tp=1,(function(m){function t(O,G){var J=O.length;O.push(G);t:for(;0<J;){var $=J-1>>>1,st=O[$];if(0<r(st,G))O[$]=G,O[J]=st,J=$;else break t}}function i(O){return O.length===0?null:O[0]}function s(O){if(O.length===0)return null;var G=O[0],J=O.pop();if(J!==G){O[0]=J;t:for(var $=0,st=O.length,C=st>>>1;$<C;){var F=2*($+1)-1,Y=O[F],tt=F+1,Z=O[tt];if(0>r(Y,J))tt<st&&0>r(Z,Y)?(O[$]=Z,O[tt]=J,$=tt):(O[$]=Y,O[F]=J,$=F);else if(tt<st&&0>r(Z,J))O[$]=Z,O[tt]=J,$=tt;else break t}}return G}function r(O,G){var J=O.sortIndex-G.sortIndex;return J!==0?J:O.id-G.id}if(m.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;m.unstable_now=function(){return o.now()}}else{var c=Date,u=c.now();m.unstable_now=function(){return c.now()-u}}var h=[],f=[],p=1,y=null,b=3,A=!1,_=!1,S=!1,x=!1,E=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function B(O){for(var G=i(f);G!==null;){if(G.callback===null)s(f);else if(G.startTime<=O)s(f),G.sortIndex=G.expirationTime,t(h,G);else break;G=i(f)}}function N(O){if(S=!1,B(O),!_)if(i(h)!==null)_=!0,k||(k=!0,dt());else{var G=i(f);G!==null&&xt(N,G.startTime-O)}}var k=!1,z=-1,K=5,Q=-1;function et(){return x?!0:!(m.unstable_now()-Q<K)}function W(){if(x=!1,k){var O=m.unstable_now();Q=O;var G=!0;try{t:{_=!1,S&&(S=!1,D(z),z=-1),A=!0;var J=b;try{e:{for(B(O),y=i(h);y!==null&&!(y.expirationTime>O&&et());){var $=y.callback;if(typeof $=="function"){y.callback=null,b=y.priorityLevel;var st=$(y.expirationTime<=O);if(O=m.unstable_now(),typeof st=="function"){y.callback=st,B(O),G=!0;break e}y===i(h)&&s(h),B(O)}else s(h);y=i(h)}if(y!==null)G=!0;else{var C=i(f);C!==null&&xt(N,C.startTime-O),G=!1}}break t}finally{y=null,b=J,A=!1}G=void 0}}finally{G?dt():k=!1}}}var dt;if(typeof T=="function")dt=function(){T(W)};else if(typeof MessageChannel<"u"){var _t=new MessageChannel,ft=_t.port2;_t.port1.onmessage=W,dt=function(){ft.postMessage(null)}}else dt=function(){E(W,0)};function xt(O,G){z=E(function(){O(m.unstable_now())},G)}m.unstable_IdlePriority=5,m.unstable_ImmediatePriority=1,m.unstable_LowPriority=4,m.unstable_NormalPriority=3,m.unstable_Profiling=null,m.unstable_UserBlockingPriority=2,m.unstable_cancelCallback=function(O){O.callback=null},m.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):K=0<O?Math.floor(1e3/O):5},m.unstable_getCurrentPriorityLevel=function(){return b},m.unstable_next=function(O){switch(b){case 1:case 2:case 3:var G=3;break;default:G=b}var J=b;b=G;try{return O()}finally{b=J}},m.unstable_requestPaint=function(){x=!0},m.unstable_runWithPriority=function(O,G){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var J=b;b=O;try{return G()}finally{b=J}},m.unstable_scheduleCallback=function(O,G,J){var $=m.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?$+J:$):J=$,O){case 1:var st=-1;break;case 2:st=250;break;case 5:st=1073741823;break;case 4:st=1e4;break;default:st=5e3}return st=J+st,O={id:p++,callback:G,priorityLevel:O,startTime:J,expirationTime:st,sortIndex:-1},J>$?(O.sortIndex=J,t(f,O),i(h)===null&&O===i(f)&&(S?(D(z),z=-1):S=!0,xt(N,J-$))):(O.sortIndex=st,t(h,O),_||A||(_=!0,k||(k=!0,dt()))),O},m.unstable_shouldYield=et,m.unstable_wrapCallback=function(O){var G=b;return function(){var J=b;b=G;try{return O.apply(this,arguments)}finally{b=J}}}})(lu)),lu}var ep;function Qy(){return ep||(ep=1,ru.exports=$y()),ru.exports}var ou={exports:{}},Me={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ip;function Zy(){if(ip)return Me;ip=1;var m=Lu();function t(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var s={d:{f:i,r:function(){throw Error(t(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},r=Symbol.for("react.portal");function o(h,f,p){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:y==null?null:""+y,children:h,containerInfo:f,implementation:p}}var c=m.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Me.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Me.createPortal=function(h,f){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return o(h,f,null,p)},Me.flushSync=function(h){var f=c.T,p=s.p;try{if(c.T=null,s.p=2,h)return h()}finally{c.T=f,s.p=p,s.d.f()}},Me.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,s.d.C(h,f))},Me.prefetchDNS=function(h){typeof h=="string"&&s.d.D(h)},Me.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var p=f.as,y=u(p,f.crossOrigin),b=typeof f.integrity=="string"?f.integrity:void 0,A=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;p==="style"?s.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:y,integrity:b,fetchPriority:A}):p==="script"&&s.d.X(h,{crossOrigin:y,integrity:b,fetchPriority:A,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Me.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var p=u(f.as,f.crossOrigin);s.d.M(h,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&s.d.M(h)},Me.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var p=f.as,y=u(p,f.crossOrigin);s.d.L(h,p,{crossOrigin:y,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Me.preloadModule=function(h,f){if(typeof h=="string")if(f){var p=u(f.as,f.crossOrigin);s.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else s.d.m(h)},Me.requestFormReset=function(h){s.d.r(h)},Me.unstable_batchedUpdates=function(h,f){return h(f)},Me.useFormState=function(h,f,p){return c.H.useFormState(h,f,p)},Me.useFormStatus=function(){return c.H.useHostTransitionStatus()},Me.version="19.2.3",Me}var np;function Wy(){if(np)return ou.exports;np=1;function m(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(m)}catch(t){console.error(t)}}return m(),ou.exports=Zy(),ou.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sp;function Jy(){if(sp)return Ba;sp=1;var m=Qy(),t=Lu(),i=Wy();function s(e){var n="https://react.dev/errors/"+e;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)n+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function o(e){var n=e,a=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(a=n.return),e=n.return;while(e)}return n.tag===3?a:null}function c(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function u(e){if(e.tag===31){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function h(e){if(o(e)!==e)throw Error(s(188))}function f(e){var n=e.alternate;if(!n){if(n=o(e),n===null)throw Error(s(188));return n!==e?null:e}for(var a=e,l=n;;){var d=a.return;if(d===null)break;var g=d.alternate;if(g===null){if(l=d.return,l!==null){a=l;continue}break}if(d.child===g.child){for(g=d.child;g;){if(g===a)return h(d),e;if(g===l)return h(d),n;g=g.sibling}throw Error(s(188))}if(a.return!==l.return)a=d,l=g;else{for(var v=!1,w=d.child;w;){if(w===a){v=!0,a=d,l=g;break}if(w===l){v=!0,l=d,a=g;break}w=w.sibling}if(!v){for(w=g.child;w;){if(w===a){v=!0,a=g,l=d;break}if(w===l){v=!0,l=g,a=d;break}w=w.sibling}if(!v)throw Error(s(189))}}if(a.alternate!==l)throw Error(s(190))}if(a.tag!==3)throw Error(s(188));return a.stateNode.current===a?e:n}function p(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e;for(e=e.child;e!==null;){if(n=p(e),n!==null)return n;e=e.sibling}return null}var y=Object.assign,b=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),D=Symbol.for("react.consumer"),T=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),z=Symbol.for("react.memo"),K=Symbol.for("react.lazy"),Q=Symbol.for("react.activity"),et=Symbol.for("react.memo_cache_sentinel"),W=Symbol.iterator;function dt(e){return e===null||typeof e!="object"?null:(e=W&&e[W]||e["@@iterator"],typeof e=="function"?e:null)}var _t=Symbol.for("react.client.reference");function ft(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===_t?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case S:return"Fragment";case E:return"Profiler";case x:return"StrictMode";case N:return"Suspense";case k:return"SuspenseList";case Q:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case _:return"Portal";case T:return e.displayName||"Context";case D:return(e._context.displayName||"Context")+".Consumer";case B:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case z:return n=e.displayName||null,n!==null?n:ft(e.type)||"Memo";case K:n=e._payload,e=e._init;try{return ft(e(n))}catch{}}return null}var xt=Array.isArray,O=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,G=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J={pending:!1,data:null,method:null,action:null},$=[],st=-1;function C(e){return{current:e}}function F(e){0>st||(e.current=$[st],$[st]=null,st--)}function Y(e,n){st++,$[st]=e.current,e.current=n}var tt=C(null),Z=C(null),lt=C(null),ut=C(null);function Kt(e,n){switch(Y(lt,n),Y(Z,e),Y(tt,null),n.nodeType){case 9:case 11:e=(e=n.documentElement)&&(e=e.namespaceURI)?vg(e):0;break;default:if(e=n.tagName,n=n.namespaceURI)n=vg(n),e=Ag(n,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}F(tt),Y(tt,e)}function kt(){F(tt),F(Z),F(lt)}function Xt(e){e.memoizedState!==null&&Y(ut,e);var n=tt.current,a=Ag(n,e.type);n!==a&&(Y(Z,e),Y(tt,a))}function fe(e){Z.current===e&&(F(tt),F(Z)),ut.current===e&&(F(ut),Ra._currentValue=J)}var Ce,_n;function Ti(e){if(Ce===void 0)try{throw Error()}catch(a){var n=a.stack.trim().match(/\n( *(at )?)/);Ce=n&&n[1]||"",_n=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ce+e+_n}var Ul=!1;function Il(e,n){if(!e||Ul)return"";Ul=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var l={DetermineComponentFrameRoot:function(){try{if(n){var X=function(){throw Error()};if(Object.defineProperty(X.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(X,[])}catch(H){var I=H}Reflect.construct(e,[],X)}else{try{X.call()}catch(H){I=H}e.call(X.prototype)}}else{try{throw Error()}catch(H){I=H}(X=e())&&typeof X.catch=="function"&&X.catch(function(){})}}catch(H){if(H&&I&&typeof H.stack=="string")return[H.stack,I.stack]}return[null,null]}};l.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var d=Object.getOwnPropertyDescriptor(l.DetermineComponentFrameRoot,"name");d&&d.configurable&&Object.defineProperty(l.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=l.DetermineComponentFrameRoot(),v=g[0],w=g[1];if(v&&w){var M=v.split(`
`),U=w.split(`
`);for(d=l=0;l<M.length&&!M[l].includes("DetermineComponentFrameRoot");)l++;for(;d<U.length&&!U[d].includes("DetermineComponentFrameRoot");)d++;if(l===M.length||d===U.length)for(l=M.length-1,d=U.length-1;1<=l&&0<=d&&M[l]!==U[d];)d--;for(;1<=l&&0<=d;l--,d--)if(M[l]!==U[d]){if(l!==1||d!==1)do if(l--,d--,0>d||M[l]!==U[d]){var q=`
`+M[l].replace(" at new "," at ");return e.displayName&&q.includes("<anonymous>")&&(q=q.replace("<anonymous>",e.displayName)),q}while(1<=l&&0<=d);break}}}finally{Ul=!1,Error.prepareStackTrace=a}return(a=e?e.displayName||e.name:"")?Ti(a):""}function _m(e,n){switch(e.tag){case 26:case 27:case 5:return Ti(e.type);case 16:return Ti("Lazy");case 13:return e.child!==n&&n!==null?Ti("Suspense Fallback"):Ti("Suspense");case 19:return Ti("SuspenseList");case 0:case 15:return Il(e.type,!1);case 11:return Il(e.type.render,!1);case 1:return Il(e.type,!0);case 31:return Ti("Activity");default:return""}}function $u(e){try{var n="",a=null;do n+=_m(e,a),a=e,e=e.return;while(e);return n}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}var Hl=Object.prototype.hasOwnProperty,jl=m.unstable_scheduleCallback,Gl=m.unstable_cancelCallback,wm=m.unstable_shouldYield,Em=m.unstable_requestPaint,He=m.unstable_now,xm=m.unstable_getCurrentPriorityLevel,Qu=m.unstable_ImmediatePriority,Zu=m.unstable_UserBlockingPriority,ir=m.unstable_NormalPriority,Tm=m.unstable_LowPriority,Wu=m.unstable_IdlePriority,Cm=m.log,Mm=m.unstable_setDisableYieldValue,js=null,je=null;function Yi(e){if(typeof Cm=="function"&&Mm(e),je&&typeof je.setStrictMode=="function")try{je.setStrictMode(js,e)}catch{}}var Ge=Math.clz32?Math.clz32:Om,Dm=Math.log,Rm=Math.LN2;function Om(e){return e>>>=0,e===0?32:31-(Dm(e)/Rm|0)|0}var nr=256,sr=262144,ar=4194304;function wn(e){var n=e&42;if(n!==0)return n;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function rr(e,n,a){var l=e.pendingLanes;if(l===0)return 0;var d=0,g=e.suspendedLanes,v=e.pingedLanes;e=e.warmLanes;var w=l&134217727;return w!==0?(l=w&~g,l!==0?d=wn(l):(v&=w,v!==0?d=wn(v):a||(a=w&~e,a!==0&&(d=wn(a))))):(w=l&~g,w!==0?d=wn(w):v!==0?d=wn(v):a||(a=l&~e,a!==0&&(d=wn(a)))),d===0?0:n!==0&&n!==d&&(n&g)===0&&(g=d&-d,a=n&-n,g>=a||g===32&&(a&4194048)!==0)?n:d}function Gs(e,n){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&n)===0}function Nm(e,n){switch(e){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ju(){var e=ar;return ar<<=1,(ar&62914560)===0&&(ar=4194304),e}function ql(e){for(var n=[],a=0;31>a;a++)n.push(e);return n}function qs(e,n){e.pendingLanes|=n,n!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Lm(e,n,a,l,d,g){var v=e.pendingLanes;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=a,e.entangledLanes&=a,e.errorRecoveryDisabledLanes&=a,e.shellSuspendCounter=0;var w=e.entanglements,M=e.expirationTimes,U=e.hiddenUpdates;for(a=v&~a;0<a;){var q=31-Ge(a),X=1<<q;w[q]=0,M[q]=-1;var I=U[q];if(I!==null)for(U[q]=null,q=0;q<I.length;q++){var H=I[q];H!==null&&(H.lane&=-536870913)}a&=~X}l!==0&&th(e,l,0),g!==0&&d===0&&e.tag!==0&&(e.suspendedLanes|=g&~(v&~n))}function th(e,n,a){e.pendingLanes|=n,e.suspendedLanes&=~n;var l=31-Ge(n);e.entangledLanes|=n,e.entanglements[l]=e.entanglements[l]|1073741824|a&261930}function eh(e,n){var a=e.entangledLanes|=n;for(e=e.entanglements;a;){var l=31-Ge(a),d=1<<l;d&n|e[l]&n&&(e[l]|=n),a&=~d}}function ih(e,n){var a=n&-n;return a=(a&42)!==0?1:Vl(a),(a&(e.suspendedLanes|n))!==0?0:a}function Vl(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Xl(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function nh(){var e=G.p;return e!==0?e:(e=window.event,e===void 0?32:Gg(e.type))}function sh(e,n){var a=G.p;try{return G.p=e,n()}finally{G.p=a}}var Ki=Math.random().toString(36).slice(2),be="__reactFiber$"+Ki,Ne="__reactProps$"+Ki,Xn="__reactContainer$"+Ki,Yl="__reactEvents$"+Ki,km="__reactListeners$"+Ki,Bm="__reactHandles$"+Ki,ah="__reactResources$"+Ki,Vs="__reactMarker$"+Ki;function Kl(e){delete e[be],delete e[Ne],delete e[Yl],delete e[km],delete e[Bm]}function Yn(e){var n=e[be];if(n)return n;for(var a=e.parentNode;a;){if(n=a[Xn]||a[be]){if(a=n.alternate,n.child!==null||a!==null&&a.child!==null)for(e=Cg(e);e!==null;){if(a=e[be])return a;e=Cg(e)}return n}e=a,a=e.parentNode}return null}function Kn(e){if(e=e[be]||e[Xn]){var n=e.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return e}return null}function Xs(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e.stateNode;throw Error(s(33))}function $n(e){var n=e[ah];return n||(n=e[ah]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function ge(e){e[Vs]=!0}var rh=new Set,lh={};function En(e,n){Qn(e,n),Qn(e+"Capture",n)}function Qn(e,n){for(lh[e]=n,e=0;e<n.length;e++)rh.add(n[e])}var zm=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),oh={},ch={};function Pm(e){return Hl.call(ch,e)?!0:Hl.call(oh,e)?!1:zm.test(e)?ch[e]=!0:(oh[e]=!0,!1)}function lr(e,n,a){if(Pm(n))if(a===null)e.removeAttribute(n);else{switch(typeof a){case"undefined":case"function":case"symbol":e.removeAttribute(n);return;case"boolean":var l=n.toLowerCase().slice(0,5);if(l!=="data-"&&l!=="aria-"){e.removeAttribute(n);return}}e.setAttribute(n,""+a)}}function or(e,n,a){if(a===null)e.removeAttribute(n);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttribute(n,""+a)}}function Ci(e,n,a,l){if(l===null)e.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttributeNS(n,a,""+l)}}function ti(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function uh(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function Fm(e,n,a){var l=Object.getOwnPropertyDescriptor(e.constructor.prototype,n);if(!e.hasOwnProperty(n)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var d=l.get,g=l.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return d.call(this)},set:function(v){a=""+v,g.call(this,v)}}),Object.defineProperty(e,n,{enumerable:l.enumerable}),{getValue:function(){return a},setValue:function(v){a=""+v},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function $l(e){if(!e._valueTracker){var n=uh(e)?"checked":"value";e._valueTracker=Fm(e,n,""+e[n])}}function hh(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var a=n.getValue(),l="";return e&&(l=uh(e)?e.checked?"true":"false":e.value),e=l,e!==a?(n.setValue(e),!0):!1}function cr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Um=/[\n"\\]/g;function ei(e){return e.replace(Um,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function Ql(e,n,a,l,d,g,v,w){e.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?e.type=v:e.removeAttribute("type"),n!=null?v==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+ti(n)):e.value!==""+ti(n)&&(e.value=""+ti(n)):v!=="submit"&&v!=="reset"||e.removeAttribute("value"),n!=null?Zl(e,v,ti(n)):a!=null?Zl(e,v,ti(a)):l!=null&&e.removeAttribute("value"),d==null&&g!=null&&(e.defaultChecked=!!g),d!=null&&(e.checked=d&&typeof d!="function"&&typeof d!="symbol"),w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?e.name=""+ti(w):e.removeAttribute("name")}function dh(e,n,a,l,d,g,v,w){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(e.type=g),n!=null||a!=null){if(!(g!=="submit"&&g!=="reset"||n!=null)){$l(e);return}a=a!=null?""+ti(a):"",n=n!=null?""+ti(n):a,w||n===e.value||(e.value=n),e.defaultValue=n}l=l??d,l=typeof l!="function"&&typeof l!="symbol"&&!!l,e.checked=w?e.checked:!!l,e.defaultChecked=!!l,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(e.name=v),$l(e)}function Zl(e,n,a){n==="number"&&cr(e.ownerDocument)===e||e.defaultValue===""+a||(e.defaultValue=""+a)}function Zn(e,n,a,l){if(e=e.options,n){n={};for(var d=0;d<a.length;d++)n["$"+a[d]]=!0;for(a=0;a<e.length;a++)d=n.hasOwnProperty("$"+e[a].value),e[a].selected!==d&&(e[a].selected=d),d&&l&&(e[a].defaultSelected=!0)}else{for(a=""+ti(a),n=null,d=0;d<e.length;d++){if(e[d].value===a){e[d].selected=!0,l&&(e[d].defaultSelected=!0);return}n!==null||e[d].disabled||(n=e[d])}n!==null&&(n.selected=!0)}}function fh(e,n,a){if(n!=null&&(n=""+ti(n),n!==e.value&&(e.value=n),a==null)){e.defaultValue!==n&&(e.defaultValue=n);return}e.defaultValue=a!=null?""+ti(a):""}function gh(e,n,a,l){if(n==null){if(l!=null){if(a!=null)throw Error(s(92));if(xt(l)){if(1<l.length)throw Error(s(93));l=l[0]}a=l}a==null&&(a=""),n=a}a=ti(n),e.defaultValue=a,l=e.textContent,l===a&&l!==""&&l!==null&&(e.value=l),$l(e)}function Wn(e,n){if(n){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=n;return}}e.textContent=n}var Im=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ph(e,n,a){var l=n.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?l?e.setProperty(n,""):n==="float"?e.cssFloat="":e[n]="":l?e.setProperty(n,a):typeof a!="number"||a===0||Im.has(n)?n==="float"?e.cssFloat=a:e[n]=(""+a).trim():e[n]=a+"px"}function mh(e,n,a){if(n!=null&&typeof n!="object")throw Error(s(62));if(e=e.style,a!=null){for(var l in a)!a.hasOwnProperty(l)||n!=null&&n.hasOwnProperty(l)||(l.indexOf("--")===0?e.setProperty(l,""):l==="float"?e.cssFloat="":e[l]="");for(var d in n)l=n[d],n.hasOwnProperty(d)&&a[d]!==l&&ph(e,d,l)}else for(var g in n)n.hasOwnProperty(g)&&ph(e,g,n[g])}function Wl(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hm=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),jm=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ur(e){return jm.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Mi(){}var Jl=null;function to(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Jn=null,ts=null;function yh(e){var n=Kn(e);if(n&&(e=n.stateNode)){var a=e[Ne]||null;t:switch(e=n.stateNode,n.type){case"input":if(Ql(e,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),n=a.name,a.type==="radio"&&n!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+ei(""+n)+'"][type="radio"]'),n=0;n<a.length;n++){var l=a[n];if(l!==e&&l.form===e.form){var d=l[Ne]||null;if(!d)throw Error(s(90));Ql(l,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name)}}for(n=0;n<a.length;n++)l=a[n],l.form===e.form&&hh(l)}break t;case"textarea":fh(e,a.value,a.defaultValue);break t;case"select":n=a.value,n!=null&&Zn(e,!!a.multiple,n,!1)}}}var eo=!1;function bh(e,n,a){if(eo)return e(n,a);eo=!0;try{var l=e(n);return l}finally{if(eo=!1,(Jn!==null||ts!==null)&&(Zr(),Jn&&(n=Jn,e=ts,ts=Jn=null,yh(n),e)))for(n=0;n<e.length;n++)yh(e[n])}}function Ys(e,n){var a=e.stateNode;if(a===null)return null;var l=a[Ne]||null;if(l===null)return null;a=l[n];t:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break t;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(s(231,n,typeof a));return a}var Di=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),io=!1;if(Di)try{var Ks={};Object.defineProperty(Ks,"passive",{get:function(){io=!0}}),window.addEventListener("test",Ks,Ks),window.removeEventListener("test",Ks,Ks)}catch{io=!1}var $i=null,no=null,hr=null;function vh(){if(hr)return hr;var e,n=no,a=n.length,l,d="value"in $i?$i.value:$i.textContent,g=d.length;for(e=0;e<a&&n[e]===d[e];e++);var v=a-e;for(l=1;l<=v&&n[a-l]===d[g-l];l++);return hr=d.slice(e,1<l?1-l:void 0)}function dr(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function fr(){return!0}function Ah(){return!1}function Le(e){function n(a,l,d,g,v){this._reactName=a,this._targetInst=d,this.type=l,this.nativeEvent=g,this.target=v,this.currentTarget=null;for(var w in e)e.hasOwnProperty(w)&&(a=e[w],this[w]=a?a(g):g[w]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?fr:Ah,this.isPropagationStopped=Ah,this}return y(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=fr)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=fr)},persist:function(){},isPersistent:fr}),n}var xn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gr=Le(xn),$s=y({},xn,{view:0,detail:0}),Gm=Le($s),so,ao,Qs,pr=y({},$s,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lo,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Qs&&(Qs&&e.type==="mousemove"?(so=e.screenX-Qs.screenX,ao=e.screenY-Qs.screenY):ao=so=0,Qs=e),so)},movementY:function(e){return"movementY"in e?e.movementY:ao}}),Sh=Le(pr),qm=y({},pr,{dataTransfer:0}),Vm=Le(qm),Xm=y({},$s,{relatedTarget:0}),ro=Le(Xm),Ym=y({},xn,{animationName:0,elapsedTime:0,pseudoElement:0}),Km=Le(Ym),$m=y({},xn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Qm=Le($m),Zm=y({},xn,{data:0}),_h=Le(Zm),Wm={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Jm={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},t0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function e0(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=t0[e])?!!n[e]:!1}function lo(){return e0}var i0=y({},$s,{key:function(e){if(e.key){var n=Wm[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=dr(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Jm[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lo,charCode:function(e){return e.type==="keypress"?dr(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?dr(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),n0=Le(i0),s0=y({},pr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wh=Le(s0),a0=y({},$s,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lo}),r0=Le(a0),l0=y({},xn,{propertyName:0,elapsedTime:0,pseudoElement:0}),o0=Le(l0),c0=y({},pr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),u0=Le(c0),h0=y({},xn,{newState:0,oldState:0}),d0=Le(h0),f0=[9,13,27,32],oo=Di&&"CompositionEvent"in window,Zs=null;Di&&"documentMode"in document&&(Zs=document.documentMode);var g0=Di&&"TextEvent"in window&&!Zs,Eh=Di&&(!oo||Zs&&8<Zs&&11>=Zs),xh=" ",Th=!1;function Ch(e,n){switch(e){case"keyup":return f0.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mh(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var es=!1;function p0(e,n){switch(e){case"compositionend":return Mh(n);case"keypress":return n.which!==32?null:(Th=!0,xh);case"textInput":return e=n.data,e===xh&&Th?null:e;default:return null}}function m0(e,n){if(es)return e==="compositionend"||!oo&&Ch(e,n)?(e=vh(),hr=no=$i=null,es=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Eh&&n.locale!=="ko"?null:n.data;default:return null}}var y0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Dh(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!y0[e.type]:n==="textarea"}function Rh(e,n,a,l){Jn?ts?ts.push(l):ts=[l]:Jn=l,n=sl(n,"onChange"),0<n.length&&(a=new gr("onChange","change",null,a,l),e.push({event:a,listeners:n}))}var Ws=null,Js=null;function b0(e){fg(e,0)}function mr(e){var n=Xs(e);if(hh(n))return e}function Oh(e,n){if(e==="change")return n}var Nh=!1;if(Di){var co;if(Di){var uo="oninput"in document;if(!uo){var Lh=document.createElement("div");Lh.setAttribute("oninput","return;"),uo=typeof Lh.oninput=="function"}co=uo}else co=!1;Nh=co&&(!document.documentMode||9<document.documentMode)}function kh(){Ws&&(Ws.detachEvent("onpropertychange",Bh),Js=Ws=null)}function Bh(e){if(e.propertyName==="value"&&mr(Js)){var n=[];Rh(n,Js,e,to(e)),bh(b0,n)}}function v0(e,n,a){e==="focusin"?(kh(),Ws=n,Js=a,Ws.attachEvent("onpropertychange",Bh)):e==="focusout"&&kh()}function A0(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return mr(Js)}function S0(e,n){if(e==="click")return mr(n)}function _0(e,n){if(e==="input"||e==="change")return mr(n)}function w0(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var qe=typeof Object.is=="function"?Object.is:w0;function ta(e,n){if(qe(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var a=Object.keys(e),l=Object.keys(n);if(a.length!==l.length)return!1;for(l=0;l<a.length;l++){var d=a[l];if(!Hl.call(n,d)||!qe(e[d],n[d]))return!1}return!0}function zh(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ph(e,n){var a=zh(e);e=0;for(var l;a;){if(a.nodeType===3){if(l=e+a.textContent.length,e<=n&&l>=n)return{node:a,offset:n-e};e=l}t:{for(;a;){if(a.nextSibling){a=a.nextSibling;break t}a=a.parentNode}a=void 0}a=zh(a)}}function Fh(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?Fh(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function Uh(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var n=cr(e.document);n instanceof e.HTMLIFrameElement;){try{var a=typeof n.contentWindow.location.href=="string"}catch{a=!1}if(a)e=n.contentWindow;else break;n=cr(e.document)}return n}function ho(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}var E0=Di&&"documentMode"in document&&11>=document.documentMode,is=null,fo=null,ea=null,go=!1;function Ih(e,n,a){var l=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;go||is==null||is!==cr(l)||(l=is,"selectionStart"in l&&ho(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),ea&&ta(ea,l)||(ea=l,l=sl(fo,"onSelect"),0<l.length&&(n=new gr("onSelect","select",null,n,a),e.push({event:n,listeners:l}),n.target=is)))}function Tn(e,n){var a={};return a[e.toLowerCase()]=n.toLowerCase(),a["Webkit"+e]="webkit"+n,a["Moz"+e]="moz"+n,a}var ns={animationend:Tn("Animation","AnimationEnd"),animationiteration:Tn("Animation","AnimationIteration"),animationstart:Tn("Animation","AnimationStart"),transitionrun:Tn("Transition","TransitionRun"),transitionstart:Tn("Transition","TransitionStart"),transitioncancel:Tn("Transition","TransitionCancel"),transitionend:Tn("Transition","TransitionEnd")},po={},Hh={};Di&&(Hh=document.createElement("div").style,"AnimationEvent"in window||(delete ns.animationend.animation,delete ns.animationiteration.animation,delete ns.animationstart.animation),"TransitionEvent"in window||delete ns.transitionend.transition);function Cn(e){if(po[e])return po[e];if(!ns[e])return e;var n=ns[e],a;for(a in n)if(n.hasOwnProperty(a)&&a in Hh)return po[e]=n[a];return e}var jh=Cn("animationend"),Gh=Cn("animationiteration"),qh=Cn("animationstart"),x0=Cn("transitionrun"),T0=Cn("transitionstart"),C0=Cn("transitioncancel"),Vh=Cn("transitionend"),Xh=new Map,mo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");mo.push("scrollEnd");function gi(e,n){Xh.set(e,n),En(n,[e])}var yr=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},ii=[],ss=0,yo=0;function br(){for(var e=ss,n=yo=ss=0;n<e;){var a=ii[n];ii[n++]=null;var l=ii[n];ii[n++]=null;var d=ii[n];ii[n++]=null;var g=ii[n];if(ii[n++]=null,l!==null&&d!==null){var v=l.pending;v===null?d.next=d:(d.next=v.next,v.next=d),l.pending=d}g!==0&&Yh(a,d,g)}}function vr(e,n,a,l){ii[ss++]=e,ii[ss++]=n,ii[ss++]=a,ii[ss++]=l,yo|=l,e.lanes|=l,e=e.alternate,e!==null&&(e.lanes|=l)}function bo(e,n,a,l){return vr(e,n,a,l),Ar(e)}function Mn(e,n){return vr(e,null,null,n),Ar(e)}function Yh(e,n,a){e.lanes|=a;var l=e.alternate;l!==null&&(l.lanes|=a);for(var d=!1,g=e.return;g!==null;)g.childLanes|=a,l=g.alternate,l!==null&&(l.childLanes|=a),g.tag===22&&(e=g.stateNode,e===null||e._visibility&1||(d=!0)),e=g,g=g.return;return e.tag===3?(g=e.stateNode,d&&n!==null&&(d=31-Ge(a),e=g.hiddenUpdates,l=e[d],l===null?e[d]=[n]:l.push(n),n.lane=a|536870912),g):null}function Ar(e){if(50<wa)throw wa=0,Cc=null,Error(s(185));for(var n=e.return;n!==null;)e=n,n=e.return;return e.tag===3?e.stateNode:null}var as={};function M0(e,n,a,l){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ve(e,n,a,l){return new M0(e,n,a,l)}function vo(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ri(e,n){var a=e.alternate;return a===null?(a=Ve(e.tag,n,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=n,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&65011712,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,n=e.dependencies,a.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a.refCleanup=e.refCleanup,a}function Kh(e,n){e.flags&=65011714;var a=e.alternate;return a===null?(e.childLanes=0,e.lanes=n,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=a.childLanes,e.lanes=a.lanes,e.child=a.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,e.type=a.type,n=a.dependencies,e.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),e}function Sr(e,n,a,l,d,g){var v=0;if(l=e,typeof e=="function")vo(e)&&(v=1);else if(typeof e=="string")v=Ly(e,a,tt.current)?26:e==="html"||e==="head"||e==="body"?27:5;else t:switch(e){case Q:return e=Ve(31,a,n,d),e.elementType=Q,e.lanes=g,e;case S:return Dn(a.children,d,g,n);case x:v=8,d|=24;break;case E:return e=Ve(12,a,n,d|2),e.elementType=E,e.lanes=g,e;case N:return e=Ve(13,a,n,d),e.elementType=N,e.lanes=g,e;case k:return e=Ve(19,a,n,d),e.elementType=k,e.lanes=g,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case T:v=10;break t;case D:v=9;break t;case B:v=11;break t;case z:v=14;break t;case K:v=16,l=null;break t}v=29,a=Error(s(130,e===null?"null":typeof e,"")),l=null}return n=Ve(v,a,n,d),n.elementType=e,n.type=l,n.lanes=g,n}function Dn(e,n,a,l){return e=Ve(7,e,l,n),e.lanes=a,e}function Ao(e,n,a){return e=Ve(6,e,null,n),e.lanes=a,e}function $h(e){var n=Ve(18,null,null,0);return n.stateNode=e,n}function So(e,n,a){return n=Ve(4,e.children!==null?e.children:[],e.key,n),n.lanes=a,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}var Qh=new WeakMap;function ni(e,n){if(typeof e=="object"&&e!==null){var a=Qh.get(e);return a!==void 0?a:(n={value:e,source:n,stack:$u(n)},Qh.set(e,n),n)}return{value:e,source:n,stack:$u(n)}}var rs=[],ls=0,_r=null,ia=0,si=[],ai=0,Qi=null,yi=1,bi="";function Oi(e,n){rs[ls++]=ia,rs[ls++]=_r,_r=e,ia=n}function Zh(e,n,a){si[ai++]=yi,si[ai++]=bi,si[ai++]=Qi,Qi=e;var l=yi;e=bi;var d=32-Ge(l)-1;l&=~(1<<d),a+=1;var g=32-Ge(n)+d;if(30<g){var v=d-d%5;g=(l&(1<<v)-1).toString(32),l>>=v,d-=v,yi=1<<32-Ge(n)+d|a<<d|l,bi=g+e}else yi=1<<g|a<<d|l,bi=e}function _o(e){e.return!==null&&(Oi(e,1),Zh(e,1,0))}function wo(e){for(;e===_r;)_r=rs[--ls],rs[ls]=null,ia=rs[--ls],rs[ls]=null;for(;e===Qi;)Qi=si[--ai],si[ai]=null,bi=si[--ai],si[ai]=null,yi=si[--ai],si[ai]=null}function Wh(e,n){si[ai++]=yi,si[ai++]=bi,si[ai++]=Qi,yi=n.id,bi=n.overflow,Qi=e}var ve=null,qt=null,Tt=!1,Zi=null,ri=!1,Eo=Error(s(519));function Wi(e){var n=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw na(ni(n,e)),Eo}function Jh(e){var n=e.stateNode,a=e.type,l=e.memoizedProps;switch(n[be]=e,n[Ne]=l,a){case"dialog":St("cancel",n),St("close",n);break;case"iframe":case"object":case"embed":St("load",n);break;case"video":case"audio":for(a=0;a<xa.length;a++)St(xa[a],n);break;case"source":St("error",n);break;case"img":case"image":case"link":St("error",n),St("load",n);break;case"details":St("toggle",n);break;case"input":St("invalid",n),dh(n,l.value,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name,!0);break;case"select":St("invalid",n);break;case"textarea":St("invalid",n),gh(n,l.value,l.defaultValue,l.children)}a=l.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||n.textContent===""+a||l.suppressHydrationWarning===!0||yg(n.textContent,a)?(l.popover!=null&&(St("beforetoggle",n),St("toggle",n)),l.onScroll!=null&&St("scroll",n),l.onScrollEnd!=null&&St("scrollend",n),l.onClick!=null&&(n.onclick=Mi),n=!0):n=!1,n||Wi(e,!0)}function td(e){for(ve=e.return;ve;)switch(ve.tag){case 5:case 31:case 13:ri=!1;return;case 27:case 3:ri=!0;return;default:ve=ve.return}}function os(e){if(e!==ve)return!1;if(!Tt)return td(e),Tt=!0,!1;var n=e.tag,a;if((a=n!==3&&n!==27)&&((a=n===5)&&(a=e.type,a=!(a!=="form"&&a!=="button")||jc(e.type,e.memoizedProps)),a=!a),a&&qt&&Wi(e),td(e),n===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));qt=Tg(e)}else if(n===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));qt=Tg(e)}else n===27?(n=qt,fn(e.type)?(e=Yc,Yc=null,qt=e):qt=n):qt=ve?oi(e.stateNode.nextSibling):null;return!0}function Rn(){qt=ve=null,Tt=!1}function xo(){var e=Zi;return e!==null&&(Pe===null?Pe=e:Pe.push.apply(Pe,e),Zi=null),e}function na(e){Zi===null?Zi=[e]:Zi.push(e)}var To=C(null),On=null,Ni=null;function Ji(e,n,a){Y(To,n._currentValue),n._currentValue=a}function Li(e){e._currentValue=To.current,F(To)}function Co(e,n,a){for(;e!==null;){var l=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,l!==null&&(l.childLanes|=n)):l!==null&&(l.childLanes&n)!==n&&(l.childLanes|=n),e===a)break;e=e.return}}function Mo(e,n,a,l){var d=e.child;for(d!==null&&(d.return=e);d!==null;){var g=d.dependencies;if(g!==null){var v=d.child;g=g.firstContext;t:for(;g!==null;){var w=g;g=d;for(var M=0;M<n.length;M++)if(w.context===n[M]){g.lanes|=a,w=g.alternate,w!==null&&(w.lanes|=a),Co(g.return,a,e),l||(v=null);break t}g=w.next}}else if(d.tag===18){if(v=d.return,v===null)throw Error(s(341));v.lanes|=a,g=v.alternate,g!==null&&(g.lanes|=a),Co(v,a,e),v=null}else v=d.child;if(v!==null)v.return=d;else for(v=d;v!==null;){if(v===e){v=null;break}if(d=v.sibling,d!==null){d.return=v.return,v=d;break}v=v.return}d=v}}function cs(e,n,a,l){e=null;for(var d=n,g=!1;d!==null;){if(!g){if((d.flags&524288)!==0)g=!0;else if((d.flags&262144)!==0)break}if(d.tag===10){var v=d.alternate;if(v===null)throw Error(s(387));if(v=v.memoizedProps,v!==null){var w=d.type;qe(d.pendingProps.value,v.value)||(e!==null?e.push(w):e=[w])}}else if(d===ut.current){if(v=d.alternate,v===null)throw Error(s(387));v.memoizedState.memoizedState!==d.memoizedState.memoizedState&&(e!==null?e.push(Ra):e=[Ra])}d=d.return}e!==null&&Mo(n,e,a,l),n.flags|=262144}function wr(e){for(e=e.firstContext;e!==null;){if(!qe(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Nn(e){On=e,Ni=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Ae(e){return ed(On,e)}function Er(e,n){return On===null&&Nn(e),ed(e,n)}function ed(e,n){var a=n._currentValue;if(n={context:n,memoizedValue:a,next:null},Ni===null){if(e===null)throw Error(s(308));Ni=n,e.dependencies={lanes:0,firstContext:n},e.flags|=524288}else Ni=Ni.next=n;return a}var D0=typeof AbortController<"u"?AbortController:function(){var e=[],n=this.signal={aborted:!1,addEventListener:function(a,l){e.push(l)}};this.abort=function(){n.aborted=!0,e.forEach(function(a){return a()})}},R0=m.unstable_scheduleCallback,O0=m.unstable_NormalPriority,se={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Do(){return{controller:new D0,data:new Map,refCount:0}}function sa(e){e.refCount--,e.refCount===0&&R0(O0,function(){e.controller.abort()})}var aa=null,Ro=0,us=0,hs=null;function N0(e,n){if(aa===null){var a=aa=[];Ro=0,us=Lc(),hs={status:"pending",value:void 0,then:function(l){a.push(l)}}}return Ro++,n.then(id,id),n}function id(){if(--Ro===0&&aa!==null){hs!==null&&(hs.status="fulfilled");var e=aa;aa=null,us=0,hs=null;for(var n=0;n<e.length;n++)(0,e[n])()}}function L0(e,n){var a=[],l={status:"pending",value:null,reason:null,then:function(d){a.push(d)}};return e.then(function(){l.status="fulfilled",l.value=n;for(var d=0;d<a.length;d++)(0,a[d])(n)},function(d){for(l.status="rejected",l.reason=d,d=0;d<a.length;d++)(0,a[d])(void 0)}),l}var nd=O.S;O.S=function(e,n){Hf=He(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&N0(e,n),nd!==null&&nd(e,n)};var Ln=C(null);function Oo(){var e=Ln.current;return e!==null?e:jt.pooledCache}function xr(e,n){n===null?Y(Ln,Ln.current):Y(Ln,n.pool)}function sd(){var e=Oo();return e===null?null:{parent:se._currentValue,pool:e}}var ds=Error(s(460)),No=Error(s(474)),Tr=Error(s(542)),Cr={then:function(){}};function ad(e){return e=e.status,e==="fulfilled"||e==="rejected"}function rd(e,n,a){switch(a=e[a],a===void 0?e.push(n):a!==n&&(n.then(Mi,Mi),n=a),n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,od(e),e;default:if(typeof n.status=="string")n.then(Mi,Mi);else{if(e=jt,e!==null&&100<e.shellSuspendCounter)throw Error(s(482));e=n,e.status="pending",e.then(function(l){if(n.status==="pending"){var d=n;d.status="fulfilled",d.value=l}},function(l){if(n.status==="pending"){var d=n;d.status="rejected",d.reason=l}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,od(e),e}throw Bn=n,ds}}function kn(e){try{var n=e._init;return n(e._payload)}catch(a){throw a!==null&&typeof a=="object"&&typeof a.then=="function"?(Bn=a,ds):a}}var Bn=null;function ld(){if(Bn===null)throw Error(s(459));var e=Bn;return Bn=null,e}function od(e){if(e===ds||e===Tr)throw Error(s(483))}var fs=null,ra=0;function Mr(e){var n=ra;return ra+=1,fs===null&&(fs=[]),rd(fs,e,n)}function la(e,n){n=n.props.ref,e.ref=n!==void 0?n:null}function Dr(e,n){throw n.$$typeof===b?Error(s(525)):(e=Object.prototype.toString.call(n),Error(s(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)))}function cd(e){function n(L,R){if(e){var P=L.deletions;P===null?(L.deletions=[R],L.flags|=16):P.push(R)}}function a(L,R){if(!e)return null;for(;R!==null;)n(L,R),R=R.sibling;return null}function l(L){for(var R=new Map;L!==null;)L.key!==null?R.set(L.key,L):R.set(L.index,L),L=L.sibling;return R}function d(L,R){return L=Ri(L,R),L.index=0,L.sibling=null,L}function g(L,R,P){return L.index=P,e?(P=L.alternate,P!==null?(P=P.index,P<R?(L.flags|=67108866,R):P):(L.flags|=67108866,R)):(L.flags|=1048576,R)}function v(L){return e&&L.alternate===null&&(L.flags|=67108866),L}function w(L,R,P,V){return R===null||R.tag!==6?(R=Ao(P,L.mode,V),R.return=L,R):(R=d(R,P),R.return=L,R)}function M(L,R,P,V){var ot=P.type;return ot===S?q(L,R,P.props.children,V,P.key):R!==null&&(R.elementType===ot||typeof ot=="object"&&ot!==null&&ot.$$typeof===K&&kn(ot)===R.type)?(R=d(R,P.props),la(R,P),R.return=L,R):(R=Sr(P.type,P.key,P.props,null,L.mode,V),la(R,P),R.return=L,R)}function U(L,R,P,V){return R===null||R.tag!==4||R.stateNode.containerInfo!==P.containerInfo||R.stateNode.implementation!==P.implementation?(R=So(P,L.mode,V),R.return=L,R):(R=d(R,P.children||[]),R.return=L,R)}function q(L,R,P,V,ot){return R===null||R.tag!==7?(R=Dn(P,L.mode,V,ot),R.return=L,R):(R=d(R,P),R.return=L,R)}function X(L,R,P){if(typeof R=="string"&&R!==""||typeof R=="number"||typeof R=="bigint")return R=Ao(""+R,L.mode,P),R.return=L,R;if(typeof R=="object"&&R!==null){switch(R.$$typeof){case A:return P=Sr(R.type,R.key,R.props,null,L.mode,P),la(P,R),P.return=L,P;case _:return R=So(R,L.mode,P),R.return=L,R;case K:return R=kn(R),X(L,R,P)}if(xt(R)||dt(R))return R=Dn(R,L.mode,P,null),R.return=L,R;if(typeof R.then=="function")return X(L,Mr(R),P);if(R.$$typeof===T)return X(L,Er(L,R),P);Dr(L,R)}return null}function I(L,R,P,V){var ot=R!==null?R.key:null;if(typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint")return ot!==null?null:w(L,R,""+P,V);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case A:return P.key===ot?M(L,R,P,V):null;case _:return P.key===ot?U(L,R,P,V):null;case K:return P=kn(P),I(L,R,P,V)}if(xt(P)||dt(P))return ot!==null?null:q(L,R,P,V,null);if(typeof P.then=="function")return I(L,R,Mr(P),V);if(P.$$typeof===T)return I(L,R,Er(L,P),V);Dr(L,P)}return null}function H(L,R,P,V,ot){if(typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint")return L=L.get(P)||null,w(R,L,""+V,ot);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case A:return L=L.get(V.key===null?P:V.key)||null,M(R,L,V,ot);case _:return L=L.get(V.key===null?P:V.key)||null,U(R,L,V,ot);case K:return V=kn(V),H(L,R,P,V,ot)}if(xt(V)||dt(V))return L=L.get(P)||null,q(R,L,V,ot,null);if(typeof V.then=="function")return H(L,R,P,Mr(V),ot);if(V.$$typeof===T)return H(L,R,P,Er(R,V),ot);Dr(R,V)}return null}function at(L,R,P,V){for(var ot=null,Dt=null,rt=R,vt=R=0,Et=null;rt!==null&&vt<P.length;vt++){rt.index>vt?(Et=rt,rt=null):Et=rt.sibling;var Rt=I(L,rt,P[vt],V);if(Rt===null){rt===null&&(rt=Et);break}e&&rt&&Rt.alternate===null&&n(L,rt),R=g(Rt,R,vt),Dt===null?ot=Rt:Dt.sibling=Rt,Dt=Rt,rt=Et}if(vt===P.length)return a(L,rt),Tt&&Oi(L,vt),ot;if(rt===null){for(;vt<P.length;vt++)rt=X(L,P[vt],V),rt!==null&&(R=g(rt,R,vt),Dt===null?ot=rt:Dt.sibling=rt,Dt=rt);return Tt&&Oi(L,vt),ot}for(rt=l(rt);vt<P.length;vt++)Et=H(rt,L,vt,P[vt],V),Et!==null&&(e&&Et.alternate!==null&&rt.delete(Et.key===null?vt:Et.key),R=g(Et,R,vt),Dt===null?ot=Et:Dt.sibling=Et,Dt=Et);return e&&rt.forEach(function(bn){return n(L,bn)}),Tt&&Oi(L,vt),ot}function ht(L,R,P,V){if(P==null)throw Error(s(151));for(var ot=null,Dt=null,rt=R,vt=R=0,Et=null,Rt=P.next();rt!==null&&!Rt.done;vt++,Rt=P.next()){rt.index>vt?(Et=rt,rt=null):Et=rt.sibling;var bn=I(L,rt,Rt.value,V);if(bn===null){rt===null&&(rt=Et);break}e&&rt&&bn.alternate===null&&n(L,rt),R=g(bn,R,vt),Dt===null?ot=bn:Dt.sibling=bn,Dt=bn,rt=Et}if(Rt.done)return a(L,rt),Tt&&Oi(L,vt),ot;if(rt===null){for(;!Rt.done;vt++,Rt=P.next())Rt=X(L,Rt.value,V),Rt!==null&&(R=g(Rt,R,vt),Dt===null?ot=Rt:Dt.sibling=Rt,Dt=Rt);return Tt&&Oi(L,vt),ot}for(rt=l(rt);!Rt.done;vt++,Rt=P.next())Rt=H(rt,L,vt,Rt.value,V),Rt!==null&&(e&&Rt.alternate!==null&&rt.delete(Rt.key===null?vt:Rt.key),R=g(Rt,R,vt),Dt===null?ot=Rt:Dt.sibling=Rt,Dt=Rt);return e&&rt.forEach(function(qy){return n(L,qy)}),Tt&&Oi(L,vt),ot}function It(L,R,P,V){if(typeof P=="object"&&P!==null&&P.type===S&&P.key===null&&(P=P.props.children),typeof P=="object"&&P!==null){switch(P.$$typeof){case A:t:{for(var ot=P.key;R!==null;){if(R.key===ot){if(ot=P.type,ot===S){if(R.tag===7){a(L,R.sibling),V=d(R,P.props.children),V.return=L,L=V;break t}}else if(R.elementType===ot||typeof ot=="object"&&ot!==null&&ot.$$typeof===K&&kn(ot)===R.type){a(L,R.sibling),V=d(R,P.props),la(V,P),V.return=L,L=V;break t}a(L,R);break}else n(L,R);R=R.sibling}P.type===S?(V=Dn(P.props.children,L.mode,V,P.key),V.return=L,L=V):(V=Sr(P.type,P.key,P.props,null,L.mode,V),la(V,P),V.return=L,L=V)}return v(L);case _:t:{for(ot=P.key;R!==null;){if(R.key===ot)if(R.tag===4&&R.stateNode.containerInfo===P.containerInfo&&R.stateNode.implementation===P.implementation){a(L,R.sibling),V=d(R,P.children||[]),V.return=L,L=V;break t}else{a(L,R);break}else n(L,R);R=R.sibling}V=So(P,L.mode,V),V.return=L,L=V}return v(L);case K:return P=kn(P),It(L,R,P,V)}if(xt(P))return at(L,R,P,V);if(dt(P)){if(ot=dt(P),typeof ot!="function")throw Error(s(150));return P=ot.call(P),ht(L,R,P,V)}if(typeof P.then=="function")return It(L,R,Mr(P),V);if(P.$$typeof===T)return It(L,R,Er(L,P),V);Dr(L,P)}return typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint"?(P=""+P,R!==null&&R.tag===6?(a(L,R.sibling),V=d(R,P),V.return=L,L=V):(a(L,R),V=Ao(P,L.mode,V),V.return=L,L=V),v(L)):a(L,R)}return function(L,R,P,V){try{ra=0;var ot=It(L,R,P,V);return fs=null,ot}catch(rt){if(rt===ds||rt===Tr)throw rt;var Dt=Ve(29,rt,null,L.mode);return Dt.lanes=V,Dt.return=L,Dt}finally{}}}var zn=cd(!0),ud=cd(!1),tn=!1;function Lo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ko(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function en(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function nn(e,n,a){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,(Ot&2)!==0){var d=l.pending;return d===null?n.next=n:(n.next=d.next,d.next=n),l.pending=n,n=Ar(e),Yh(e,null,a),n}return vr(e,l,n,a),Ar(e)}function oa(e,n,a){if(n=n.updateQueue,n!==null&&(n=n.shared,(a&4194048)!==0)){var l=n.lanes;l&=e.pendingLanes,a|=l,n.lanes=a,eh(e,a)}}function Bo(e,n){var a=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,a===l)){var d=null,g=null;if(a=a.firstBaseUpdate,a!==null){do{var v={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};g===null?d=g=v:g=g.next=v,a=a.next}while(a!==null);g===null?d=g=n:g=g.next=n}else d=g=n;a={baseState:l.baseState,firstBaseUpdate:d,lastBaseUpdate:g,shared:l.shared,callbacks:l.callbacks},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=n:e.next=n,a.lastBaseUpdate=n}var zo=!1;function ca(){if(zo){var e=hs;if(e!==null)throw e}}function ua(e,n,a,l){zo=!1;var d=e.updateQueue;tn=!1;var g=d.firstBaseUpdate,v=d.lastBaseUpdate,w=d.shared.pending;if(w!==null){d.shared.pending=null;var M=w,U=M.next;M.next=null,v===null?g=U:v.next=U,v=M;var q=e.alternate;q!==null&&(q=q.updateQueue,w=q.lastBaseUpdate,w!==v&&(w===null?q.firstBaseUpdate=U:w.next=U,q.lastBaseUpdate=M))}if(g!==null){var X=d.baseState;v=0,q=U=M=null,w=g;do{var I=w.lane&-536870913,H=I!==w.lane;if(H?(wt&I)===I:(l&I)===I){I!==0&&I===us&&(zo=!0),q!==null&&(q=q.next={lane:0,tag:w.tag,payload:w.payload,callback:null,next:null});t:{var at=e,ht=w;I=n;var It=a;switch(ht.tag){case 1:if(at=ht.payload,typeof at=="function"){X=at.call(It,X,I);break t}X=at;break t;case 3:at.flags=at.flags&-65537|128;case 0:if(at=ht.payload,I=typeof at=="function"?at.call(It,X,I):at,I==null)break t;X=y({},X,I);break t;case 2:tn=!0}}I=w.callback,I!==null&&(e.flags|=64,H&&(e.flags|=8192),H=d.callbacks,H===null?d.callbacks=[I]:H.push(I))}else H={lane:I,tag:w.tag,payload:w.payload,callback:w.callback,next:null},q===null?(U=q=H,M=X):q=q.next=H,v|=I;if(w=w.next,w===null){if(w=d.shared.pending,w===null)break;H=w,w=H.next,H.next=null,d.lastBaseUpdate=H,d.shared.pending=null}}while(!0);q===null&&(M=X),d.baseState=M,d.firstBaseUpdate=U,d.lastBaseUpdate=q,g===null&&(d.shared.lanes=0),on|=v,e.lanes=v,e.memoizedState=X}}function hd(e,n){if(typeof e!="function")throw Error(s(191,e));e.call(n)}function dd(e,n){var a=e.callbacks;if(a!==null)for(e.callbacks=null,e=0;e<a.length;e++)hd(a[e],n)}var gs=C(null),Rr=C(0);function fd(e,n){e=ji,Y(Rr,e),Y(gs,n),ji=e|n.baseLanes}function Po(){Y(Rr,ji),Y(gs,gs.current)}function Fo(){ji=Rr.current,F(gs),F(Rr)}var Xe=C(null),li=null;function sn(e){var n=e.alternate;Y(te,te.current&1),Y(Xe,e),li===null&&(n===null||gs.current!==null||n.memoizedState!==null)&&(li=e)}function Uo(e){Y(te,te.current),Y(Xe,e),li===null&&(li=e)}function gd(e){e.tag===22?(Y(te,te.current),Y(Xe,e),li===null&&(li=e)):an()}function an(){Y(te,te.current),Y(Xe,Xe.current)}function Ye(e){F(Xe),li===e&&(li=null),F(te)}var te=C(0);function Or(e){for(var n=e;n!==null;){if(n.tag===13){var a=n.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||Vc(a)||Xc(a)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var ki=0,bt=null,Ft=null,ae=null,Nr=!1,ps=!1,Pn=!1,Lr=0,ha=0,ms=null,k0=0;function Zt(){throw Error(s(321))}function Io(e,n){if(n===null)return!1;for(var a=0;a<n.length&&a<e.length;a++)if(!qe(e[a],n[a]))return!1;return!0}function Ho(e,n,a,l,d,g){return ki=g,bt=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,O.H=e===null||e.memoizedState===null?Zd:ic,Pn=!1,g=a(l,d),Pn=!1,ps&&(g=md(n,a,l,d)),pd(e),g}function pd(e){O.H=ga;var n=Ft!==null&&Ft.next!==null;if(ki=0,ae=Ft=bt=null,Nr=!1,ha=0,ms=null,n)throw Error(s(300));e===null||re||(e=e.dependencies,e!==null&&wr(e)&&(re=!0))}function md(e,n,a,l){bt=e;var d=0;do{if(ps&&(ms=null),ha=0,ps=!1,25<=d)throw Error(s(301));if(d+=1,ae=Ft=null,e.updateQueue!=null){var g=e.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}O.H=Wd,g=n(a,l)}while(ps);return g}function B0(){var e=O.H,n=e.useState()[0];return n=typeof n.then=="function"?da(n):n,e=e.useState()[0],(Ft!==null?Ft.memoizedState:null)!==e&&(bt.flags|=1024),n}function jo(){var e=Lr!==0;return Lr=0,e}function Go(e,n,a){n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~a}function qo(e){if(Nr){for(e=e.memoizedState;e!==null;){var n=e.queue;n!==null&&(n.pending=null),e=e.next}Nr=!1}ki=0,ae=Ft=bt=null,ps=!1,ha=Lr=0,ms=null}function De(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ae===null?bt.memoizedState=ae=e:ae=ae.next=e,ae}function ee(){if(Ft===null){var e=bt.alternate;e=e!==null?e.memoizedState:null}else e=Ft.next;var n=ae===null?bt.memoizedState:ae.next;if(n!==null)ae=n,Ft=e;else{if(e===null)throw bt.alternate===null?Error(s(467)):Error(s(310));Ft=e,e={memoizedState:Ft.memoizedState,baseState:Ft.baseState,baseQueue:Ft.baseQueue,queue:Ft.queue,next:null},ae===null?bt.memoizedState=ae=e:ae=ae.next=e}return ae}function kr(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function da(e){var n=ha;return ha+=1,ms===null&&(ms=[]),e=rd(ms,e,n),n=bt,(ae===null?n.memoizedState:ae.next)===null&&(n=n.alternate,O.H=n===null||n.memoizedState===null?Zd:ic),e}function Br(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return da(e);if(e.$$typeof===T)return Ae(e)}throw Error(s(438,String(e)))}function Vo(e){var n=null,a=bt.updateQueue;if(a!==null&&(n=a.memoCache),n==null){var l=bt.alternate;l!==null&&(l=l.updateQueue,l!==null&&(l=l.memoCache,l!=null&&(n={data:l.data.map(function(d){return d.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),a===null&&(a=kr(),bt.updateQueue=a),a.memoCache=n,a=n.data[n.index],a===void 0)for(a=n.data[n.index]=Array(e),l=0;l<e;l++)a[l]=et;return n.index++,a}function Bi(e,n){return typeof n=="function"?n(e):n}function zr(e){var n=ee();return Xo(n,Ft,e)}function Xo(e,n,a){var l=e.queue;if(l===null)throw Error(s(311));l.lastRenderedReducer=a;var d=e.baseQueue,g=l.pending;if(g!==null){if(d!==null){var v=d.next;d.next=g.next,g.next=v}n.baseQueue=d=g,l.pending=null}if(g=e.baseState,d===null)e.memoizedState=g;else{n=d.next;var w=v=null,M=null,U=n,q=!1;do{var X=U.lane&-536870913;if(X!==U.lane?(wt&X)===X:(ki&X)===X){var I=U.revertLane;if(I===0)M!==null&&(M=M.next={lane:0,revertLane:0,gesture:null,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null}),X===us&&(q=!0);else if((ki&I)===I){U=U.next,I===us&&(q=!0);continue}else X={lane:0,revertLane:U.revertLane,gesture:null,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null},M===null?(w=M=X,v=g):M=M.next=X,bt.lanes|=I,on|=I;X=U.action,Pn&&a(g,X),g=U.hasEagerState?U.eagerState:a(g,X)}else I={lane:X,revertLane:U.revertLane,gesture:U.gesture,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null},M===null?(w=M=I,v=g):M=M.next=I,bt.lanes|=X,on|=X;U=U.next}while(U!==null&&U!==n);if(M===null?v=g:M.next=w,!qe(g,e.memoizedState)&&(re=!0,q&&(a=hs,a!==null)))throw a;e.memoizedState=g,e.baseState=v,e.baseQueue=M,l.lastRenderedState=g}return d===null&&(l.lanes=0),[e.memoizedState,l.dispatch]}function Yo(e){var n=ee(),a=n.queue;if(a===null)throw Error(s(311));a.lastRenderedReducer=e;var l=a.dispatch,d=a.pending,g=n.memoizedState;if(d!==null){a.pending=null;var v=d=d.next;do g=e(g,v.action),v=v.next;while(v!==d);qe(g,n.memoizedState)||(re=!0),n.memoizedState=g,n.baseQueue===null&&(n.baseState=g),a.lastRenderedState=g}return[g,l]}function yd(e,n,a){var l=bt,d=ee(),g=Tt;if(g){if(a===void 0)throw Error(s(407));a=a()}else a=n();var v=!qe((Ft||d).memoizedState,a);if(v&&(d.memoizedState=a,re=!0),d=d.queue,Qo(Ad.bind(null,l,d,e),[e]),d.getSnapshot!==n||v||ae!==null&&ae.memoizedState.tag&1){if(l.flags|=2048,ys(9,{destroy:void 0},vd.bind(null,l,d,a,n),null),jt===null)throw Error(s(349));g||(ki&127)!==0||bd(l,n,a)}return a}function bd(e,n,a){e.flags|=16384,e={getSnapshot:n,value:a},n=bt.updateQueue,n===null?(n=kr(),bt.updateQueue=n,n.stores=[e]):(a=n.stores,a===null?n.stores=[e]:a.push(e))}function vd(e,n,a,l){n.value=a,n.getSnapshot=l,Sd(n)&&_d(e)}function Ad(e,n,a){return a(function(){Sd(n)&&_d(e)})}function Sd(e){var n=e.getSnapshot;e=e.value;try{var a=n();return!qe(e,a)}catch{return!0}}function _d(e){var n=Mn(e,2);n!==null&&Fe(n,e,2)}function Ko(e){var n=De();if(typeof e=="function"){var a=e;if(e=a(),Pn){Yi(!0);try{a()}finally{Yi(!1)}}}return n.memoizedState=n.baseState=e,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bi,lastRenderedState:e},n}function wd(e,n,a,l){return e.baseState=a,Xo(e,Ft,typeof l=="function"?l:Bi)}function z0(e,n,a,l,d){if(Ur(e))throw Error(s(485));if(e=n.action,e!==null){var g={payload:d,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){g.listeners.push(v)}};O.T!==null?a(!0):g.isTransition=!1,l(g),a=n.pending,a===null?(g.next=n.pending=g,Ed(n,g)):(g.next=a.next,n.pending=a.next=g)}}function Ed(e,n){var a=n.action,l=n.payload,d=e.state;if(n.isTransition){var g=O.T,v={};O.T=v;try{var w=a(d,l),M=O.S;M!==null&&M(v,w),xd(e,n,w)}catch(U){$o(e,n,U)}finally{g!==null&&v.types!==null&&(g.types=v.types),O.T=g}}else try{g=a(d,l),xd(e,n,g)}catch(U){$o(e,n,U)}}function xd(e,n,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(l){Td(e,n,l)},function(l){return $o(e,n,l)}):Td(e,n,a)}function Td(e,n,a){n.status="fulfilled",n.value=a,Cd(n),e.state=a,n=e.pending,n!==null&&(a=n.next,a===n?e.pending=null:(a=a.next,n.next=a,Ed(e,a)))}function $o(e,n,a){var l=e.pending;if(e.pending=null,l!==null){l=l.next;do n.status="rejected",n.reason=a,Cd(n),n=n.next;while(n!==l)}e.action=null}function Cd(e){e=e.listeners;for(var n=0;n<e.length;n++)(0,e[n])()}function Md(e,n){return n}function Dd(e,n){if(Tt){var a=jt.formState;if(a!==null){t:{var l=bt;if(Tt){if(qt){e:{for(var d=qt,g=ri;d.nodeType!==8;){if(!g){d=null;break e}if(d=oi(d.nextSibling),d===null){d=null;break e}}g=d.data,d=g==="F!"||g==="F"?d:null}if(d){qt=oi(d.nextSibling),l=d.data==="F!";break t}}Wi(l)}l=!1}l&&(n=a[0])}}return a=De(),a.memoizedState=a.baseState=n,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Md,lastRenderedState:n},a.queue=l,a=Kd.bind(null,bt,l),l.dispatch=a,l=Ko(!1),g=ec.bind(null,bt,!1,l.queue),l=De(),d={state:n,dispatch:null,action:e,pending:null},l.queue=d,a=z0.bind(null,bt,d,g,a),d.dispatch=a,l.memoizedState=e,[n,a,!1]}function Rd(e){var n=ee();return Od(n,Ft,e)}function Od(e,n,a){if(n=Xo(e,n,Md)[0],e=zr(Bi)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var l=da(n)}catch(v){throw v===ds?Tr:v}else l=n;n=ee();var d=n.queue,g=d.dispatch;return a!==n.memoizedState&&(bt.flags|=2048,ys(9,{destroy:void 0},P0.bind(null,d,a),null)),[l,g,e]}function P0(e,n){e.action=n}function Nd(e){var n=ee(),a=Ft;if(a!==null)return Od(n,a,e);ee(),n=n.memoizedState,a=ee();var l=a.queue.dispatch;return a.memoizedState=e,[n,l,!1]}function ys(e,n,a,l){return e={tag:e,create:a,deps:l,inst:n,next:null},n=bt.updateQueue,n===null&&(n=kr(),bt.updateQueue=n),a=n.lastEffect,a===null?n.lastEffect=e.next=e:(l=a.next,a.next=e,e.next=l,n.lastEffect=e),e}function Ld(){return ee().memoizedState}function Pr(e,n,a,l){var d=De();bt.flags|=e,d.memoizedState=ys(1|n,{destroy:void 0},a,l===void 0?null:l)}function Fr(e,n,a,l){var d=ee();l=l===void 0?null:l;var g=d.memoizedState.inst;Ft!==null&&l!==null&&Io(l,Ft.memoizedState.deps)?d.memoizedState=ys(n,g,a,l):(bt.flags|=e,d.memoizedState=ys(1|n,g,a,l))}function kd(e,n){Pr(8390656,8,e,n)}function Qo(e,n){Fr(2048,8,e,n)}function F0(e){bt.flags|=4;var n=bt.updateQueue;if(n===null)n=kr(),bt.updateQueue=n,n.events=[e];else{var a=n.events;a===null?n.events=[e]:a.push(e)}}function Bd(e){var n=ee().memoizedState;return F0({ref:n,nextImpl:e}),function(){if((Ot&2)!==0)throw Error(s(440));return n.impl.apply(void 0,arguments)}}function zd(e,n){return Fr(4,2,e,n)}function Pd(e,n){return Fr(4,4,e,n)}function Fd(e,n){if(typeof n=="function"){e=e();var a=n(e);return function(){typeof a=="function"?a():n(null)}}if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function Ud(e,n,a){a=a!=null?a.concat([e]):null,Fr(4,4,Fd.bind(null,n,e),a)}function Zo(){}function Id(e,n){var a=ee();n=n===void 0?null:n;var l=a.memoizedState;return n!==null&&Io(n,l[1])?l[0]:(a.memoizedState=[e,n],e)}function Hd(e,n){var a=ee();n=n===void 0?null:n;var l=a.memoizedState;if(n!==null&&Io(n,l[1]))return l[0];if(l=e(),Pn){Yi(!0);try{e()}finally{Yi(!1)}}return a.memoizedState=[l,n],l}function Wo(e,n,a){return a===void 0||(ki&1073741824)!==0&&(wt&261930)===0?e.memoizedState=n:(e.memoizedState=a,e=Gf(),bt.lanes|=e,on|=e,a)}function jd(e,n,a,l){return qe(a,n)?a:gs.current!==null?(e=Wo(e,a,l),qe(e,n)||(re=!0),e):(ki&42)===0||(ki&1073741824)!==0&&(wt&261930)===0?(re=!0,e.memoizedState=a):(e=Gf(),bt.lanes|=e,on|=e,n)}function Gd(e,n,a,l,d){var g=G.p;G.p=g!==0&&8>g?g:8;var v=O.T,w={};O.T=w,ec(e,!1,n,a);try{var M=d(),U=O.S;if(U!==null&&U(w,M),M!==null&&typeof M=="object"&&typeof M.then=="function"){var q=L0(M,l);fa(e,n,q,Qe(e))}else fa(e,n,l,Qe(e))}catch(X){fa(e,n,{then:function(){},status:"rejected",reason:X},Qe())}finally{G.p=g,v!==null&&w.types!==null&&(v.types=w.types),O.T=v}}function U0(){}function Jo(e,n,a,l){if(e.tag!==5)throw Error(s(476));var d=qd(e).queue;Gd(e,d,n,J,a===null?U0:function(){return Vd(e),a(l)})}function qd(e){var n=e.memoizedState;if(n!==null)return n;n={memoizedState:J,baseState:J,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bi,lastRenderedState:J},next:null};var a={};return n.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bi,lastRenderedState:a},next:null},e.memoizedState=n,e=e.alternate,e!==null&&(e.memoizedState=n),n}function Vd(e){var n=qd(e);n.next===null&&(n=e.alternate.memoizedState),fa(e,n.next.queue,{},Qe())}function tc(){return Ae(Ra)}function Xd(){return ee().memoizedState}function Yd(){return ee().memoizedState}function I0(e){for(var n=e.return;n!==null;){switch(n.tag){case 24:case 3:var a=Qe();e=en(a);var l=nn(n,e,a);l!==null&&(Fe(l,n,a),oa(l,n,a)),n={cache:Do()},e.payload=n;return}n=n.return}}function H0(e,n,a){var l=Qe();a={lane:l,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},Ur(e)?$d(n,a):(a=bo(e,n,a,l),a!==null&&(Fe(a,e,l),Qd(a,n,l)))}function Kd(e,n,a){var l=Qe();fa(e,n,a,l)}function fa(e,n,a,l){var d={lane:l,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(Ur(e))$d(n,d);else{var g=e.alternate;if(e.lanes===0&&(g===null||g.lanes===0)&&(g=n.lastRenderedReducer,g!==null))try{var v=n.lastRenderedState,w=g(v,a);if(d.hasEagerState=!0,d.eagerState=w,qe(w,v))return vr(e,n,d,0),jt===null&&br(),!1}catch{}finally{}if(a=bo(e,n,d,l),a!==null)return Fe(a,e,l),Qd(a,n,l),!0}return!1}function ec(e,n,a,l){if(l={lane:2,revertLane:Lc(),gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Ur(e)){if(n)throw Error(s(479))}else n=bo(e,a,l,2),n!==null&&Fe(n,e,2)}function Ur(e){var n=e.alternate;return e===bt||n!==null&&n===bt}function $d(e,n){ps=Nr=!0;var a=e.pending;a===null?n.next=n:(n.next=a.next,a.next=n),e.pending=n}function Qd(e,n,a){if((a&4194048)!==0){var l=n.lanes;l&=e.pendingLanes,a|=l,n.lanes=a,eh(e,a)}}var ga={readContext:Ae,use:Br,useCallback:Zt,useContext:Zt,useEffect:Zt,useImperativeHandle:Zt,useLayoutEffect:Zt,useInsertionEffect:Zt,useMemo:Zt,useReducer:Zt,useRef:Zt,useState:Zt,useDebugValue:Zt,useDeferredValue:Zt,useTransition:Zt,useSyncExternalStore:Zt,useId:Zt,useHostTransitionStatus:Zt,useFormState:Zt,useActionState:Zt,useOptimistic:Zt,useMemoCache:Zt,useCacheRefresh:Zt};ga.useEffectEvent=Zt;var Zd={readContext:Ae,use:Br,useCallback:function(e,n){return De().memoizedState=[e,n===void 0?null:n],e},useContext:Ae,useEffect:kd,useImperativeHandle:function(e,n,a){a=a!=null?a.concat([e]):null,Pr(4194308,4,Fd.bind(null,n,e),a)},useLayoutEffect:function(e,n){return Pr(4194308,4,e,n)},useInsertionEffect:function(e,n){Pr(4,2,e,n)},useMemo:function(e,n){var a=De();n=n===void 0?null:n;var l=e();if(Pn){Yi(!0);try{e()}finally{Yi(!1)}}return a.memoizedState=[l,n],l},useReducer:function(e,n,a){var l=De();if(a!==void 0){var d=a(n);if(Pn){Yi(!0);try{a(n)}finally{Yi(!1)}}}else d=n;return l.memoizedState=l.baseState=d,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:d},l.queue=e,e=e.dispatch=H0.bind(null,bt,e),[l.memoizedState,e]},useRef:function(e){var n=De();return e={current:e},n.memoizedState=e},useState:function(e){e=Ko(e);var n=e.queue,a=Kd.bind(null,bt,n);return n.dispatch=a,[e.memoizedState,a]},useDebugValue:Zo,useDeferredValue:function(e,n){var a=De();return Wo(a,e,n)},useTransition:function(){var e=Ko(!1);return e=Gd.bind(null,bt,e.queue,!0,!1),De().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,n,a){var l=bt,d=De();if(Tt){if(a===void 0)throw Error(s(407));a=a()}else{if(a=n(),jt===null)throw Error(s(349));(wt&127)!==0||bd(l,n,a)}d.memoizedState=a;var g={value:a,getSnapshot:n};return d.queue=g,kd(Ad.bind(null,l,g,e),[e]),l.flags|=2048,ys(9,{destroy:void 0},vd.bind(null,l,g,a,n),null),a},useId:function(){var e=De(),n=jt.identifierPrefix;if(Tt){var a=bi,l=yi;a=(l&~(1<<32-Ge(l)-1)).toString(32)+a,n="_"+n+"R_"+a,a=Lr++,0<a&&(n+="H"+a.toString(32)),n+="_"}else a=k0++,n="_"+n+"r_"+a.toString(32)+"_";return e.memoizedState=n},useHostTransitionStatus:tc,useFormState:Dd,useActionState:Dd,useOptimistic:function(e){var n=De();n.memoizedState=n.baseState=e;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=a,n=ec.bind(null,bt,!0,a),a.dispatch=n,[e,n]},useMemoCache:Vo,useCacheRefresh:function(){return De().memoizedState=I0.bind(null,bt)},useEffectEvent:function(e){var n=De(),a={impl:e};return n.memoizedState=a,function(){if((Ot&2)!==0)throw Error(s(440));return a.impl.apply(void 0,arguments)}}},ic={readContext:Ae,use:Br,useCallback:Id,useContext:Ae,useEffect:Qo,useImperativeHandle:Ud,useInsertionEffect:zd,useLayoutEffect:Pd,useMemo:Hd,useReducer:zr,useRef:Ld,useState:function(){return zr(Bi)},useDebugValue:Zo,useDeferredValue:function(e,n){var a=ee();return jd(a,Ft.memoizedState,e,n)},useTransition:function(){var e=zr(Bi)[0],n=ee().memoizedState;return[typeof e=="boolean"?e:da(e),n]},useSyncExternalStore:yd,useId:Xd,useHostTransitionStatus:tc,useFormState:Rd,useActionState:Rd,useOptimistic:function(e,n){var a=ee();return wd(a,Ft,e,n)},useMemoCache:Vo,useCacheRefresh:Yd};ic.useEffectEvent=Bd;var Wd={readContext:Ae,use:Br,useCallback:Id,useContext:Ae,useEffect:Qo,useImperativeHandle:Ud,useInsertionEffect:zd,useLayoutEffect:Pd,useMemo:Hd,useReducer:Yo,useRef:Ld,useState:function(){return Yo(Bi)},useDebugValue:Zo,useDeferredValue:function(e,n){var a=ee();return Ft===null?Wo(a,e,n):jd(a,Ft.memoizedState,e,n)},useTransition:function(){var e=Yo(Bi)[0],n=ee().memoizedState;return[typeof e=="boolean"?e:da(e),n]},useSyncExternalStore:yd,useId:Xd,useHostTransitionStatus:tc,useFormState:Nd,useActionState:Nd,useOptimistic:function(e,n){var a=ee();return Ft!==null?wd(a,Ft,e,n):(a.baseState=e,[e,a.queue.dispatch])},useMemoCache:Vo,useCacheRefresh:Yd};Wd.useEffectEvent=Bd;function nc(e,n,a,l){n=e.memoizedState,a=a(l,n),a=a==null?n:y({},n,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var sc={enqueueSetState:function(e,n,a){e=e._reactInternals;var l=Qe(),d=en(l);d.payload=n,a!=null&&(d.callback=a),n=nn(e,d,l),n!==null&&(Fe(n,e,l),oa(n,e,l))},enqueueReplaceState:function(e,n,a){e=e._reactInternals;var l=Qe(),d=en(l);d.tag=1,d.payload=n,a!=null&&(d.callback=a),n=nn(e,d,l),n!==null&&(Fe(n,e,l),oa(n,e,l))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var a=Qe(),l=en(a);l.tag=2,n!=null&&(l.callback=n),n=nn(e,l,a),n!==null&&(Fe(n,e,a),oa(n,e,a))}};function Jd(e,n,a,l,d,g,v){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,g,v):n.prototype&&n.prototype.isPureReactComponent?!ta(a,l)||!ta(d,g):!0}function tf(e,n,a,l){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(a,l),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(a,l),n.state!==e&&sc.enqueueReplaceState(n,n.state,null)}function Fn(e,n){var a=n;if("ref"in n){a={};for(var l in n)l!=="ref"&&(a[l]=n[l])}if(e=e.defaultProps){a===n&&(a=y({},a));for(var d in e)a[d]===void 0&&(a[d]=e[d])}return a}function ef(e){yr(e)}function nf(e){console.error(e)}function sf(e){yr(e)}function Ir(e,n){try{var a=e.onUncaughtError;a(n.value,{componentStack:n.stack})}catch(l){setTimeout(function(){throw l})}}function af(e,n,a){try{var l=e.onCaughtError;l(a.value,{componentStack:a.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(d){setTimeout(function(){throw d})}}function ac(e,n,a){return a=en(a),a.tag=3,a.payload={element:null},a.callback=function(){Ir(e,n)},a}function rf(e){return e=en(e),e.tag=3,e}function lf(e,n,a,l){var d=a.type.getDerivedStateFromError;if(typeof d=="function"){var g=l.value;e.payload=function(){return d(g)},e.callback=function(){af(n,a,l)}}var v=a.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(e.callback=function(){af(n,a,l),typeof d!="function"&&(cn===null?cn=new Set([this]):cn.add(this));var w=l.stack;this.componentDidCatch(l.value,{componentStack:w!==null?w:""})})}function j0(e,n,a,l,d){if(a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){if(n=a.alternate,n!==null&&cs(n,a,d,!0),a=Xe.current,a!==null){switch(a.tag){case 31:case 13:return li===null?Wr():a.alternate===null&&Wt===0&&(Wt=3),a.flags&=-257,a.flags|=65536,a.lanes=d,l===Cr?a.flags|=16384:(n=a.updateQueue,n===null?a.updateQueue=new Set([l]):n.add(l),Rc(e,l,d)),!1;case 22:return a.flags|=65536,l===Cr?a.flags|=16384:(n=a.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([l])},a.updateQueue=n):(a=n.retryQueue,a===null?n.retryQueue=new Set([l]):a.add(l)),Rc(e,l,d)),!1}throw Error(s(435,a.tag))}return Rc(e,l,d),Wr(),!1}if(Tt)return n=Xe.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=d,l!==Eo&&(e=Error(s(422),{cause:l}),na(ni(e,a)))):(l!==Eo&&(n=Error(s(423),{cause:l}),na(ni(n,a))),e=e.current.alternate,e.flags|=65536,d&=-d,e.lanes|=d,l=ni(l,a),d=ac(e.stateNode,l,d),Bo(e,d),Wt!==4&&(Wt=2)),!1;var g=Error(s(520),{cause:l});if(g=ni(g,a),_a===null?_a=[g]:_a.push(g),Wt!==4&&(Wt=2),n===null)return!0;l=ni(l,a),a=n;do{switch(a.tag){case 3:return a.flags|=65536,e=d&-d,a.lanes|=e,e=ac(a.stateNode,l,e),Bo(a,e),!1;case 1:if(n=a.type,g=a.stateNode,(a.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(cn===null||!cn.has(g))))return a.flags|=65536,d&=-d,a.lanes|=d,d=rf(d),lf(d,e,a,l),Bo(a,d),!1}a=a.return}while(a!==null);return!1}var rc=Error(s(461)),re=!1;function Se(e,n,a,l){n.child=e===null?ud(n,null,a,l):zn(n,e.child,a,l)}function of(e,n,a,l,d){a=a.render;var g=n.ref;if("ref"in l){var v={};for(var w in l)w!=="ref"&&(v[w]=l[w])}else v=l;return Nn(n),l=Ho(e,n,a,v,g,d),w=jo(),e!==null&&!re?(Go(e,n,d),zi(e,n,d)):(Tt&&w&&_o(n),n.flags|=1,Se(e,n,l,d),n.child)}function cf(e,n,a,l,d){if(e===null){var g=a.type;return typeof g=="function"&&!vo(g)&&g.defaultProps===void 0&&a.compare===null?(n.tag=15,n.type=g,uf(e,n,g,l,d)):(e=Sr(a.type,null,l,n,n.mode,d),e.ref=n.ref,e.return=n,n.child=e)}if(g=e.child,!gc(e,d)){var v=g.memoizedProps;if(a=a.compare,a=a!==null?a:ta,a(v,l)&&e.ref===n.ref)return zi(e,n,d)}return n.flags|=1,e=Ri(g,l),e.ref=n.ref,e.return=n,n.child=e}function uf(e,n,a,l,d){if(e!==null){var g=e.memoizedProps;if(ta(g,l)&&e.ref===n.ref)if(re=!1,n.pendingProps=l=g,gc(e,d))(e.flags&131072)!==0&&(re=!0);else return n.lanes=e.lanes,zi(e,n,d)}return lc(e,n,a,l,d)}function hf(e,n,a,l){var d=l.children,g=e!==null?e.memoizedState:null;if(e===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.mode==="hidden"){if((n.flags&128)!==0){if(g=g!==null?g.baseLanes|a:a,e!==null){for(l=n.child=e.child,d=0;l!==null;)d=d|l.lanes|l.childLanes,l=l.sibling;l=d&~g}else l=0,n.child=null;return df(e,n,g,a,l)}if((a&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},e!==null&&xr(n,g!==null?g.cachePool:null),g!==null?fd(n,g):Po(),gd(n);else return l=n.lanes=536870912,df(e,n,g!==null?g.baseLanes|a:a,a,l)}else g!==null?(xr(n,g.cachePool),fd(n,g),an(),n.memoizedState=null):(e!==null&&xr(n,null),Po(),an());return Se(e,n,d,a),n.child}function pa(e,n){return e!==null&&e.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function df(e,n,a,l,d){var g=Oo();return g=g===null?null:{parent:se._currentValue,pool:g},n.memoizedState={baseLanes:a,cachePool:g},e!==null&&xr(n,null),Po(),gd(n),e!==null&&cs(e,n,l,!0),n.childLanes=d,null}function Hr(e,n){return n=Gr({mode:n.mode,children:n.children},e.mode),n.ref=e.ref,e.child=n,n.return=e,n}function ff(e,n,a){return zn(n,e.child,null,a),e=Hr(n,n.pendingProps),e.flags|=2,Ye(n),n.memoizedState=null,e}function G0(e,n,a){var l=n.pendingProps,d=(n.flags&128)!==0;if(n.flags&=-129,e===null){if(Tt){if(l.mode==="hidden")return e=Hr(n,l),n.lanes=536870912,pa(null,e);if(Uo(n),(e=qt)?(e=xg(e,ri),e=e!==null&&e.data==="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:Qi!==null?{id:yi,overflow:bi}:null,retryLane:536870912,hydrationErrors:null},a=$h(e),a.return=n,n.child=a,ve=n,qt=null)):e=null,e===null)throw Wi(n);return n.lanes=536870912,null}return Hr(n,l)}var g=e.memoizedState;if(g!==null){var v=g.dehydrated;if(Uo(n),d)if(n.flags&256)n.flags&=-257,n=ff(e,n,a);else if(n.memoizedState!==null)n.child=e.child,n.flags|=128,n=null;else throw Error(s(558));else if(re||cs(e,n,a,!1),d=(a&e.childLanes)!==0,re||d){if(l=jt,l!==null&&(v=ih(l,a),v!==0&&v!==g.retryLane))throw g.retryLane=v,Mn(e,v),Fe(l,e,v),rc;Wr(),n=ff(e,n,a)}else e=g.treeContext,qt=oi(v.nextSibling),ve=n,Tt=!0,Zi=null,ri=!1,e!==null&&Wh(n,e),n=Hr(n,l),n.flags|=4096;return n}return e=Ri(e.child,{mode:l.mode,children:l.children}),e.ref=n.ref,n.child=e,e.return=n,e}function jr(e,n){var a=n.ref;if(a===null)e!==null&&e.ref!==null&&(n.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(s(284));(e===null||e.ref!==a)&&(n.flags|=4194816)}}function lc(e,n,a,l,d){return Nn(n),a=Ho(e,n,a,l,void 0,d),l=jo(),e!==null&&!re?(Go(e,n,d),zi(e,n,d)):(Tt&&l&&_o(n),n.flags|=1,Se(e,n,a,d),n.child)}function gf(e,n,a,l,d,g){return Nn(n),n.updateQueue=null,a=md(n,l,a,d),pd(e),l=jo(),e!==null&&!re?(Go(e,n,g),zi(e,n,g)):(Tt&&l&&_o(n),n.flags|=1,Se(e,n,a,g),n.child)}function pf(e,n,a,l,d){if(Nn(n),n.stateNode===null){var g=as,v=a.contextType;typeof v=="object"&&v!==null&&(g=Ae(v)),g=new a(l,g),n.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=sc,n.stateNode=g,g._reactInternals=n,g=n.stateNode,g.props=l,g.state=n.memoizedState,g.refs={},Lo(n),v=a.contextType,g.context=typeof v=="object"&&v!==null?Ae(v):as,g.state=n.memoizedState,v=a.getDerivedStateFromProps,typeof v=="function"&&(nc(n,a,v,l),g.state=n.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(v=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),v!==g.state&&sc.enqueueReplaceState(g,g.state,null),ua(n,l,g,d),ca(),g.state=n.memoizedState),typeof g.componentDidMount=="function"&&(n.flags|=4194308),l=!0}else if(e===null){g=n.stateNode;var w=n.memoizedProps,M=Fn(a,w);g.props=M;var U=g.context,q=a.contextType;v=as,typeof q=="object"&&q!==null&&(v=Ae(q));var X=a.getDerivedStateFromProps;q=typeof X=="function"||typeof g.getSnapshotBeforeUpdate=="function",w=n.pendingProps!==w,q||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(w||U!==v)&&tf(n,g,l,v),tn=!1;var I=n.memoizedState;g.state=I,ua(n,l,g,d),ca(),U=n.memoizedState,w||I!==U||tn?(typeof X=="function"&&(nc(n,a,X,l),U=n.memoizedState),(M=tn||Jd(n,a,M,l,I,U,v))?(q||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(n.flags|=4194308)):(typeof g.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=l,n.memoizedState=U),g.props=l,g.state=U,g.context=v,l=M):(typeof g.componentDidMount=="function"&&(n.flags|=4194308),l=!1)}else{g=n.stateNode,ko(e,n),v=n.memoizedProps,q=Fn(a,v),g.props=q,X=n.pendingProps,I=g.context,U=a.contextType,M=as,typeof U=="object"&&U!==null&&(M=Ae(U)),w=a.getDerivedStateFromProps,(U=typeof w=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(v!==X||I!==M)&&tf(n,g,l,M),tn=!1,I=n.memoizedState,g.state=I,ua(n,l,g,d),ca();var H=n.memoizedState;v!==X||I!==H||tn||e!==null&&e.dependencies!==null&&wr(e.dependencies)?(typeof w=="function"&&(nc(n,a,w,l),H=n.memoizedState),(q=tn||Jd(n,a,q,l,I,H,M)||e!==null&&e.dependencies!==null&&wr(e.dependencies))?(U||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(l,H,M),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(l,H,M)),typeof g.componentDidUpdate=="function"&&(n.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof g.componentDidUpdate!="function"||v===e.memoizedProps&&I===e.memoizedState||(n.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&I===e.memoizedState||(n.flags|=1024),n.memoizedProps=l,n.memoizedState=H),g.props=l,g.state=H,g.context=M,l=q):(typeof g.componentDidUpdate!="function"||v===e.memoizedProps&&I===e.memoizedState||(n.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&I===e.memoizedState||(n.flags|=1024),l=!1)}return g=l,jr(e,n),l=(n.flags&128)!==0,g||l?(g=n.stateNode,a=l&&typeof a.getDerivedStateFromError!="function"?null:g.render(),n.flags|=1,e!==null&&l?(n.child=zn(n,e.child,null,d),n.child=zn(n,null,a,d)):Se(e,n,a,d),n.memoizedState=g.state,e=n.child):e=zi(e,n,d),e}function mf(e,n,a,l){return Rn(),n.flags|=256,Se(e,n,a,l),n.child}var oc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function cc(e){return{baseLanes:e,cachePool:sd()}}function uc(e,n,a){return e=e!==null?e.childLanes&~a:0,n&&(e|=$e),e}function yf(e,n,a){var l=n.pendingProps,d=!1,g=(n.flags&128)!==0,v;if((v=g)||(v=e!==null&&e.memoizedState===null?!1:(te.current&2)!==0),v&&(d=!0,n.flags&=-129),v=(n.flags&32)!==0,n.flags&=-33,e===null){if(Tt){if(d?sn(n):an(),(e=qt)?(e=xg(e,ri),e=e!==null&&e.data!=="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:Qi!==null?{id:yi,overflow:bi}:null,retryLane:536870912,hydrationErrors:null},a=$h(e),a.return=n,n.child=a,ve=n,qt=null)):e=null,e===null)throw Wi(n);return Xc(e)?n.lanes=32:n.lanes=536870912,null}var w=l.children;return l=l.fallback,d?(an(),d=n.mode,w=Gr({mode:"hidden",children:w},d),l=Dn(l,d,a,null),w.return=n,l.return=n,w.sibling=l,n.child=w,l=n.child,l.memoizedState=cc(a),l.childLanes=uc(e,v,a),n.memoizedState=oc,pa(null,l)):(sn(n),hc(n,w))}var M=e.memoizedState;if(M!==null&&(w=M.dehydrated,w!==null)){if(g)n.flags&256?(sn(n),n.flags&=-257,n=dc(e,n,a)):n.memoizedState!==null?(an(),n.child=e.child,n.flags|=128,n=null):(an(),w=l.fallback,d=n.mode,l=Gr({mode:"visible",children:l.children},d),w=Dn(w,d,a,null),w.flags|=2,l.return=n,w.return=n,l.sibling=w,n.child=l,zn(n,e.child,null,a),l=n.child,l.memoizedState=cc(a),l.childLanes=uc(e,v,a),n.memoizedState=oc,n=pa(null,l));else if(sn(n),Xc(w)){if(v=w.nextSibling&&w.nextSibling.dataset,v)var U=v.dgst;v=U,l=Error(s(419)),l.stack="",l.digest=v,na({value:l,source:null,stack:null}),n=dc(e,n,a)}else if(re||cs(e,n,a,!1),v=(a&e.childLanes)!==0,re||v){if(v=jt,v!==null&&(l=ih(v,a),l!==0&&l!==M.retryLane))throw M.retryLane=l,Mn(e,l),Fe(v,e,l),rc;Vc(w)||Wr(),n=dc(e,n,a)}else Vc(w)?(n.flags|=192,n.child=e.child,n=null):(e=M.treeContext,qt=oi(w.nextSibling),ve=n,Tt=!0,Zi=null,ri=!1,e!==null&&Wh(n,e),n=hc(n,l.children),n.flags|=4096);return n}return d?(an(),w=l.fallback,d=n.mode,M=e.child,U=M.sibling,l=Ri(M,{mode:"hidden",children:l.children}),l.subtreeFlags=M.subtreeFlags&65011712,U!==null?w=Ri(U,w):(w=Dn(w,d,a,null),w.flags|=2),w.return=n,l.return=n,l.sibling=w,n.child=l,pa(null,l),l=n.child,w=e.child.memoizedState,w===null?w=cc(a):(d=w.cachePool,d!==null?(M=se._currentValue,d=d.parent!==M?{parent:M,pool:M}:d):d=sd(),w={baseLanes:w.baseLanes|a,cachePool:d}),l.memoizedState=w,l.childLanes=uc(e,v,a),n.memoizedState=oc,pa(e.child,l)):(sn(n),a=e.child,e=a.sibling,a=Ri(a,{mode:"visible",children:l.children}),a.return=n,a.sibling=null,e!==null&&(v=n.deletions,v===null?(n.deletions=[e],n.flags|=16):v.push(e)),n.child=a,n.memoizedState=null,a)}function hc(e,n){return n=Gr({mode:"visible",children:n},e.mode),n.return=e,e.child=n}function Gr(e,n){return e=Ve(22,e,null,n),e.lanes=0,e}function dc(e,n,a){return zn(n,e.child,null,a),e=hc(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function bf(e,n,a){e.lanes|=n;var l=e.alternate;l!==null&&(l.lanes|=n),Co(e.return,n,a)}function fc(e,n,a,l,d,g){var v=e.memoizedState;v===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:l,tail:a,tailMode:d,treeForkCount:g}:(v.isBackwards=n,v.rendering=null,v.renderingStartTime=0,v.last=l,v.tail=a,v.tailMode=d,v.treeForkCount=g)}function vf(e,n,a){var l=n.pendingProps,d=l.revealOrder,g=l.tail;l=l.children;var v=te.current,w=(v&2)!==0;if(w?(v=v&1|2,n.flags|=128):v&=1,Y(te,v),Se(e,n,l,a),l=Tt?ia:0,!w&&e!==null&&(e.flags&128)!==0)t:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&bf(e,a,n);else if(e.tag===19)bf(e,a,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break t;for(;e.sibling===null;){if(e.return===null||e.return===n)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(d){case"forwards":for(a=n.child,d=null;a!==null;)e=a.alternate,e!==null&&Or(e)===null&&(d=a),a=a.sibling;a=d,a===null?(d=n.child,n.child=null):(d=a.sibling,a.sibling=null),fc(n,!1,d,a,g,l);break;case"backwards":case"unstable_legacy-backwards":for(a=null,d=n.child,n.child=null;d!==null;){if(e=d.alternate,e!==null&&Or(e)===null){n.child=d;break}e=d.sibling,d.sibling=a,a=d,d=e}fc(n,!0,a,null,g,l);break;case"together":fc(n,!1,null,null,void 0,l);break;default:n.memoizedState=null}return n.child}function zi(e,n,a){if(e!==null&&(n.dependencies=e.dependencies),on|=n.lanes,(a&n.childLanes)===0)if(e!==null){if(cs(e,n,a,!1),(a&n.childLanes)===0)return null}else return null;if(e!==null&&n.child!==e.child)throw Error(s(153));if(n.child!==null){for(e=n.child,a=Ri(e,e.pendingProps),n.child=a,a.return=n;e.sibling!==null;)e=e.sibling,a=a.sibling=Ri(e,e.pendingProps),a.return=n;a.sibling=null}return n.child}function gc(e,n){return(e.lanes&n)!==0?!0:(e=e.dependencies,!!(e!==null&&wr(e)))}function q0(e,n,a){switch(n.tag){case 3:Kt(n,n.stateNode.containerInfo),Ji(n,se,e.memoizedState.cache),Rn();break;case 27:case 5:Xt(n);break;case 4:Kt(n,n.stateNode.containerInfo);break;case 10:Ji(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,Uo(n),null;break;case 13:var l=n.memoizedState;if(l!==null)return l.dehydrated!==null?(sn(n),n.flags|=128,null):(a&n.child.childLanes)!==0?yf(e,n,a):(sn(n),e=zi(e,n,a),e!==null?e.sibling:null);sn(n);break;case 19:var d=(e.flags&128)!==0;if(l=(a&n.childLanes)!==0,l||(cs(e,n,a,!1),l=(a&n.childLanes)!==0),d){if(l)return vf(e,n,a);n.flags|=128}if(d=n.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),Y(te,te.current),l)break;return null;case 22:return n.lanes=0,hf(e,n,a,n.pendingProps);case 24:Ji(n,se,e.memoizedState.cache)}return zi(e,n,a)}function Af(e,n,a){if(e!==null)if(e.memoizedProps!==n.pendingProps)re=!0;else{if(!gc(e,a)&&(n.flags&128)===0)return re=!1,q0(e,n,a);re=(e.flags&131072)!==0}else re=!1,Tt&&(n.flags&1048576)!==0&&Zh(n,ia,n.index);switch(n.lanes=0,n.tag){case 16:t:{var l=n.pendingProps;if(e=kn(n.elementType),n.type=e,typeof e=="function")vo(e)?(l=Fn(e,l),n.tag=1,n=pf(null,n,e,l,a)):(n.tag=0,n=lc(null,n,e,l,a));else{if(e!=null){var d=e.$$typeof;if(d===B){n.tag=11,n=of(null,n,e,l,a);break t}else if(d===z){n.tag=14,n=cf(null,n,e,l,a);break t}}throw n=ft(e)||e,Error(s(306,n,""))}}return n;case 0:return lc(e,n,n.type,n.pendingProps,a);case 1:return l=n.type,d=Fn(l,n.pendingProps),pf(e,n,l,d,a);case 3:t:{if(Kt(n,n.stateNode.containerInfo),e===null)throw Error(s(387));l=n.pendingProps;var g=n.memoizedState;d=g.element,ko(e,n),ua(n,l,null,a);var v=n.memoizedState;if(l=v.cache,Ji(n,se,l),l!==g.cache&&Mo(n,[se],a,!0),ca(),l=v.element,g.isDehydrated)if(g={element:l,isDehydrated:!1,cache:v.cache},n.updateQueue.baseState=g,n.memoizedState=g,n.flags&256){n=mf(e,n,l,a);break t}else if(l!==d){d=ni(Error(s(424)),n),na(d),n=mf(e,n,l,a);break t}else{switch(e=n.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(qt=oi(e.firstChild),ve=n,Tt=!0,Zi=null,ri=!0,a=ud(n,null,l,a),n.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(Rn(),l===d){n=zi(e,n,a);break t}Se(e,n,l,a)}n=n.child}return n;case 26:return jr(e,n),e===null?(a=Og(n.type,null,n.pendingProps,null))?n.memoizedState=a:Tt||(a=n.type,e=n.pendingProps,l=al(lt.current).createElement(a),l[be]=n,l[Ne]=e,_e(l,a,e),ge(l),n.stateNode=l):n.memoizedState=Og(n.type,e.memoizedProps,n.pendingProps,e.memoizedState),null;case 27:return Xt(n),e===null&&Tt&&(l=n.stateNode=Mg(n.type,n.pendingProps,lt.current),ve=n,ri=!0,d=qt,fn(n.type)?(Yc=d,qt=oi(l.firstChild)):qt=d),Se(e,n,n.pendingProps.children,a),jr(e,n),e===null&&(n.flags|=4194304),n.child;case 5:return e===null&&Tt&&((d=l=qt)&&(l=Ay(l,n.type,n.pendingProps,ri),l!==null?(n.stateNode=l,ve=n,qt=oi(l.firstChild),ri=!1,d=!0):d=!1),d||Wi(n)),Xt(n),d=n.type,g=n.pendingProps,v=e!==null?e.memoizedProps:null,l=g.children,jc(d,g)?l=null:v!==null&&jc(d,v)&&(n.flags|=32),n.memoizedState!==null&&(d=Ho(e,n,B0,null,null,a),Ra._currentValue=d),jr(e,n),Se(e,n,l,a),n.child;case 6:return e===null&&Tt&&((e=a=qt)&&(a=Sy(a,n.pendingProps,ri),a!==null?(n.stateNode=a,ve=n,qt=null,e=!0):e=!1),e||Wi(n)),null;case 13:return yf(e,n,a);case 4:return Kt(n,n.stateNode.containerInfo),l=n.pendingProps,e===null?n.child=zn(n,null,l,a):Se(e,n,l,a),n.child;case 11:return of(e,n,n.type,n.pendingProps,a);case 7:return Se(e,n,n.pendingProps,a),n.child;case 8:return Se(e,n,n.pendingProps.children,a),n.child;case 12:return Se(e,n,n.pendingProps.children,a),n.child;case 10:return l=n.pendingProps,Ji(n,n.type,l.value),Se(e,n,l.children,a),n.child;case 9:return d=n.type._context,l=n.pendingProps.children,Nn(n),d=Ae(d),l=l(d),n.flags|=1,Se(e,n,l,a),n.child;case 14:return cf(e,n,n.type,n.pendingProps,a);case 15:return uf(e,n,n.type,n.pendingProps,a);case 19:return vf(e,n,a);case 31:return G0(e,n,a);case 22:return hf(e,n,a,n.pendingProps);case 24:return Nn(n),l=Ae(se),e===null?(d=Oo(),d===null&&(d=jt,g=Do(),d.pooledCache=g,g.refCount++,g!==null&&(d.pooledCacheLanes|=a),d=g),n.memoizedState={parent:l,cache:d},Lo(n),Ji(n,se,d)):((e.lanes&a)!==0&&(ko(e,n),ua(n,null,null,a),ca()),d=e.memoizedState,g=n.memoizedState,d.parent!==l?(d={parent:l,cache:l},n.memoizedState=d,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=d),Ji(n,se,l)):(l=g.cache,Ji(n,se,l),l!==d.cache&&Mo(n,[se],a,!0))),Se(e,n,n.pendingProps.children,a),n.child;case 29:throw n.pendingProps}throw Error(s(156,n.tag))}function Pi(e){e.flags|=4}function pc(e,n,a,l,d){if((n=(e.mode&32)!==0)&&(n=!1),n){if(e.flags|=16777216,(d&335544128)===d)if(e.stateNode.complete)e.flags|=8192;else if(Yf())e.flags|=8192;else throw Bn=Cr,No}else e.flags&=-16777217}function Sf(e,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!zg(n))if(Yf())e.flags|=8192;else throw Bn=Cr,No}function qr(e,n){n!==null&&(e.flags|=4),e.flags&16384&&(n=e.tag!==22?Ju():536870912,e.lanes|=n,Ss|=n)}function ma(e,n){if(!Tt)switch(e.tailMode){case"hidden":n=e.tail;for(var a=null;n!==null;)n.alternate!==null&&(a=n),n=n.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function Vt(e){var n=e.alternate!==null&&e.alternate.child===e.child,a=0,l=0;if(n)for(var d=e.child;d!==null;)a|=d.lanes|d.childLanes,l|=d.subtreeFlags&65011712,l|=d.flags&65011712,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)a|=d.lanes|d.childLanes,l|=d.subtreeFlags,l|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=l,e.childLanes=a,n}function V0(e,n,a){var l=n.pendingProps;switch(wo(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vt(n),null;case 1:return Vt(n),null;case 3:return a=n.stateNode,l=null,e!==null&&(l=e.memoizedState.cache),n.memoizedState.cache!==l&&(n.flags|=2048),Li(se),kt(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(os(n)?Pi(n):e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,xo())),Vt(n),null;case 26:var d=n.type,g=n.memoizedState;return e===null?(Pi(n),g!==null?(Vt(n),Sf(n,g)):(Vt(n),pc(n,d,null,l,a))):g?g!==e.memoizedState?(Pi(n),Vt(n),Sf(n,g)):(Vt(n),n.flags&=-16777217):(e=e.memoizedProps,e!==l&&Pi(n),Vt(n),pc(n,d,e,l,a)),null;case 27:if(fe(n),a=lt.current,d=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==l&&Pi(n);else{if(!l){if(n.stateNode===null)throw Error(s(166));return Vt(n),null}e=tt.current,os(n)?Jh(n):(e=Mg(d,l,a),n.stateNode=e,Pi(n))}return Vt(n),null;case 5:if(fe(n),d=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==l&&Pi(n);else{if(!l){if(n.stateNode===null)throw Error(s(166));return Vt(n),null}if(g=tt.current,os(n))Jh(n);else{var v=al(lt.current);switch(g){case 1:g=v.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:g=v.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":g=v.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":g=v.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":g=v.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof l.is=="string"?v.createElement("select",{is:l.is}):v.createElement("select"),l.multiple?g.multiple=!0:l.size&&(g.size=l.size);break;default:g=typeof l.is=="string"?v.createElement(d,{is:l.is}):v.createElement(d)}}g[be]=n,g[Ne]=l;t:for(v=n.child;v!==null;){if(v.tag===5||v.tag===6)g.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===n)break t;for(;v.sibling===null;){if(v.return===null||v.return===n)break t;v=v.return}v.sibling.return=v.return,v=v.sibling}n.stateNode=g;t:switch(_e(g,d,l),d){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break t;case"img":l=!0;break t;default:l=!1}l&&Pi(n)}}return Vt(n),pc(n,n.type,e===null?null:e.memoizedProps,n.pendingProps,a),null;case 6:if(e&&n.stateNode!=null)e.memoizedProps!==l&&Pi(n);else{if(typeof l!="string"&&n.stateNode===null)throw Error(s(166));if(e=lt.current,os(n)){if(e=n.stateNode,a=n.memoizedProps,l=null,d=ve,d!==null)switch(d.tag){case 27:case 5:l=d.memoizedProps}e[be]=n,e=!!(e.nodeValue===a||l!==null&&l.suppressHydrationWarning===!0||yg(e.nodeValue,a)),e||Wi(n,!0)}else e=al(e).createTextNode(l),e[be]=n,n.stateNode=e}return Vt(n),null;case 31:if(a=n.memoizedState,e===null||e.memoizedState!==null){if(l=os(n),a!==null){if(e===null){if(!l)throw Error(s(318));if(e=n.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(557));e[be]=n}else Rn(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Vt(n),e=!1}else a=xo(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=a),e=!0;if(!e)return n.flags&256?(Ye(n),n):(Ye(n),null);if((n.flags&128)!==0)throw Error(s(558))}return Vt(n),null;case 13:if(l=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(d=os(n),l!==null&&l.dehydrated!==null){if(e===null){if(!d)throw Error(s(318));if(d=n.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(s(317));d[be]=n}else Rn(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Vt(n),d=!1}else d=xo(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=d),d=!0;if(!d)return n.flags&256?(Ye(n),n):(Ye(n),null)}return Ye(n),(n.flags&128)!==0?(n.lanes=a,n):(a=l!==null,e=e!==null&&e.memoizedState!==null,a&&(l=n.child,d=null,l.alternate!==null&&l.alternate.memoizedState!==null&&l.alternate.memoizedState.cachePool!==null&&(d=l.alternate.memoizedState.cachePool.pool),g=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(g=l.memoizedState.cachePool.pool),g!==d&&(l.flags|=2048)),a!==e&&a&&(n.child.flags|=8192),qr(n,n.updateQueue),Vt(n),null);case 4:return kt(),e===null&&Pc(n.stateNode.containerInfo),Vt(n),null;case 10:return Li(n.type),Vt(n),null;case 19:if(F(te),l=n.memoizedState,l===null)return Vt(n),null;if(d=(n.flags&128)!==0,g=l.rendering,g===null)if(d)ma(l,!1);else{if(Wt!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(g=Or(e),g!==null){for(n.flags|=128,ma(l,!1),e=g.updateQueue,n.updateQueue=e,qr(n,e),n.subtreeFlags=0,e=a,a=n.child;a!==null;)Kh(a,e),a=a.sibling;return Y(te,te.current&1|2),Tt&&Oi(n,l.treeForkCount),n.child}e=e.sibling}l.tail!==null&&He()>$r&&(n.flags|=128,d=!0,ma(l,!1),n.lanes=4194304)}else{if(!d)if(e=Or(g),e!==null){if(n.flags|=128,d=!0,e=e.updateQueue,n.updateQueue=e,qr(n,e),ma(l,!0),l.tail===null&&l.tailMode==="hidden"&&!g.alternate&&!Tt)return Vt(n),null}else 2*He()-l.renderingStartTime>$r&&a!==536870912&&(n.flags|=128,d=!0,ma(l,!1),n.lanes=4194304);l.isBackwards?(g.sibling=n.child,n.child=g):(e=l.last,e!==null?e.sibling=g:n.child=g,l.last=g)}return l.tail!==null?(e=l.tail,l.rendering=e,l.tail=e.sibling,l.renderingStartTime=He(),e.sibling=null,a=te.current,Y(te,d?a&1|2:a&1),Tt&&Oi(n,l.treeForkCount),e):(Vt(n),null);case 22:case 23:return Ye(n),Fo(),l=n.memoizedState!==null,e!==null?e.memoizedState!==null!==l&&(n.flags|=8192):l&&(n.flags|=8192),l?(a&536870912)!==0&&(n.flags&128)===0&&(Vt(n),n.subtreeFlags&6&&(n.flags|=8192)):Vt(n),a=n.updateQueue,a!==null&&qr(n,a.retryQueue),a=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),l=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),l!==a&&(n.flags|=2048),e!==null&&F(Ln),null;case 24:return a=null,e!==null&&(a=e.memoizedState.cache),n.memoizedState.cache!==a&&(n.flags|=2048),Li(se),Vt(n),null;case 25:return null;case 30:return null}throw Error(s(156,n.tag))}function X0(e,n){switch(wo(n),n.tag){case 1:return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return Li(se),kt(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 26:case 27:case 5:return fe(n),null;case 31:if(n.memoizedState!==null){if(Ye(n),n.alternate===null)throw Error(s(340));Rn()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 13:if(Ye(n),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(s(340));Rn()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return F(te),null;case 4:return kt(),null;case 10:return Li(n.type),null;case 22:case 23:return Ye(n),Fo(),e!==null&&F(Ln),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 24:return Li(se),null;case 25:return null;default:return null}}function _f(e,n){switch(wo(n),n.tag){case 3:Li(se),kt();break;case 26:case 27:case 5:fe(n);break;case 4:kt();break;case 31:n.memoizedState!==null&&Ye(n);break;case 13:Ye(n);break;case 19:F(te);break;case 10:Li(n.type);break;case 22:case 23:Ye(n),Fo(),e!==null&&F(Ln);break;case 24:Li(se)}}function ya(e,n){try{var a=n.updateQueue,l=a!==null?a.lastEffect:null;if(l!==null){var d=l.next;a=d;do{if((a.tag&e)===e){l=void 0;var g=a.create,v=a.inst;l=g(),v.destroy=l}a=a.next}while(a!==d)}}catch(w){zt(n,n.return,w)}}function rn(e,n,a){try{var l=n.updateQueue,d=l!==null?l.lastEffect:null;if(d!==null){var g=d.next;l=g;do{if((l.tag&e)===e){var v=l.inst,w=v.destroy;if(w!==void 0){v.destroy=void 0,d=n;var M=a,U=w;try{U()}catch(q){zt(d,M,q)}}}l=l.next}while(l!==g)}}catch(q){zt(n,n.return,q)}}function wf(e){var n=e.updateQueue;if(n!==null){var a=e.stateNode;try{dd(n,a)}catch(l){zt(e,e.return,l)}}}function Ef(e,n,a){a.props=Fn(e.type,e.memoizedProps),a.state=e.memoizedState;try{a.componentWillUnmount()}catch(l){zt(e,n,l)}}function ba(e,n){try{var a=e.ref;if(a!==null){switch(e.tag){case 26:case 27:case 5:var l=e.stateNode;break;case 30:l=e.stateNode;break;default:l=e.stateNode}typeof a=="function"?e.refCleanup=a(l):a.current=l}}catch(d){zt(e,n,d)}}function vi(e,n){var a=e.ref,l=e.refCleanup;if(a!==null)if(typeof l=="function")try{l()}catch(d){zt(e,n,d)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(d){zt(e,n,d)}else a.current=null}function xf(e){var n=e.type,a=e.memoizedProps,l=e.stateNode;try{t:switch(n){case"button":case"input":case"select":case"textarea":a.autoFocus&&l.focus();break t;case"img":a.src?l.src=a.src:a.srcSet&&(l.srcset=a.srcSet)}}catch(d){zt(e,e.return,d)}}function mc(e,n,a){try{var l=e.stateNode;gy(l,e.type,a,n),l[Ne]=n}catch(d){zt(e,e.return,d)}}function Tf(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&fn(e.type)||e.tag===4}function yc(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||Tf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&fn(e.type)||e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function bc(e,n,a){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(e,n):(n=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,n.appendChild(e),a=a._reactRootContainer,a!=null||n.onclick!==null||(n.onclick=Mi));else if(l!==4&&(l===27&&fn(e.type)&&(a=e.stateNode,n=null),e=e.child,e!==null))for(bc(e,n,a),e=e.sibling;e!==null;)bc(e,n,a),e=e.sibling}function Vr(e,n,a){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?a.insertBefore(e,n):a.appendChild(e);else if(l!==4&&(l===27&&fn(e.type)&&(a=e.stateNode),e=e.child,e!==null))for(Vr(e,n,a),e=e.sibling;e!==null;)Vr(e,n,a),e=e.sibling}function Cf(e){var n=e.stateNode,a=e.memoizedProps;try{for(var l=e.type,d=n.attributes;d.length;)n.removeAttributeNode(d[0]);_e(n,l,a),n[be]=e,n[Ne]=a}catch(g){zt(e,e.return,g)}}var Fi=!1,le=!1,vc=!1,Mf=typeof WeakSet=="function"?WeakSet:Set,pe=null;function Y0(e,n){if(e=e.containerInfo,Ic=dl,e=Uh(e),ho(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else t:{a=(a=e.ownerDocument)&&a.defaultView||window;var l=a.getSelection&&a.getSelection();if(l&&l.rangeCount!==0){a=l.anchorNode;var d=l.anchorOffset,g=l.focusNode;l=l.focusOffset;try{a.nodeType,g.nodeType}catch{a=null;break t}var v=0,w=-1,M=-1,U=0,q=0,X=e,I=null;e:for(;;){for(var H;X!==a||d!==0&&X.nodeType!==3||(w=v+d),X!==g||l!==0&&X.nodeType!==3||(M=v+l),X.nodeType===3&&(v+=X.nodeValue.length),(H=X.firstChild)!==null;)I=X,X=H;for(;;){if(X===e)break e;if(I===a&&++U===d&&(w=v),I===g&&++q===l&&(M=v),(H=X.nextSibling)!==null)break;X=I,I=X.parentNode}X=H}a=w===-1||M===-1?null:{start:w,end:M}}else a=null}a=a||{start:0,end:0}}else a=null;for(Hc={focusedElem:e,selectionRange:a},dl=!1,pe=n;pe!==null;)if(n=pe,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,pe=e;else for(;pe!==null;){switch(n=pe,g=n.alternate,e=n.flags,n.tag){case 0:if((e&4)!==0&&(e=n.updateQueue,e=e!==null?e.events:null,e!==null))for(a=0;a<e.length;a++)d=e[a],d.ref.impl=d.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&g!==null){e=void 0,a=n,d=g.memoizedProps,g=g.memoizedState,l=a.stateNode;try{var at=Fn(a.type,d);e=l.getSnapshotBeforeUpdate(at,g),l.__reactInternalSnapshotBeforeUpdate=e}catch(ht){zt(a,a.return,ht)}}break;case 3:if((e&1024)!==0){if(e=n.stateNode.containerInfo,a=e.nodeType,a===9)qc(e);else if(a===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":qc(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(s(163))}if(e=n.sibling,e!==null){e.return=n.return,pe=e;break}pe=n.return}}function Df(e,n,a){var l=a.flags;switch(a.tag){case 0:case 11:case 15:Ii(e,a),l&4&&ya(5,a);break;case 1:if(Ii(e,a),l&4)if(e=a.stateNode,n===null)try{e.componentDidMount()}catch(v){zt(a,a.return,v)}else{var d=Fn(a.type,n.memoizedProps);n=n.memoizedState;try{e.componentDidUpdate(d,n,e.__reactInternalSnapshotBeforeUpdate)}catch(v){zt(a,a.return,v)}}l&64&&wf(a),l&512&&ba(a,a.return);break;case 3:if(Ii(e,a),l&64&&(e=a.updateQueue,e!==null)){if(n=null,a.child!==null)switch(a.child.tag){case 27:case 5:n=a.child.stateNode;break;case 1:n=a.child.stateNode}try{dd(e,n)}catch(v){zt(a,a.return,v)}}break;case 27:n===null&&l&4&&Cf(a);case 26:case 5:Ii(e,a),n===null&&l&4&&xf(a),l&512&&ba(a,a.return);break;case 12:Ii(e,a);break;case 31:Ii(e,a),l&4&&Nf(e,a);break;case 13:Ii(e,a),l&4&&Lf(e,a),l&64&&(e=a.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(a=iy.bind(null,a),_y(e,a))));break;case 22:if(l=a.memoizedState!==null||Fi,!l){n=n!==null&&n.memoizedState!==null||le,d=Fi;var g=le;Fi=l,(le=n)&&!g?Hi(e,a,(a.subtreeFlags&8772)!==0):Ii(e,a),Fi=d,le=g}break;case 30:break;default:Ii(e,a)}}function Rf(e){var n=e.alternate;n!==null&&(e.alternate=null,Rf(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&Kl(n)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Yt=null,ke=!1;function Ui(e,n,a){for(a=a.child;a!==null;)Of(e,n,a),a=a.sibling}function Of(e,n,a){if(je&&typeof je.onCommitFiberUnmount=="function")try{je.onCommitFiberUnmount(js,a)}catch{}switch(a.tag){case 26:le||vi(a,n),Ui(e,n,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:le||vi(a,n);var l=Yt,d=ke;fn(a.type)&&(Yt=a.stateNode,ke=!1),Ui(e,n,a),Ca(a.stateNode),Yt=l,ke=d;break;case 5:le||vi(a,n);case 6:if(l=Yt,d=ke,Yt=null,Ui(e,n,a),Yt=l,ke=d,Yt!==null)if(ke)try{(Yt.nodeType===9?Yt.body:Yt.nodeName==="HTML"?Yt.ownerDocument.body:Yt).removeChild(a.stateNode)}catch(g){zt(a,n,g)}else try{Yt.removeChild(a.stateNode)}catch(g){zt(a,n,g)}break;case 18:Yt!==null&&(ke?(e=Yt,wg(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,a.stateNode),Ds(e)):wg(Yt,a.stateNode));break;case 4:l=Yt,d=ke,Yt=a.stateNode.containerInfo,ke=!0,Ui(e,n,a),Yt=l,ke=d;break;case 0:case 11:case 14:case 15:rn(2,a,n),le||rn(4,a,n),Ui(e,n,a);break;case 1:le||(vi(a,n),l=a.stateNode,typeof l.componentWillUnmount=="function"&&Ef(a,n,l)),Ui(e,n,a);break;case 21:Ui(e,n,a);break;case 22:le=(l=le)||a.memoizedState!==null,Ui(e,n,a),le=l;break;default:Ui(e,n,a)}}function Nf(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Ds(e)}catch(a){zt(n,n.return,a)}}}function Lf(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Ds(e)}catch(a){zt(n,n.return,a)}}function K0(e){switch(e.tag){case 31:case 13:case 19:var n=e.stateNode;return n===null&&(n=e.stateNode=new Mf),n;case 22:return e=e.stateNode,n=e._retryCache,n===null&&(n=e._retryCache=new Mf),n;default:throw Error(s(435,e.tag))}}function Xr(e,n){var a=K0(e);n.forEach(function(l){if(!a.has(l)){a.add(l);var d=ny.bind(null,e,l);l.then(d,d)}})}function Be(e,n){var a=n.deletions;if(a!==null)for(var l=0;l<a.length;l++){var d=a[l],g=e,v=n,w=v;t:for(;w!==null;){switch(w.tag){case 27:if(fn(w.type)){Yt=w.stateNode,ke=!1;break t}break;case 5:Yt=w.stateNode,ke=!1;break t;case 3:case 4:Yt=w.stateNode.containerInfo,ke=!0;break t}w=w.return}if(Yt===null)throw Error(s(160));Of(g,v,d),Yt=null,ke=!1,g=d.alternate,g!==null&&(g.return=null),d.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)kf(n,e),n=n.sibling}var pi=null;function kf(e,n){var a=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Be(n,e),ze(e),l&4&&(rn(3,e,e.return),ya(3,e),rn(5,e,e.return));break;case 1:Be(n,e),ze(e),l&512&&(le||a===null||vi(a,a.return)),l&64&&Fi&&(e=e.updateQueue,e!==null&&(l=e.callbacks,l!==null&&(a=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=a===null?l:a.concat(l))));break;case 26:var d=pi;if(Be(n,e),ze(e),l&512&&(le||a===null||vi(a,a.return)),l&4){var g=a!==null?a.memoizedState:null;if(l=e.memoizedState,a===null)if(l===null)if(e.stateNode===null){t:{l=e.type,a=e.memoizedProps,d=d.ownerDocument||d;e:switch(l){case"title":g=d.getElementsByTagName("title")[0],(!g||g[Vs]||g[be]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=d.createElement(l),d.head.insertBefore(g,d.querySelector("head > title"))),_e(g,l,a),g[be]=e,ge(g),l=g;break t;case"link":var v=kg("link","href",d).get(l+(a.href||""));if(v){for(var w=0;w<v.length;w++)if(g=v[w],g.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&g.getAttribute("rel")===(a.rel==null?null:a.rel)&&g.getAttribute("title")===(a.title==null?null:a.title)&&g.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){v.splice(w,1);break e}}g=d.createElement(l),_e(g,l,a),d.head.appendChild(g);break;case"meta":if(v=kg("meta","content",d).get(l+(a.content||""))){for(w=0;w<v.length;w++)if(g=v[w],g.getAttribute("content")===(a.content==null?null:""+a.content)&&g.getAttribute("name")===(a.name==null?null:a.name)&&g.getAttribute("property")===(a.property==null?null:a.property)&&g.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&g.getAttribute("charset")===(a.charSet==null?null:a.charSet)){v.splice(w,1);break e}}g=d.createElement(l),_e(g,l,a),d.head.appendChild(g);break;default:throw Error(s(468,l))}g[be]=e,ge(g),l=g}e.stateNode=l}else Bg(d,e.type,e.stateNode);else e.stateNode=Lg(d,l,e.memoizedProps);else g!==l?(g===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):g.count--,l===null?Bg(d,e.type,e.stateNode):Lg(d,l,e.memoizedProps)):l===null&&e.stateNode!==null&&mc(e,e.memoizedProps,a.memoizedProps)}break;case 27:Be(n,e),ze(e),l&512&&(le||a===null||vi(a,a.return)),a!==null&&l&4&&mc(e,e.memoizedProps,a.memoizedProps);break;case 5:if(Be(n,e),ze(e),l&512&&(le||a===null||vi(a,a.return)),e.flags&32){d=e.stateNode;try{Wn(d,"")}catch(at){zt(e,e.return,at)}}l&4&&e.stateNode!=null&&(d=e.memoizedProps,mc(e,d,a!==null?a.memoizedProps:d)),l&1024&&(vc=!0);break;case 6:if(Be(n,e),ze(e),l&4){if(e.stateNode===null)throw Error(s(162));l=e.memoizedProps,a=e.stateNode;try{a.nodeValue=l}catch(at){zt(e,e.return,at)}}break;case 3:if(ol=null,d=pi,pi=rl(n.containerInfo),Be(n,e),pi=d,ze(e),l&4&&a!==null&&a.memoizedState.isDehydrated)try{Ds(n.containerInfo)}catch(at){zt(e,e.return,at)}vc&&(vc=!1,Bf(e));break;case 4:l=pi,pi=rl(e.stateNode.containerInfo),Be(n,e),ze(e),pi=l;break;case 12:Be(n,e),ze(e);break;case 31:Be(n,e),ze(e),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,Xr(e,l)));break;case 13:Be(n,e),ze(e),e.child.flags&8192&&e.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(Kr=He()),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,Xr(e,l)));break;case 22:d=e.memoizedState!==null;var M=a!==null&&a.memoizedState!==null,U=Fi,q=le;if(Fi=U||d,le=q||M,Be(n,e),le=q,Fi=U,ze(e),l&8192)t:for(n=e.stateNode,n._visibility=d?n._visibility&-2:n._visibility|1,d&&(a===null||M||Fi||le||Un(e)),a=null,n=e;;){if(n.tag===5||n.tag===26){if(a===null){M=a=n;try{if(g=M.stateNode,d)v=g.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{w=M.stateNode;var X=M.memoizedProps.style,I=X!=null&&X.hasOwnProperty("display")?X.display:null;w.style.display=I==null||typeof I=="boolean"?"":(""+I).trim()}}catch(at){zt(M,M.return,at)}}}else if(n.tag===6){if(a===null){M=n;try{M.stateNode.nodeValue=d?"":M.memoizedProps}catch(at){zt(M,M.return,at)}}}else if(n.tag===18){if(a===null){M=n;try{var H=M.stateNode;d?Eg(H,!0):Eg(M.stateNode,!1)}catch(at){zt(M,M.return,at)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===e)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break t;for(;n.sibling===null;){if(n.return===null||n.return===e)break t;a===n&&(a=null),n=n.return}a===n&&(a=null),n.sibling.return=n.return,n=n.sibling}l&4&&(l=e.updateQueue,l!==null&&(a=l.retryQueue,a!==null&&(l.retryQueue=null,Xr(e,a))));break;case 19:Be(n,e),ze(e),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,Xr(e,l)));break;case 30:break;case 21:break;default:Be(n,e),ze(e)}}function ze(e){var n=e.flags;if(n&2){try{for(var a,l=e.return;l!==null;){if(Tf(l)){a=l;break}l=l.return}if(a==null)throw Error(s(160));switch(a.tag){case 27:var d=a.stateNode,g=yc(e);Vr(e,g,d);break;case 5:var v=a.stateNode;a.flags&32&&(Wn(v,""),a.flags&=-33);var w=yc(e);Vr(e,w,v);break;case 3:case 4:var M=a.stateNode.containerInfo,U=yc(e);bc(e,U,M);break;default:throw Error(s(161))}}catch(q){zt(e,e.return,q)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function Bf(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var n=e;Bf(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),e=e.sibling}}function Ii(e,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)Df(e,n.alternate,n),n=n.sibling}function Un(e){for(e=e.child;e!==null;){var n=e;switch(n.tag){case 0:case 11:case 14:case 15:rn(4,n,n.return),Un(n);break;case 1:vi(n,n.return);var a=n.stateNode;typeof a.componentWillUnmount=="function"&&Ef(n,n.return,a),Un(n);break;case 27:Ca(n.stateNode);case 26:case 5:vi(n,n.return),Un(n);break;case 22:n.memoizedState===null&&Un(n);break;case 30:Un(n);break;default:Un(n)}e=e.sibling}}function Hi(e,n,a){for(a=a&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var l=n.alternate,d=e,g=n,v=g.flags;switch(g.tag){case 0:case 11:case 15:Hi(d,g,a),ya(4,g);break;case 1:if(Hi(d,g,a),l=g,d=l.stateNode,typeof d.componentDidMount=="function")try{d.componentDidMount()}catch(U){zt(l,l.return,U)}if(l=g,d=l.updateQueue,d!==null){var w=l.stateNode;try{var M=d.shared.hiddenCallbacks;if(M!==null)for(d.shared.hiddenCallbacks=null,d=0;d<M.length;d++)hd(M[d],w)}catch(U){zt(l,l.return,U)}}a&&v&64&&wf(g),ba(g,g.return);break;case 27:Cf(g);case 26:case 5:Hi(d,g,a),a&&l===null&&v&4&&xf(g),ba(g,g.return);break;case 12:Hi(d,g,a);break;case 31:Hi(d,g,a),a&&v&4&&Nf(d,g);break;case 13:Hi(d,g,a),a&&v&4&&Lf(d,g);break;case 22:g.memoizedState===null&&Hi(d,g,a),ba(g,g.return);break;case 30:break;default:Hi(d,g,a)}n=n.sibling}}function Ac(e,n){var a=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),e=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(e=n.memoizedState.cachePool.pool),e!==a&&(e!=null&&e.refCount++,a!=null&&sa(a))}function Sc(e,n){e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&sa(e))}function mi(e,n,a,l){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)zf(e,n,a,l),n=n.sibling}function zf(e,n,a,l){var d=n.flags;switch(n.tag){case 0:case 11:case 15:mi(e,n,a,l),d&2048&&ya(9,n);break;case 1:mi(e,n,a,l);break;case 3:mi(e,n,a,l),d&2048&&(e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&sa(e)));break;case 12:if(d&2048){mi(e,n,a,l),e=n.stateNode;try{var g=n.memoizedProps,v=g.id,w=g.onPostCommit;typeof w=="function"&&w(v,n.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(M){zt(n,n.return,M)}}else mi(e,n,a,l);break;case 31:mi(e,n,a,l);break;case 13:mi(e,n,a,l);break;case 23:break;case 22:g=n.stateNode,v=n.alternate,n.memoizedState!==null?g._visibility&2?mi(e,n,a,l):va(e,n):g._visibility&2?mi(e,n,a,l):(g._visibility|=2,bs(e,n,a,l,(n.subtreeFlags&10256)!==0||!1)),d&2048&&Ac(v,n);break;case 24:mi(e,n,a,l),d&2048&&Sc(n.alternate,n);break;default:mi(e,n,a,l)}}function bs(e,n,a,l,d){for(d=d&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var g=e,v=n,w=a,M=l,U=v.flags;switch(v.tag){case 0:case 11:case 15:bs(g,v,w,M,d),ya(8,v);break;case 23:break;case 22:var q=v.stateNode;v.memoizedState!==null?q._visibility&2?bs(g,v,w,M,d):va(g,v):(q._visibility|=2,bs(g,v,w,M,d)),d&&U&2048&&Ac(v.alternate,v);break;case 24:bs(g,v,w,M,d),d&&U&2048&&Sc(v.alternate,v);break;default:bs(g,v,w,M,d)}n=n.sibling}}function va(e,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var a=e,l=n,d=l.flags;switch(l.tag){case 22:va(a,l),d&2048&&Ac(l.alternate,l);break;case 24:va(a,l),d&2048&&Sc(l.alternate,l);break;default:va(a,l)}n=n.sibling}}var Aa=8192;function vs(e,n,a){if(e.subtreeFlags&Aa)for(e=e.child;e!==null;)Pf(e,n,a),e=e.sibling}function Pf(e,n,a){switch(e.tag){case 26:vs(e,n,a),e.flags&Aa&&e.memoizedState!==null&&ky(a,pi,e.memoizedState,e.memoizedProps);break;case 5:vs(e,n,a);break;case 3:case 4:var l=pi;pi=rl(e.stateNode.containerInfo),vs(e,n,a),pi=l;break;case 22:e.memoizedState===null&&(l=e.alternate,l!==null&&l.memoizedState!==null?(l=Aa,Aa=16777216,vs(e,n,a),Aa=l):vs(e,n,a));break;default:vs(e,n,a)}}function Ff(e){var n=e.alternate;if(n!==null&&(e=n.child,e!==null)){n.child=null;do n=e.sibling,e.sibling=null,e=n;while(e!==null)}}function Sa(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var a=0;a<n.length;a++){var l=n[a];pe=l,If(l,e)}Ff(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Uf(e),e=e.sibling}function Uf(e){switch(e.tag){case 0:case 11:case 15:Sa(e),e.flags&2048&&rn(9,e,e.return);break;case 3:Sa(e);break;case 12:Sa(e);break;case 22:var n=e.stateNode;e.memoizedState!==null&&n._visibility&2&&(e.return===null||e.return.tag!==13)?(n._visibility&=-3,Yr(e)):Sa(e);break;default:Sa(e)}}function Yr(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var a=0;a<n.length;a++){var l=n[a];pe=l,If(l,e)}Ff(e)}for(e=e.child;e!==null;){switch(n=e,n.tag){case 0:case 11:case 15:rn(8,n,n.return),Yr(n);break;case 22:a=n.stateNode,a._visibility&2&&(a._visibility&=-3,Yr(n));break;default:Yr(n)}e=e.sibling}}function If(e,n){for(;pe!==null;){var a=pe;switch(a.tag){case 0:case 11:case 15:rn(8,a,n);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var l=a.memoizedState.cachePool.pool;l!=null&&l.refCount++}break;case 24:sa(a.memoizedState.cache)}if(l=a.child,l!==null)l.return=a,pe=l;else t:for(a=e;pe!==null;){l=pe;var d=l.sibling,g=l.return;if(Rf(l),l===a){pe=null;break t}if(d!==null){d.return=g,pe=d;break t}pe=g}}}var $0={getCacheForType:function(e){var n=Ae(se),a=n.data.get(e);return a===void 0&&(a=e(),n.data.set(e,a)),a},cacheSignal:function(){return Ae(se).controller.signal}},Q0=typeof WeakMap=="function"?WeakMap:Map,Ot=0,jt=null,At=null,wt=0,Bt=0,Ke=null,ln=!1,As=!1,_c=!1,ji=0,Wt=0,on=0,In=0,wc=0,$e=0,Ss=0,_a=null,Pe=null,Ec=!1,Kr=0,Hf=0,$r=1/0,Qr=null,cn=null,ue=0,un=null,_s=null,Gi=0,xc=0,Tc=null,jf=null,wa=0,Cc=null;function Qe(){return(Ot&2)!==0&&wt!==0?wt&-wt:O.T!==null?Lc():nh()}function Gf(){if($e===0)if((wt&536870912)===0||Tt){var e=sr;sr<<=1,(sr&3932160)===0&&(sr=262144),$e=e}else $e=536870912;return e=Xe.current,e!==null&&(e.flags|=32),$e}function Fe(e,n,a){(e===jt&&(Bt===2||Bt===9)||e.cancelPendingCommit!==null)&&(ws(e,0),hn(e,wt,$e,!1)),qs(e,a),((Ot&2)===0||e!==jt)&&(e===jt&&((Ot&2)===0&&(In|=a),Wt===4&&hn(e,wt,$e,!1)),Ai(e))}function qf(e,n,a){if((Ot&6)!==0)throw Error(s(327));var l=!a&&(n&127)===0&&(n&e.expiredLanes)===0||Gs(e,n),d=l?J0(e,n):Dc(e,n,!0),g=l;do{if(d===0){As&&!l&&hn(e,n,0,!1);break}else{if(a=e.current.alternate,g&&!Z0(a)){d=Dc(e,n,!1),g=!1;continue}if(d===2){if(g=n,e.errorRecoveryDisabledLanes&g)var v=0;else v=e.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){n=v;t:{var w=e;d=_a;var M=w.current.memoizedState.isDehydrated;if(M&&(ws(w,v).flags|=256),v=Dc(w,v,!1),v!==2){if(_c&&!M){w.errorRecoveryDisabledLanes|=g,In|=g,d=4;break t}g=Pe,Pe=d,g!==null&&(Pe===null?Pe=g:Pe.push.apply(Pe,g))}d=v}if(g=!1,d!==2)continue}}if(d===1){ws(e,0),hn(e,n,0,!0);break}t:{switch(l=e,g=d,g){case 0:case 1:throw Error(s(345));case 4:if((n&4194048)!==n)break;case 6:hn(l,n,$e,!ln);break t;case 2:Pe=null;break;case 3:case 5:break;default:throw Error(s(329))}if((n&62914560)===n&&(d=Kr+300-He(),10<d)){if(hn(l,n,$e,!ln),rr(l,0,!0)!==0)break t;Gi=n,l.timeoutHandle=Sg(Vf.bind(null,l,a,Pe,Qr,Ec,n,$e,In,Ss,ln,g,"Throttled",-0,0),d);break t}Vf(l,a,Pe,Qr,Ec,n,$e,In,Ss,ln,g,null,-0,0)}}break}while(!0);Ai(e)}function Vf(e,n,a,l,d,g,v,w,M,U,q,X,I,H){if(e.timeoutHandle=-1,X=n.subtreeFlags,X&8192||(X&16785408)===16785408){X={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Mi},Pf(n,g,X);var at=(g&62914560)===g?Kr-He():(g&4194048)===g?Hf-He():0;if(at=By(X,at),at!==null){Gi=g,e.cancelPendingCommit=at(Jf.bind(null,e,n,g,a,l,d,v,w,M,q,X,null,I,H)),hn(e,g,v,!U);return}}Jf(e,n,g,a,l,d,v,w,M)}function Z0(e){for(var n=e;;){var a=n.tag;if((a===0||a===11||a===15)&&n.flags&16384&&(a=n.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var l=0;l<a.length;l++){var d=a[l],g=d.getSnapshot;d=d.value;try{if(!qe(g(),d))return!1}catch{return!1}}if(a=n.child,n.subtreeFlags&16384&&a!==null)a.return=n,n=a;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function hn(e,n,a,l){n&=~wc,n&=~In,e.suspendedLanes|=n,e.pingedLanes&=~n,l&&(e.warmLanes|=n),l=e.expirationTimes;for(var d=n;0<d;){var g=31-Ge(d),v=1<<g;l[g]=-1,d&=~v}a!==0&&th(e,a,n)}function Zr(){return(Ot&6)===0?(Ea(0),!1):!0}function Mc(){if(At!==null){if(Bt===0)var e=At.return;else e=At,Ni=On=null,qo(e),fs=null,ra=0,e=At;for(;e!==null;)_f(e.alternate,e),e=e.return;At=null}}function ws(e,n){var a=e.timeoutHandle;a!==-1&&(e.timeoutHandle=-1,yy(a)),a=e.cancelPendingCommit,a!==null&&(e.cancelPendingCommit=null,a()),Gi=0,Mc(),jt=e,At=a=Ri(e.current,null),wt=n,Bt=0,Ke=null,ln=!1,As=Gs(e,n),_c=!1,Ss=$e=wc=In=on=Wt=0,Pe=_a=null,Ec=!1,(n&8)!==0&&(n|=n&32);var l=e.entangledLanes;if(l!==0)for(e=e.entanglements,l&=n;0<l;){var d=31-Ge(l),g=1<<d;n|=e[d],l&=~g}return ji=n,br(),a}function Xf(e,n){bt=null,O.H=ga,n===ds||n===Tr?(n=ld(),Bt=3):n===No?(n=ld(),Bt=4):Bt=n===rc?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,Ke=n,At===null&&(Wt=1,Ir(e,ni(n,e.current)))}function Yf(){var e=Xe.current;return e===null?!0:(wt&4194048)===wt?li===null:(wt&62914560)===wt||(wt&536870912)!==0?e===li:!1}function Kf(){var e=O.H;return O.H=ga,e===null?ga:e}function $f(){var e=O.A;return O.A=$0,e}function Wr(){Wt=4,ln||(wt&4194048)!==wt&&Xe.current!==null||(As=!0),(on&134217727)===0&&(In&134217727)===0||jt===null||hn(jt,wt,$e,!1)}function Dc(e,n,a){var l=Ot;Ot|=2;var d=Kf(),g=$f();(jt!==e||wt!==n)&&(Qr=null,ws(e,n)),n=!1;var v=Wt;t:do try{if(Bt!==0&&At!==null){var w=At,M=Ke;switch(Bt){case 8:Mc(),v=6;break t;case 3:case 2:case 9:case 6:Xe.current===null&&(n=!0);var U=Bt;if(Bt=0,Ke=null,Es(e,w,M,U),a&&As){v=0;break t}break;default:U=Bt,Bt=0,Ke=null,Es(e,w,M,U)}}W0(),v=Wt;break}catch(q){Xf(e,q)}while(!0);return n&&e.shellSuspendCounter++,Ni=On=null,Ot=l,O.H=d,O.A=g,At===null&&(jt=null,wt=0,br()),v}function W0(){for(;At!==null;)Qf(At)}function J0(e,n){var a=Ot;Ot|=2;var l=Kf(),d=$f();jt!==e||wt!==n?(Qr=null,$r=He()+500,ws(e,n)):As=Gs(e,n);t:do try{if(Bt!==0&&At!==null){n=At;var g=Ke;e:switch(Bt){case 1:Bt=0,Ke=null,Es(e,n,g,1);break;case 2:case 9:if(ad(g)){Bt=0,Ke=null,Zf(n);break}n=function(){Bt!==2&&Bt!==9||jt!==e||(Bt=7),Ai(e)},g.then(n,n);break t;case 3:Bt=7;break t;case 4:Bt=5;break t;case 7:ad(g)?(Bt=0,Ke=null,Zf(n)):(Bt=0,Ke=null,Es(e,n,g,7));break;case 5:var v=null;switch(At.tag){case 26:v=At.memoizedState;case 5:case 27:var w=At;if(v?zg(v):w.stateNode.complete){Bt=0,Ke=null;var M=w.sibling;if(M!==null)At=M;else{var U=w.return;U!==null?(At=U,Jr(U)):At=null}break e}}Bt=0,Ke=null,Es(e,n,g,5);break;case 6:Bt=0,Ke=null,Es(e,n,g,6);break;case 8:Mc(),Wt=6;break t;default:throw Error(s(462))}}ty();break}catch(q){Xf(e,q)}while(!0);return Ni=On=null,O.H=l,O.A=d,Ot=a,At!==null?0:(jt=null,wt=0,br(),Wt)}function ty(){for(;At!==null&&!wm();)Qf(At)}function Qf(e){var n=Af(e.alternate,e,ji);e.memoizedProps=e.pendingProps,n===null?Jr(e):At=n}function Zf(e){var n=e,a=n.alternate;switch(n.tag){case 15:case 0:n=gf(a,n,n.pendingProps,n.type,void 0,wt);break;case 11:n=gf(a,n,n.pendingProps,n.type.render,n.ref,wt);break;case 5:qo(n);default:_f(a,n),n=At=Kh(n,ji),n=Af(a,n,ji)}e.memoizedProps=e.pendingProps,n===null?Jr(e):At=n}function Es(e,n,a,l){Ni=On=null,qo(n),fs=null,ra=0;var d=n.return;try{if(j0(e,d,n,a,wt)){Wt=1,Ir(e,ni(a,e.current)),At=null;return}}catch(g){if(d!==null)throw At=d,g;Wt=1,Ir(e,ni(a,e.current)),At=null;return}n.flags&32768?(Tt||l===1?e=!0:As||(wt&536870912)!==0?e=!1:(ln=e=!0,(l===2||l===9||l===3||l===6)&&(l=Xe.current,l!==null&&l.tag===13&&(l.flags|=16384))),Wf(n,e)):Jr(n)}function Jr(e){var n=e;do{if((n.flags&32768)!==0){Wf(n,ln);return}e=n.return;var a=V0(n.alternate,n,ji);if(a!==null){At=a;return}if(n=n.sibling,n!==null){At=n;return}At=n=e}while(n!==null);Wt===0&&(Wt=5)}function Wf(e,n){do{var a=X0(e.alternate,e);if(a!==null){a.flags&=32767,At=a;return}if(a=e.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!n&&(e=e.sibling,e!==null)){At=e;return}At=e=a}while(e!==null);Wt=6,At=null}function Jf(e,n,a,l,d,g,v,w,M){e.cancelPendingCommit=null;do tl();while(ue!==0);if((Ot&6)!==0)throw Error(s(327));if(n!==null){if(n===e.current)throw Error(s(177));if(g=n.lanes|n.childLanes,g|=yo,Lm(e,a,g,v,w,M),e===jt&&(At=jt=null,wt=0),_s=n,un=e,Gi=a,xc=g,Tc=d,jf=l,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,sy(ir,function(){return sg(),null})):(e.callbackNode=null,e.callbackPriority=0),l=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||l){l=O.T,O.T=null,d=G.p,G.p=2,v=Ot,Ot|=4;try{Y0(e,n,a)}finally{Ot=v,G.p=d,O.T=l}}ue=1,tg(),eg(),ig()}}function tg(){if(ue===1){ue=0;var e=un,n=_s,a=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||a){a=O.T,O.T=null;var l=G.p;G.p=2;var d=Ot;Ot|=4;try{kf(n,e);var g=Hc,v=Uh(e.containerInfo),w=g.focusedElem,M=g.selectionRange;if(v!==w&&w&&w.ownerDocument&&Fh(w.ownerDocument.documentElement,w)){if(M!==null&&ho(w)){var U=M.start,q=M.end;if(q===void 0&&(q=U),"selectionStart"in w)w.selectionStart=U,w.selectionEnd=Math.min(q,w.value.length);else{var X=w.ownerDocument||document,I=X&&X.defaultView||window;if(I.getSelection){var H=I.getSelection(),at=w.textContent.length,ht=Math.min(M.start,at),It=M.end===void 0?ht:Math.min(M.end,at);!H.extend&&ht>It&&(v=It,It=ht,ht=v);var L=Ph(w,ht),R=Ph(w,It);if(L&&R&&(H.rangeCount!==1||H.anchorNode!==L.node||H.anchorOffset!==L.offset||H.focusNode!==R.node||H.focusOffset!==R.offset)){var P=X.createRange();P.setStart(L.node,L.offset),H.removeAllRanges(),ht>It?(H.addRange(P),H.extend(R.node,R.offset)):(P.setEnd(R.node,R.offset),H.addRange(P))}}}}for(X=[],H=w;H=H.parentNode;)H.nodeType===1&&X.push({element:H,left:H.scrollLeft,top:H.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<X.length;w++){var V=X[w];V.element.scrollLeft=V.left,V.element.scrollTop=V.top}}dl=!!Ic,Hc=Ic=null}finally{Ot=d,G.p=l,O.T=a}}e.current=n,ue=2}}function eg(){if(ue===2){ue=0;var e=un,n=_s,a=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||a){a=O.T,O.T=null;var l=G.p;G.p=2;var d=Ot;Ot|=4;try{Df(e,n.alternate,n)}finally{Ot=d,G.p=l,O.T=a}}ue=3}}function ig(){if(ue===4||ue===3){ue=0,Em();var e=un,n=_s,a=Gi,l=jf;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?ue=5:(ue=0,_s=un=null,ng(e,e.pendingLanes));var d=e.pendingLanes;if(d===0&&(cn=null),Xl(a),n=n.stateNode,je&&typeof je.onCommitFiberRoot=="function")try{je.onCommitFiberRoot(js,n,void 0,(n.current.flags&128)===128)}catch{}if(l!==null){n=O.T,d=G.p,G.p=2,O.T=null;try{for(var g=e.onRecoverableError,v=0;v<l.length;v++){var w=l[v];g(w.value,{componentStack:w.stack})}}finally{O.T=n,G.p=d}}(Gi&3)!==0&&tl(),Ai(e),d=e.pendingLanes,(a&261930)!==0&&(d&42)!==0?e===Cc?wa++:(wa=0,Cc=e):wa=0,Ea(0)}}function ng(e,n){(e.pooledCacheLanes&=n)===0&&(n=e.pooledCache,n!=null&&(e.pooledCache=null,sa(n)))}function tl(){return tg(),eg(),ig(),sg()}function sg(){if(ue!==5)return!1;var e=un,n=xc;xc=0;var a=Xl(Gi),l=O.T,d=G.p;try{G.p=32>a?32:a,O.T=null,a=Tc,Tc=null;var g=un,v=Gi;if(ue=0,_s=un=null,Gi=0,(Ot&6)!==0)throw Error(s(331));var w=Ot;if(Ot|=4,Uf(g.current),zf(g,g.current,v,a),Ot=w,Ea(0,!1),je&&typeof je.onPostCommitFiberRoot=="function")try{je.onPostCommitFiberRoot(js,g)}catch{}return!0}finally{G.p=d,O.T=l,ng(e,n)}}function ag(e,n,a){n=ni(a,n),n=ac(e.stateNode,n,2),e=nn(e,n,2),e!==null&&(qs(e,2),Ai(e))}function zt(e,n,a){if(e.tag===3)ag(e,e,a);else for(;n!==null;){if(n.tag===3){ag(n,e,a);break}else if(n.tag===1){var l=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(cn===null||!cn.has(l))){e=ni(a,e),a=rf(2),l=nn(n,a,2),l!==null&&(lf(a,l,n,e),qs(l,2),Ai(l));break}}n=n.return}}function Rc(e,n,a){var l=e.pingCache;if(l===null){l=e.pingCache=new Q0;var d=new Set;l.set(n,d)}else d=l.get(n),d===void 0&&(d=new Set,l.set(n,d));d.has(a)||(_c=!0,d.add(a),e=ey.bind(null,e,n,a),n.then(e,e))}function ey(e,n,a){var l=e.pingCache;l!==null&&l.delete(n),e.pingedLanes|=e.suspendedLanes&a,e.warmLanes&=~a,jt===e&&(wt&a)===a&&(Wt===4||Wt===3&&(wt&62914560)===wt&&300>He()-Kr?(Ot&2)===0&&ws(e,0):wc|=a,Ss===wt&&(Ss=0)),Ai(e)}function rg(e,n){n===0&&(n=Ju()),e=Mn(e,n),e!==null&&(qs(e,n),Ai(e))}function iy(e){var n=e.memoizedState,a=0;n!==null&&(a=n.retryLane),rg(e,a)}function ny(e,n){var a=0;switch(e.tag){case 31:case 13:var l=e.stateNode,d=e.memoizedState;d!==null&&(a=d.retryLane);break;case 19:l=e.stateNode;break;case 22:l=e.stateNode._retryCache;break;default:throw Error(s(314))}l!==null&&l.delete(n),rg(e,a)}function sy(e,n){return jl(e,n)}var el=null,xs=null,Oc=!1,il=!1,Nc=!1,dn=0;function Ai(e){e!==xs&&e.next===null&&(xs===null?el=xs=e:xs=xs.next=e),il=!0,Oc||(Oc=!0,ry())}function Ea(e,n){if(!Nc&&il){Nc=!0;do for(var a=!1,l=el;l!==null;){if(e!==0){var d=l.pendingLanes;if(d===0)var g=0;else{var v=l.suspendedLanes,w=l.pingedLanes;g=(1<<31-Ge(42|e)+1)-1,g&=d&~(v&~w),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(a=!0,ug(l,g))}else g=wt,g=rr(l,l===jt?g:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),(g&3)===0||Gs(l,g)||(a=!0,ug(l,g));l=l.next}while(a);Nc=!1}}function ay(){lg()}function lg(){il=Oc=!1;var e=0;dn!==0&&my()&&(e=dn);for(var n=He(),a=null,l=el;l!==null;){var d=l.next,g=og(l,n);g===0?(l.next=null,a===null?el=d:a.next=d,d===null&&(xs=a)):(a=l,(e!==0||(g&3)!==0)&&(il=!0)),l=d}ue!==0&&ue!==5||Ea(e),dn!==0&&(dn=0)}function og(e,n){for(var a=e.suspendedLanes,l=e.pingedLanes,d=e.expirationTimes,g=e.pendingLanes&-62914561;0<g;){var v=31-Ge(g),w=1<<v,M=d[v];M===-1?((w&a)===0||(w&l)!==0)&&(d[v]=Nm(w,n)):M<=n&&(e.expiredLanes|=w),g&=~w}if(n=jt,a=wt,a=rr(e,e===n?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l=e.callbackNode,a===0||e===n&&(Bt===2||Bt===9)||e.cancelPendingCommit!==null)return l!==null&&l!==null&&Gl(l),e.callbackNode=null,e.callbackPriority=0;if((a&3)===0||Gs(e,a)){if(n=a&-a,n===e.callbackPriority)return n;switch(l!==null&&Gl(l),Xl(a)){case 2:case 8:a=Zu;break;case 32:a=ir;break;case 268435456:a=Wu;break;default:a=ir}return l=cg.bind(null,e),a=jl(a,l),e.callbackPriority=n,e.callbackNode=a,n}return l!==null&&l!==null&&Gl(l),e.callbackPriority=2,e.callbackNode=null,2}function cg(e,n){if(ue!==0&&ue!==5)return e.callbackNode=null,e.callbackPriority=0,null;var a=e.callbackNode;if(tl()&&e.callbackNode!==a)return null;var l=wt;return l=rr(e,e===jt?l:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l===0?null:(qf(e,l,n),og(e,He()),e.callbackNode!=null&&e.callbackNode===a?cg.bind(null,e):null)}function ug(e,n){if(tl())return null;qf(e,n,!0)}function ry(){by(function(){(Ot&6)!==0?jl(Qu,ay):lg()})}function Lc(){if(dn===0){var e=us;e===0&&(e=nr,nr<<=1,(nr&261888)===0&&(nr=256)),dn=e}return dn}function hg(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:ur(""+e)}function dg(e,n){var a=n.ownerDocument.createElement("input");return a.name=n.name,a.value=n.value,e.id&&a.setAttribute("form",e.id),n.parentNode.insertBefore(a,n),e=new FormData(e),a.parentNode.removeChild(a),e}function ly(e,n,a,l,d){if(n==="submit"&&a&&a.stateNode===d){var g=hg((d[Ne]||null).action),v=l.submitter;v&&(n=(n=v[Ne]||null)?hg(n.formAction):v.getAttribute("formAction"),n!==null&&(g=n,v=null));var w=new gr("action","action",null,l,d);e.push({event:w,listeners:[{instance:null,listener:function(){if(l.defaultPrevented){if(dn!==0){var M=v?dg(d,v):new FormData(d);Jo(a,{pending:!0,data:M,method:d.method,action:g},null,M)}}else typeof g=="function"&&(w.preventDefault(),M=v?dg(d,v):new FormData(d),Jo(a,{pending:!0,data:M,method:d.method,action:g},g,M))},currentTarget:d}]})}}for(var kc=0;kc<mo.length;kc++){var Bc=mo[kc],oy=Bc.toLowerCase(),cy=Bc[0].toUpperCase()+Bc.slice(1);gi(oy,"on"+cy)}gi(jh,"onAnimationEnd"),gi(Gh,"onAnimationIteration"),gi(qh,"onAnimationStart"),gi("dblclick","onDoubleClick"),gi("focusin","onFocus"),gi("focusout","onBlur"),gi(x0,"onTransitionRun"),gi(T0,"onTransitionStart"),gi(C0,"onTransitionCancel"),gi(Vh,"onTransitionEnd"),Qn("onMouseEnter",["mouseout","mouseover"]),Qn("onMouseLeave",["mouseout","mouseover"]),Qn("onPointerEnter",["pointerout","pointerover"]),Qn("onPointerLeave",["pointerout","pointerover"]),En("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),En("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),En("onBeforeInput",["compositionend","keypress","textInput","paste"]),En("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),En("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),En("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uy=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(xa));function fg(e,n){n=(n&4)!==0;for(var a=0;a<e.length;a++){var l=e[a],d=l.event;l=l.listeners;t:{var g=void 0;if(n)for(var v=l.length-1;0<=v;v--){var w=l[v],M=w.instance,U=w.currentTarget;if(w=w.listener,M!==g&&d.isPropagationStopped())break t;g=w,d.currentTarget=U;try{g(d)}catch(q){yr(q)}d.currentTarget=null,g=M}else for(v=0;v<l.length;v++){if(w=l[v],M=w.instance,U=w.currentTarget,w=w.listener,M!==g&&d.isPropagationStopped())break t;g=w,d.currentTarget=U;try{g(d)}catch(q){yr(q)}d.currentTarget=null,g=M}}}}function St(e,n){var a=n[Yl];a===void 0&&(a=n[Yl]=new Set);var l=e+"__bubble";a.has(l)||(gg(n,e,2,!1),a.add(l))}function zc(e,n,a){var l=0;n&&(l|=4),gg(a,e,l,n)}var nl="_reactListening"+Math.random().toString(36).slice(2);function Pc(e){if(!e[nl]){e[nl]=!0,rh.forEach(function(a){a!=="selectionchange"&&(uy.has(a)||zc(a,!1,e),zc(a,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[nl]||(n[nl]=!0,zc("selectionchange",!1,n))}}function gg(e,n,a,l){switch(Gg(n)){case 2:var d=Fy;break;case 8:d=Uy;break;default:d=Wc}a=d.bind(null,n,a,e),d=void 0,!io||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(d=!0),l?d!==void 0?e.addEventListener(n,a,{capture:!0,passive:d}):e.addEventListener(n,a,!0):d!==void 0?e.addEventListener(n,a,{passive:d}):e.addEventListener(n,a,!1)}function Fc(e,n,a,l,d){var g=l;if((n&1)===0&&(n&2)===0&&l!==null)t:for(;;){if(l===null)return;var v=l.tag;if(v===3||v===4){var w=l.stateNode.containerInfo;if(w===d)break;if(v===4)for(v=l.return;v!==null;){var M=v.tag;if((M===3||M===4)&&v.stateNode.containerInfo===d)return;v=v.return}for(;w!==null;){if(v=Yn(w),v===null)return;if(M=v.tag,M===5||M===6||M===26||M===27){l=g=v;continue t}w=w.parentNode}}l=l.return}bh(function(){var U=g,q=to(a),X=[];t:{var I=Xh.get(e);if(I!==void 0){var H=gr,at=e;switch(e){case"keypress":if(dr(a)===0)break t;case"keydown":case"keyup":H=n0;break;case"focusin":at="focus",H=ro;break;case"focusout":at="blur",H=ro;break;case"beforeblur":case"afterblur":H=ro;break;case"click":if(a.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":H=Sh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":H=Vm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":H=r0;break;case jh:case Gh:case qh:H=Km;break;case Vh:H=o0;break;case"scroll":case"scrollend":H=Gm;break;case"wheel":H=u0;break;case"copy":case"cut":case"paste":H=Qm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":H=wh;break;case"toggle":case"beforetoggle":H=d0}var ht=(n&4)!==0,It=!ht&&(e==="scroll"||e==="scrollend"),L=ht?I!==null?I+"Capture":null:I;ht=[];for(var R=U,P;R!==null;){var V=R;if(P=V.stateNode,V=V.tag,V!==5&&V!==26&&V!==27||P===null||L===null||(V=Ys(R,L),V!=null&&ht.push(Ta(R,V,P))),It)break;R=R.return}0<ht.length&&(I=new H(I,at,null,a,q),X.push({event:I,listeners:ht}))}}if((n&7)===0){t:{if(I=e==="mouseover"||e==="pointerover",H=e==="mouseout"||e==="pointerout",I&&a!==Jl&&(at=a.relatedTarget||a.fromElement)&&(Yn(at)||at[Xn]))break t;if((H||I)&&(I=q.window===q?q:(I=q.ownerDocument)?I.defaultView||I.parentWindow:window,H?(at=a.relatedTarget||a.toElement,H=U,at=at?Yn(at):null,at!==null&&(It=o(at),ht=at.tag,at!==It||ht!==5&&ht!==27&&ht!==6)&&(at=null)):(H=null,at=U),H!==at)){if(ht=Sh,V="onMouseLeave",L="onMouseEnter",R="mouse",(e==="pointerout"||e==="pointerover")&&(ht=wh,V="onPointerLeave",L="onPointerEnter",R="pointer"),It=H==null?I:Xs(H),P=at==null?I:Xs(at),I=new ht(V,R+"leave",H,a,q),I.target=It,I.relatedTarget=P,V=null,Yn(q)===U&&(ht=new ht(L,R+"enter",at,a,q),ht.target=P,ht.relatedTarget=It,V=ht),It=V,H&&at)e:{for(ht=hy,L=H,R=at,P=0,V=L;V;V=ht(V))P++;V=0;for(var ot=R;ot;ot=ht(ot))V++;for(;0<P-V;)L=ht(L),P--;for(;0<V-P;)R=ht(R),V--;for(;P--;){if(L===R||R!==null&&L===R.alternate){ht=L;break e}L=ht(L),R=ht(R)}ht=null}else ht=null;H!==null&&pg(X,I,H,ht,!1),at!==null&&It!==null&&pg(X,It,at,ht,!0)}}t:{if(I=U?Xs(U):window,H=I.nodeName&&I.nodeName.toLowerCase(),H==="select"||H==="input"&&I.type==="file")var Dt=Oh;else if(Dh(I))if(Nh)Dt=_0;else{Dt=A0;var rt=v0}else H=I.nodeName,!H||H.toLowerCase()!=="input"||I.type!=="checkbox"&&I.type!=="radio"?U&&Wl(U.elementType)&&(Dt=Oh):Dt=S0;if(Dt&&(Dt=Dt(e,U))){Rh(X,Dt,a,q);break t}rt&&rt(e,I,U),e==="focusout"&&U&&I.type==="number"&&U.memoizedProps.value!=null&&Zl(I,"number",I.value)}switch(rt=U?Xs(U):window,e){case"focusin":(Dh(rt)||rt.contentEditable==="true")&&(is=rt,fo=U,ea=null);break;case"focusout":ea=fo=is=null;break;case"mousedown":go=!0;break;case"contextmenu":case"mouseup":case"dragend":go=!1,Ih(X,a,q);break;case"selectionchange":if(E0)break;case"keydown":case"keyup":Ih(X,a,q)}var vt;if(oo)t:{switch(e){case"compositionstart":var Et="onCompositionStart";break t;case"compositionend":Et="onCompositionEnd";break t;case"compositionupdate":Et="onCompositionUpdate";break t}Et=void 0}else es?Ch(e,a)&&(Et="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(Et="onCompositionStart");Et&&(Eh&&a.locale!=="ko"&&(es||Et!=="onCompositionStart"?Et==="onCompositionEnd"&&es&&(vt=vh()):($i=q,no="value"in $i?$i.value:$i.textContent,es=!0)),rt=sl(U,Et),0<rt.length&&(Et=new _h(Et,e,null,a,q),X.push({event:Et,listeners:rt}),vt?Et.data=vt:(vt=Mh(a),vt!==null&&(Et.data=vt)))),(vt=g0?p0(e,a):m0(e,a))&&(Et=sl(U,"onBeforeInput"),0<Et.length&&(rt=new _h("onBeforeInput","beforeinput",null,a,q),X.push({event:rt,listeners:Et}),rt.data=vt)),ly(X,e,U,a,q)}fg(X,n)})}function Ta(e,n,a){return{instance:e,listener:n,currentTarget:a}}function sl(e,n){for(var a=n+"Capture",l=[];e!==null;){var d=e,g=d.stateNode;if(d=d.tag,d!==5&&d!==26&&d!==27||g===null||(d=Ys(e,a),d!=null&&l.unshift(Ta(e,d,g)),d=Ys(e,n),d!=null&&l.push(Ta(e,d,g))),e.tag===3)return l;e=e.return}return[]}function hy(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function pg(e,n,a,l,d){for(var g=n._reactName,v=[];a!==null&&a!==l;){var w=a,M=w.alternate,U=w.stateNode;if(w=w.tag,M!==null&&M===l)break;w!==5&&w!==26&&w!==27||U===null||(M=U,d?(U=Ys(a,g),U!=null&&v.unshift(Ta(a,U,M))):d||(U=Ys(a,g),U!=null&&v.push(Ta(a,U,M)))),a=a.return}v.length!==0&&e.push({event:n,listeners:v})}var dy=/\r\n?/g,fy=/\u0000|\uFFFD/g;function mg(e){return(typeof e=="string"?e:""+e).replace(dy,`
`).replace(fy,"")}function yg(e,n){return n=mg(n),mg(e)===n}function Ut(e,n,a,l,d,g){switch(a){case"children":typeof l=="string"?n==="body"||n==="textarea"&&l===""||Wn(e,l):(typeof l=="number"||typeof l=="bigint")&&n!=="body"&&Wn(e,""+l);break;case"className":or(e,"class",l);break;case"tabIndex":or(e,"tabindex",l);break;case"dir":case"role":case"viewBox":case"width":case"height":or(e,a,l);break;case"style":mh(e,l,g);break;case"data":if(n!=="object"){or(e,"data",l);break}case"src":case"href":if(l===""&&(n!=="a"||a!=="href")){e.removeAttribute(a);break}if(l==null||typeof l=="function"||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(a);break}l=ur(""+l),e.setAttribute(a,l);break;case"action":case"formAction":if(typeof l=="function"){e.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(a==="formAction"?(n!=="input"&&Ut(e,n,"name",d.name,d,null),Ut(e,n,"formEncType",d.formEncType,d,null),Ut(e,n,"formMethod",d.formMethod,d,null),Ut(e,n,"formTarget",d.formTarget,d,null)):(Ut(e,n,"encType",d.encType,d,null),Ut(e,n,"method",d.method,d,null),Ut(e,n,"target",d.target,d,null)));if(l==null||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(a);break}l=ur(""+l),e.setAttribute(a,l);break;case"onClick":l!=null&&(e.onclick=Mi);break;case"onScroll":l!=null&&St("scroll",e);break;case"onScrollEnd":l!=null&&St("scrollend",e);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(s(61));if(a=l.__html,a!=null){if(d.children!=null)throw Error(s(60));e.innerHTML=a}}break;case"multiple":e.multiple=l&&typeof l!="function"&&typeof l!="symbol";break;case"muted":e.muted=l&&typeof l!="function"&&typeof l!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(l==null||typeof l=="function"||typeof l=="boolean"||typeof l=="symbol"){e.removeAttribute("xlink:href");break}a=ur(""+l),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(a,""+l):e.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":l&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(a,""):e.removeAttribute(a);break;case"capture":case"download":l===!0?e.setAttribute(a,""):l!==!1&&l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(a,l):e.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":l!=null&&typeof l!="function"&&typeof l!="symbol"&&!isNaN(l)&&1<=l?e.setAttribute(a,l):e.removeAttribute(a);break;case"rowSpan":case"start":l==null||typeof l=="function"||typeof l=="symbol"||isNaN(l)?e.removeAttribute(a):e.setAttribute(a,l);break;case"popover":St("beforetoggle",e),St("toggle",e),lr(e,"popover",l);break;case"xlinkActuate":Ci(e,"http://www.w3.org/1999/xlink","xlink:actuate",l);break;case"xlinkArcrole":Ci(e,"http://www.w3.org/1999/xlink","xlink:arcrole",l);break;case"xlinkRole":Ci(e,"http://www.w3.org/1999/xlink","xlink:role",l);break;case"xlinkShow":Ci(e,"http://www.w3.org/1999/xlink","xlink:show",l);break;case"xlinkTitle":Ci(e,"http://www.w3.org/1999/xlink","xlink:title",l);break;case"xlinkType":Ci(e,"http://www.w3.org/1999/xlink","xlink:type",l);break;case"xmlBase":Ci(e,"http://www.w3.org/XML/1998/namespace","xml:base",l);break;case"xmlLang":Ci(e,"http://www.w3.org/XML/1998/namespace","xml:lang",l);break;case"xmlSpace":Ci(e,"http://www.w3.org/XML/1998/namespace","xml:space",l);break;case"is":lr(e,"is",l);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=Hm.get(a)||a,lr(e,a,l))}}function Uc(e,n,a,l,d,g){switch(a){case"style":mh(e,l,g);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(s(61));if(a=l.__html,a!=null){if(d.children!=null)throw Error(s(60));e.innerHTML=a}}break;case"children":typeof l=="string"?Wn(e,l):(typeof l=="number"||typeof l=="bigint")&&Wn(e,""+l);break;case"onScroll":l!=null&&St("scroll",e);break;case"onScrollEnd":l!=null&&St("scrollend",e);break;case"onClick":l!=null&&(e.onclick=Mi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!lh.hasOwnProperty(a))t:{if(a[0]==="o"&&a[1]==="n"&&(d=a.endsWith("Capture"),n=a.slice(2,d?a.length-7:void 0),g=e[Ne]||null,g=g!=null?g[a]:null,typeof g=="function"&&e.removeEventListener(n,g,d),typeof l=="function")){typeof g!="function"&&g!==null&&(a in e?e[a]=null:e.hasAttribute(a)&&e.removeAttribute(a)),e.addEventListener(n,l,d);break t}a in e?e[a]=l:l===!0?e.setAttribute(a,""):lr(e,a,l)}}}function _e(e,n,a){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":St("error",e),St("load",e);var l=!1,d=!1,g;for(g in a)if(a.hasOwnProperty(g)){var v=a[g];if(v!=null)switch(g){case"src":l=!0;break;case"srcSet":d=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:Ut(e,n,g,v,a,null)}}d&&Ut(e,n,"srcSet",a.srcSet,a,null),l&&Ut(e,n,"src",a.src,a,null);return;case"input":St("invalid",e);var w=g=v=d=null,M=null,U=null;for(l in a)if(a.hasOwnProperty(l)){var q=a[l];if(q!=null)switch(l){case"name":d=q;break;case"type":v=q;break;case"checked":M=q;break;case"defaultChecked":U=q;break;case"value":g=q;break;case"defaultValue":w=q;break;case"children":case"dangerouslySetInnerHTML":if(q!=null)throw Error(s(137,n));break;default:Ut(e,n,l,q,a,null)}}dh(e,g,w,M,U,v,d,!1);return;case"select":St("invalid",e),l=v=g=null;for(d in a)if(a.hasOwnProperty(d)&&(w=a[d],w!=null))switch(d){case"value":g=w;break;case"defaultValue":v=w;break;case"multiple":l=w;default:Ut(e,n,d,w,a,null)}n=g,a=v,e.multiple=!!l,n!=null?Zn(e,!!l,n,!1):a!=null&&Zn(e,!!l,a,!0);return;case"textarea":St("invalid",e),g=d=l=null;for(v in a)if(a.hasOwnProperty(v)&&(w=a[v],w!=null))switch(v){case"value":l=w;break;case"defaultValue":d=w;break;case"children":g=w;break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(s(91));break;default:Ut(e,n,v,w,a,null)}gh(e,l,d,g);return;case"option":for(M in a)if(a.hasOwnProperty(M)&&(l=a[M],l!=null))switch(M){case"selected":e.selected=l&&typeof l!="function"&&typeof l!="symbol";break;default:Ut(e,n,M,l,a,null)}return;case"dialog":St("beforetoggle",e),St("toggle",e),St("cancel",e),St("close",e);break;case"iframe":case"object":St("load",e);break;case"video":case"audio":for(l=0;l<xa.length;l++)St(xa[l],e);break;case"image":St("error",e),St("load",e);break;case"details":St("toggle",e);break;case"embed":case"source":case"link":St("error",e),St("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(U in a)if(a.hasOwnProperty(U)&&(l=a[U],l!=null))switch(U){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:Ut(e,n,U,l,a,null)}return;default:if(Wl(n)){for(q in a)a.hasOwnProperty(q)&&(l=a[q],l!==void 0&&Uc(e,n,q,l,a,void 0));return}}for(w in a)a.hasOwnProperty(w)&&(l=a[w],l!=null&&Ut(e,n,w,l,a,null))}function gy(e,n,a,l){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var d=null,g=null,v=null,w=null,M=null,U=null,q=null;for(H in a){var X=a[H];if(a.hasOwnProperty(H)&&X!=null)switch(H){case"checked":break;case"value":break;case"defaultValue":M=X;default:l.hasOwnProperty(H)||Ut(e,n,H,null,l,X)}}for(var I in l){var H=l[I];if(X=a[I],l.hasOwnProperty(I)&&(H!=null||X!=null))switch(I){case"type":g=H;break;case"name":d=H;break;case"checked":U=H;break;case"defaultChecked":q=H;break;case"value":v=H;break;case"defaultValue":w=H;break;case"children":case"dangerouslySetInnerHTML":if(H!=null)throw Error(s(137,n));break;default:H!==X&&Ut(e,n,I,H,l,X)}}Ql(e,v,w,M,U,q,g,d);return;case"select":H=v=w=I=null;for(g in a)if(M=a[g],a.hasOwnProperty(g)&&M!=null)switch(g){case"value":break;case"multiple":H=M;default:l.hasOwnProperty(g)||Ut(e,n,g,null,l,M)}for(d in l)if(g=l[d],M=a[d],l.hasOwnProperty(d)&&(g!=null||M!=null))switch(d){case"value":I=g;break;case"defaultValue":w=g;break;case"multiple":v=g;default:g!==M&&Ut(e,n,d,g,l,M)}n=w,a=v,l=H,I!=null?Zn(e,!!a,I,!1):!!l!=!!a&&(n!=null?Zn(e,!!a,n,!0):Zn(e,!!a,a?[]:"",!1));return;case"textarea":H=I=null;for(w in a)if(d=a[w],a.hasOwnProperty(w)&&d!=null&&!l.hasOwnProperty(w))switch(w){case"value":break;case"children":break;default:Ut(e,n,w,null,l,d)}for(v in l)if(d=l[v],g=a[v],l.hasOwnProperty(v)&&(d!=null||g!=null))switch(v){case"value":I=d;break;case"defaultValue":H=d;break;case"children":break;case"dangerouslySetInnerHTML":if(d!=null)throw Error(s(91));break;default:d!==g&&Ut(e,n,v,d,l,g)}fh(e,I,H);return;case"option":for(var at in a)if(I=a[at],a.hasOwnProperty(at)&&I!=null&&!l.hasOwnProperty(at))switch(at){case"selected":e.selected=!1;break;default:Ut(e,n,at,null,l,I)}for(M in l)if(I=l[M],H=a[M],l.hasOwnProperty(M)&&I!==H&&(I!=null||H!=null))switch(M){case"selected":e.selected=I&&typeof I!="function"&&typeof I!="symbol";break;default:Ut(e,n,M,I,l,H)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ht in a)I=a[ht],a.hasOwnProperty(ht)&&I!=null&&!l.hasOwnProperty(ht)&&Ut(e,n,ht,null,l,I);for(U in l)if(I=l[U],H=a[U],l.hasOwnProperty(U)&&I!==H&&(I!=null||H!=null))switch(U){case"children":case"dangerouslySetInnerHTML":if(I!=null)throw Error(s(137,n));break;default:Ut(e,n,U,I,l,H)}return;default:if(Wl(n)){for(var It in a)I=a[It],a.hasOwnProperty(It)&&I!==void 0&&!l.hasOwnProperty(It)&&Uc(e,n,It,void 0,l,I);for(q in l)I=l[q],H=a[q],!l.hasOwnProperty(q)||I===H||I===void 0&&H===void 0||Uc(e,n,q,I,l,H);return}}for(var L in a)I=a[L],a.hasOwnProperty(L)&&I!=null&&!l.hasOwnProperty(L)&&Ut(e,n,L,null,l,I);for(X in l)I=l[X],H=a[X],!l.hasOwnProperty(X)||I===H||I==null&&H==null||Ut(e,n,X,I,l,H)}function bg(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function py(){if(typeof performance.getEntriesByType=="function"){for(var e=0,n=0,a=performance.getEntriesByType("resource"),l=0;l<a.length;l++){var d=a[l],g=d.transferSize,v=d.initiatorType,w=d.duration;if(g&&w&&bg(v)){for(v=0,w=d.responseEnd,l+=1;l<a.length;l++){var M=a[l],U=M.startTime;if(U>w)break;var q=M.transferSize,X=M.initiatorType;q&&bg(X)&&(M=M.responseEnd,v+=q*(M<w?1:(w-U)/(M-U)))}if(--l,n+=8*(g+v)/(d.duration/1e3),e++,10<e)break}}if(0<e)return n/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Ic=null,Hc=null;function al(e){return e.nodeType===9?e:e.ownerDocument}function vg(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Ag(e,n){if(e===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&n==="foreignObject"?0:e}function jc(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Gc=null;function my(){var e=window.event;return e&&e.type==="popstate"?e===Gc?!1:(Gc=e,!0):(Gc=null,!1)}var Sg=typeof setTimeout=="function"?setTimeout:void 0,yy=typeof clearTimeout=="function"?clearTimeout:void 0,_g=typeof Promise=="function"?Promise:void 0,by=typeof queueMicrotask=="function"?queueMicrotask:typeof _g<"u"?function(e){return _g.resolve(null).then(e).catch(vy)}:Sg;function vy(e){setTimeout(function(){throw e})}function fn(e){return e==="head"}function wg(e,n){var a=n,l=0;do{var d=a.nextSibling;if(e.removeChild(a),d&&d.nodeType===8)if(a=d.data,a==="/$"||a==="/&"){if(l===0){e.removeChild(d),Ds(n);return}l--}else if(a==="$"||a==="$?"||a==="$~"||a==="$!"||a==="&")l++;else if(a==="html")Ca(e.ownerDocument.documentElement);else if(a==="head"){a=e.ownerDocument.head,Ca(a);for(var g=a.firstChild;g;){var v=g.nextSibling,w=g.nodeName;g[Vs]||w==="SCRIPT"||w==="STYLE"||w==="LINK"&&g.rel.toLowerCase()==="stylesheet"||a.removeChild(g),g=v}}else a==="body"&&Ca(e.ownerDocument.body);a=d}while(a);Ds(n)}function Eg(e,n){var a=e;e=0;do{var l=a.nextSibling;if(a.nodeType===1?n?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",a.getAttribute("style")===""&&a.removeAttribute("style")):a.nodeType===3&&(n?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),l&&l.nodeType===8)if(a=l.data,a==="/$"){if(e===0)break;e--}else a!=="$"&&a!=="$?"&&a!=="$~"&&a!=="$!"||e++;a=l}while(a)}function qc(e){var n=e.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var a=n;switch(n=n.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":qc(a),Kl(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}e.removeChild(a)}}function Ay(e,n,a,l){for(;e.nodeType===1;){var d=a;if(e.nodeName.toLowerCase()!==n.toLowerCase()){if(!l&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(l){if(!e[Vs])switch(n){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(g=e.getAttribute("rel"),g==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(g!==d.rel||e.getAttribute("href")!==(d.href==null||d.href===""?null:d.href)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin)||e.getAttribute("title")!==(d.title==null?null:d.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(g=e.getAttribute("src"),(g!==(d.src==null?null:d.src)||e.getAttribute("type")!==(d.type==null?null:d.type)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin))&&g&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(n==="input"&&e.type==="hidden"){var g=d.name==null?null:""+d.name;if(d.type==="hidden"&&e.getAttribute("name")===g)return e}else return e;if(e=oi(e.nextSibling),e===null)break}return null}function Sy(e,n,a){if(n==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!a||(e=oi(e.nextSibling),e===null))return null;return e}function xg(e,n){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=oi(e.nextSibling),e===null))return null;return e}function Vc(e){return e.data==="$?"||e.data==="$~"}function Xc(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function _y(e,n){var a=e.ownerDocument;if(e.data==="$~")e._reactRetry=n;else if(e.data!=="$?"||a.readyState!=="loading")n();else{var l=function(){n(),a.removeEventListener("DOMContentLoaded",l)};a.addEventListener("DOMContentLoaded",l),e._reactRetry=l}}function oi(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return e}var Yc=null;function Tg(e){e=e.nextSibling;for(var n=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"||a==="/&"){if(n===0)return oi(e.nextSibling);n--}else a!=="$"&&a!=="$!"&&a!=="$?"&&a!=="$~"&&a!=="&"||n++}e=e.nextSibling}return null}function Cg(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"){if(n===0)return e;n--}else a!=="/$"&&a!=="/&"||n++}e=e.previousSibling}return null}function Mg(e,n,a){switch(n=al(a),e){case"html":if(e=n.documentElement,!e)throw Error(s(452));return e;case"head":if(e=n.head,!e)throw Error(s(453));return e;case"body":if(e=n.body,!e)throw Error(s(454));return e;default:throw Error(s(451))}}function Ca(e){for(var n=e.attributes;n.length;)e.removeAttributeNode(n[0]);Kl(e)}var ci=new Map,Dg=new Set;function rl(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var qi=G.d;G.d={f:wy,r:Ey,D:xy,C:Ty,L:Cy,m:My,X:Ry,S:Dy,M:Oy};function wy(){var e=qi.f(),n=Zr();return e||n}function Ey(e){var n=Kn(e);n!==null&&n.tag===5&&n.type==="form"?Vd(n):qi.r(e)}var Ts=typeof document>"u"?null:document;function Rg(e,n,a){var l=Ts;if(l&&typeof n=="string"&&n){var d=ei(n);d='link[rel="'+e+'"][href="'+d+'"]',typeof a=="string"&&(d+='[crossorigin="'+a+'"]'),Dg.has(d)||(Dg.add(d),e={rel:e,crossOrigin:a,href:n},l.querySelector(d)===null&&(n=l.createElement("link"),_e(n,"link",e),ge(n),l.head.appendChild(n)))}}function xy(e){qi.D(e),Rg("dns-prefetch",e,null)}function Ty(e,n){qi.C(e,n),Rg("preconnect",e,n)}function Cy(e,n,a){qi.L(e,n,a);var l=Ts;if(l&&e&&n){var d='link[rel="preload"][as="'+ei(n)+'"]';n==="image"&&a&&a.imageSrcSet?(d+='[imagesrcset="'+ei(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(d+='[imagesizes="'+ei(a.imageSizes)+'"]')):d+='[href="'+ei(e)+'"]';var g=d;switch(n){case"style":g=Cs(e);break;case"script":g=Ms(e)}ci.has(g)||(e=y({rel:"preload",href:n==="image"&&a&&a.imageSrcSet?void 0:e,as:n},a),ci.set(g,e),l.querySelector(d)!==null||n==="style"&&l.querySelector(Ma(g))||n==="script"&&l.querySelector(Da(g))||(n=l.createElement("link"),_e(n,"link",e),ge(n),l.head.appendChild(n)))}}function My(e,n){qi.m(e,n);var a=Ts;if(a&&e){var l=n&&typeof n.as=="string"?n.as:"script",d='link[rel="modulepreload"][as="'+ei(l)+'"][href="'+ei(e)+'"]',g=d;switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=Ms(e)}if(!ci.has(g)&&(e=y({rel:"modulepreload",href:e},n),ci.set(g,e),a.querySelector(d)===null)){switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(Da(g)))return}l=a.createElement("link"),_e(l,"link",e),ge(l),a.head.appendChild(l)}}}function Dy(e,n,a){qi.S(e,n,a);var l=Ts;if(l&&e){var d=$n(l).hoistableStyles,g=Cs(e);n=n||"default";var v=d.get(g);if(!v){var w={loading:0,preload:null};if(v=l.querySelector(Ma(g)))w.loading=5;else{e=y({rel:"stylesheet",href:e,"data-precedence":n},a),(a=ci.get(g))&&Kc(e,a);var M=v=l.createElement("link");ge(M),_e(M,"link",e),M._p=new Promise(function(U,q){M.onload=U,M.onerror=q}),M.addEventListener("load",function(){w.loading|=1}),M.addEventListener("error",function(){w.loading|=2}),w.loading|=4,ll(v,n,l)}v={type:"stylesheet",instance:v,count:1,state:w},d.set(g,v)}}}function Ry(e,n){qi.X(e,n);var a=Ts;if(a&&e){var l=$n(a).hoistableScripts,d=Ms(e),g=l.get(d);g||(g=a.querySelector(Da(d)),g||(e=y({src:e,async:!0},n),(n=ci.get(d))&&$c(e,n),g=a.createElement("script"),ge(g),_e(g,"link",e),a.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},l.set(d,g))}}function Oy(e,n){qi.M(e,n);var a=Ts;if(a&&e){var l=$n(a).hoistableScripts,d=Ms(e),g=l.get(d);g||(g=a.querySelector(Da(d)),g||(e=y({src:e,async:!0,type:"module"},n),(n=ci.get(d))&&$c(e,n),g=a.createElement("script"),ge(g),_e(g,"link",e),a.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},l.set(d,g))}}function Og(e,n,a,l){var d=(d=lt.current)?rl(d):null;if(!d)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(n=Cs(a.href),a=$n(d).hoistableStyles,l=a.get(n),l||(l={type:"style",instance:null,count:0,state:null},a.set(n,l)),l):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){e=Cs(a.href);var g=$n(d).hoistableStyles,v=g.get(e);if(v||(d=d.ownerDocument||d,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(e,v),(g=d.querySelector(Ma(e)))&&!g._p&&(v.instance=g,v.state.loading=5),ci.has(e)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},ci.set(e,a),g||Ny(d,e,a,v.state))),n&&l===null)throw Error(s(528,""));return v}if(n&&l!==null)throw Error(s(529,""));return null;case"script":return n=a.async,a=a.src,typeof a=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=Ms(a),a=$n(d).hoistableScripts,l=a.get(n),l||(l={type:"script",instance:null,count:0,state:null},a.set(n,l)),l):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function Cs(e){return'href="'+ei(e)+'"'}function Ma(e){return'link[rel="stylesheet"]['+e+"]"}function Ng(e){return y({},e,{"data-precedence":e.precedence,precedence:null})}function Ny(e,n,a,l){e.querySelector('link[rel="preload"][as="style"]['+n+"]")?l.loading=1:(n=e.createElement("link"),l.preload=n,n.addEventListener("load",function(){return l.loading|=1}),n.addEventListener("error",function(){return l.loading|=2}),_e(n,"link",a),ge(n),e.head.appendChild(n))}function Ms(e){return'[src="'+ei(e)+'"]'}function Da(e){return"script[async]"+e}function Lg(e,n,a){if(n.count++,n.instance===null)switch(n.type){case"style":var l=e.querySelector('style[data-href~="'+ei(a.href)+'"]');if(l)return n.instance=l,ge(l),l;var d=y({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return l=(e.ownerDocument||e).createElement("style"),ge(l),_e(l,"style",d),ll(l,a.precedence,e),n.instance=l;case"stylesheet":d=Cs(a.href);var g=e.querySelector(Ma(d));if(g)return n.state.loading|=4,n.instance=g,ge(g),g;l=Ng(a),(d=ci.get(d))&&Kc(l,d),g=(e.ownerDocument||e).createElement("link"),ge(g);var v=g;return v._p=new Promise(function(w,M){v.onload=w,v.onerror=M}),_e(g,"link",l),n.state.loading|=4,ll(g,a.precedence,e),n.instance=g;case"script":return g=Ms(a.src),(d=e.querySelector(Da(g)))?(n.instance=d,ge(d),d):(l=a,(d=ci.get(g))&&(l=y({},a),$c(l,d)),e=e.ownerDocument||e,d=e.createElement("script"),ge(d),_e(d,"link",l),e.head.appendChild(d),n.instance=d);case"void":return null;default:throw Error(s(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(l=n.instance,n.state.loading|=4,ll(l,a.precedence,e));return n.instance}function ll(e,n,a){for(var l=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),d=l.length?l[l.length-1]:null,g=d,v=0;v<l.length;v++){var w=l[v];if(w.dataset.precedence===n)g=w;else if(g!==d)break}g?g.parentNode.insertBefore(e,g.nextSibling):(n=a.nodeType===9?a.head:a,n.insertBefore(e,n.firstChild))}function Kc(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.title==null&&(e.title=n.title)}function $c(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.integrity==null&&(e.integrity=n.integrity)}var ol=null;function kg(e,n,a){if(ol===null){var l=new Map,d=ol=new Map;d.set(a,l)}else d=ol,l=d.get(a),l||(l=new Map,d.set(a,l));if(l.has(e))return l;for(l.set(e,null),a=a.getElementsByTagName(e),d=0;d<a.length;d++){var g=a[d];if(!(g[Vs]||g[be]||e==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var v=g.getAttribute(n)||"";v=e+v;var w=l.get(v);w?w.push(g):l.set(v,[g])}}return l}function Bg(e,n,a){e=e.ownerDocument||e,e.head.insertBefore(a,n==="title"?e.querySelector("head > title"):null)}function Ly(e,n,a){if(a===1||n.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;switch(n.rel){case"stylesheet":return e=n.disabled,typeof n.precedence=="string"&&e==null;default:return!0}case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function zg(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function ky(e,n,a,l){if(a.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var d=Cs(l.href),g=n.querySelector(Ma(d));if(g){n=g._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(e.count++,e=cl.bind(e),n.then(e,e)),a.state.loading|=4,a.instance=g,ge(g);return}g=n.ownerDocument||n,l=Ng(l),(d=ci.get(d))&&Kc(l,d),g=g.createElement("link"),ge(g);var v=g;v._p=new Promise(function(w,M){v.onload=w,v.onerror=M}),_e(g,"link",l),a.instance=g}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(a,n),(n=a.state.preload)&&(a.state.loading&3)===0&&(e.count++,a=cl.bind(e),n.addEventListener("load",a),n.addEventListener("error",a))}}var Qc=0;function By(e,n){return e.stylesheets&&e.count===0&&hl(e,e.stylesheets),0<e.count||0<e.imgCount?function(a){var l=setTimeout(function(){if(e.stylesheets&&hl(e,e.stylesheets),e.unsuspend){var g=e.unsuspend;e.unsuspend=null,g()}},6e4+n);0<e.imgBytes&&Qc===0&&(Qc=62500*py());var d=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&hl(e,e.stylesheets),e.unsuspend)){var g=e.unsuspend;e.unsuspend=null,g()}},(e.imgBytes>Qc?50:800)+n);return e.unsuspend=a,function(){e.unsuspend=null,clearTimeout(l),clearTimeout(d)}}:null}function cl(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)hl(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var ul=null;function hl(e,n){e.stylesheets=null,e.unsuspend!==null&&(e.count++,ul=new Map,n.forEach(zy,e),ul=null,cl.call(e))}function zy(e,n){if(!(n.state.loading&4)){var a=ul.get(e);if(a)var l=a.get(null);else{a=new Map,ul.set(e,a);for(var d=e.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<d.length;g++){var v=d[g];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(a.set(v.dataset.precedence,v),l=v)}l&&a.set(null,l)}d=n.instance,v=d.getAttribute("data-precedence"),g=a.get(v)||l,g===l&&a.set(null,d),a.set(v,d),this.count++,l=cl.bind(this),d.addEventListener("load",l),d.addEventListener("error",l),g?g.parentNode.insertBefore(d,g.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(d,e.firstChild)),n.state.loading|=4}}var Ra={$$typeof:T,Provider:null,Consumer:null,_currentValue:J,_currentValue2:J,_threadCount:0};function Py(e,n,a,l,d,g,v,w,M){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ql(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ql(0),this.hiddenUpdates=ql(null),this.identifierPrefix=l,this.onUncaughtError=d,this.onCaughtError=g,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=M,this.incompleteTransitions=new Map}function Pg(e,n,a,l,d,g,v,w,M,U,q,X){return e=new Py(e,n,a,v,M,U,q,X,w),n=1,g===!0&&(n|=24),g=Ve(3,null,null,n),e.current=g,g.stateNode=e,n=Do(),n.refCount++,e.pooledCache=n,n.refCount++,g.memoizedState={element:l,isDehydrated:a,cache:n},Lo(g),e}function Fg(e){return e?(e=as,e):as}function Ug(e,n,a,l,d,g){d=Fg(d),l.context===null?l.context=d:l.pendingContext=d,l=en(n),l.payload={element:a},g=g===void 0?null:g,g!==null&&(l.callback=g),a=nn(e,l,n),a!==null&&(Fe(a,e,n),oa(a,e,n))}function Ig(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<n?a:n}}function Zc(e,n){Ig(e,n),(e=e.alternate)&&Ig(e,n)}function Hg(e){if(e.tag===13||e.tag===31){var n=Mn(e,67108864);n!==null&&Fe(n,e,67108864),Zc(e,67108864)}}function jg(e){if(e.tag===13||e.tag===31){var n=Qe();n=Vl(n);var a=Mn(e,n);a!==null&&Fe(a,e,n),Zc(e,n)}}var dl=!0;function Fy(e,n,a,l){var d=O.T;O.T=null;var g=G.p;try{G.p=2,Wc(e,n,a,l)}finally{G.p=g,O.T=d}}function Uy(e,n,a,l){var d=O.T;O.T=null;var g=G.p;try{G.p=8,Wc(e,n,a,l)}finally{G.p=g,O.T=d}}function Wc(e,n,a,l){if(dl){var d=Jc(l);if(d===null)Fc(e,n,l,fl,a),qg(e,l);else if(Hy(d,e,n,a,l))l.stopPropagation();else if(qg(e,l),n&4&&-1<Iy.indexOf(e)){for(;d!==null;){var g=Kn(d);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var v=wn(g.pendingLanes);if(v!==0){var w=g;for(w.pendingLanes|=2,w.entangledLanes|=2;v;){var M=1<<31-Ge(v);w.entanglements[1]|=M,v&=~M}Ai(g),(Ot&6)===0&&($r=He()+500,Ea(0))}}break;case 31:case 13:w=Mn(g,2),w!==null&&Fe(w,g,2),Zr(),Zc(g,2)}if(g=Jc(l),g===null&&Fc(e,n,l,fl,a),g===d)break;d=g}d!==null&&l.stopPropagation()}else Fc(e,n,l,null,a)}}function Jc(e){return e=to(e),tu(e)}var fl=null;function tu(e){if(fl=null,e=Yn(e),e!==null){var n=o(e);if(n===null)e=null;else{var a=n.tag;if(a===13){if(e=c(n),e!==null)return e;e=null}else if(a===31){if(e=u(n),e!==null)return e;e=null}else if(a===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null)}}return fl=e,null}function Gg(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(xm()){case Qu:return 2;case Zu:return 8;case ir:case Tm:return 32;case Wu:return 268435456;default:return 32}default:return 32}}var eu=!1,gn=null,pn=null,mn=null,Oa=new Map,Na=new Map,yn=[],Iy="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function qg(e,n){switch(e){case"focusin":case"focusout":gn=null;break;case"dragenter":case"dragleave":pn=null;break;case"mouseover":case"mouseout":mn=null;break;case"pointerover":case"pointerout":Oa.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Na.delete(n.pointerId)}}function La(e,n,a,l,d,g){return e===null||e.nativeEvent!==g?(e={blockedOn:n,domEventName:a,eventSystemFlags:l,nativeEvent:g,targetContainers:[d]},n!==null&&(n=Kn(n),n!==null&&Hg(n)),e):(e.eventSystemFlags|=l,n=e.targetContainers,d!==null&&n.indexOf(d)===-1&&n.push(d),e)}function Hy(e,n,a,l,d){switch(n){case"focusin":return gn=La(gn,e,n,a,l,d),!0;case"dragenter":return pn=La(pn,e,n,a,l,d),!0;case"mouseover":return mn=La(mn,e,n,a,l,d),!0;case"pointerover":var g=d.pointerId;return Oa.set(g,La(Oa.get(g)||null,e,n,a,l,d)),!0;case"gotpointercapture":return g=d.pointerId,Na.set(g,La(Na.get(g)||null,e,n,a,l,d)),!0}return!1}function Vg(e){var n=Yn(e.target);if(n!==null){var a=o(n);if(a!==null){if(n=a.tag,n===13){if(n=c(a),n!==null){e.blockedOn=n,sh(e.priority,function(){jg(a)});return}}else if(n===31){if(n=u(a),n!==null){e.blockedOn=n,sh(e.priority,function(){jg(a)});return}}else if(n===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function gl(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var a=Jc(e.nativeEvent);if(a===null){a=e.nativeEvent;var l=new a.constructor(a.type,a);Jl=l,a.target.dispatchEvent(l),Jl=null}else return n=Kn(a),n!==null&&Hg(n),e.blockedOn=a,!1;n.shift()}return!0}function Xg(e,n,a){gl(e)&&a.delete(n)}function jy(){eu=!1,gn!==null&&gl(gn)&&(gn=null),pn!==null&&gl(pn)&&(pn=null),mn!==null&&gl(mn)&&(mn=null),Oa.forEach(Xg),Na.forEach(Xg)}function pl(e,n){e.blockedOn===n&&(e.blockedOn=null,eu||(eu=!0,m.unstable_scheduleCallback(m.unstable_NormalPriority,jy)))}var ml=null;function Yg(e){ml!==e&&(ml=e,m.unstable_scheduleCallback(m.unstable_NormalPriority,function(){ml===e&&(ml=null);for(var n=0;n<e.length;n+=3){var a=e[n],l=e[n+1],d=e[n+2];if(typeof l!="function"){if(tu(l||a)===null)continue;break}var g=Kn(a);g!==null&&(e.splice(n,3),n-=3,Jo(g,{pending:!0,data:d,method:a.method,action:l},l,d))}}))}function Ds(e){function n(M){return pl(M,e)}gn!==null&&pl(gn,e),pn!==null&&pl(pn,e),mn!==null&&pl(mn,e),Oa.forEach(n),Na.forEach(n);for(var a=0;a<yn.length;a++){var l=yn[a];l.blockedOn===e&&(l.blockedOn=null)}for(;0<yn.length&&(a=yn[0],a.blockedOn===null);)Vg(a),a.blockedOn===null&&yn.shift();if(a=(e.ownerDocument||e).$$reactFormReplay,a!=null)for(l=0;l<a.length;l+=3){var d=a[l],g=a[l+1],v=d[Ne]||null;if(typeof g=="function")v||Yg(a);else if(v){var w=null;if(g&&g.hasAttribute("formAction")){if(d=g,v=g[Ne]||null)w=v.formAction;else if(tu(d)!==null)continue}else w=v.action;typeof w=="function"?a[l+1]=w:(a.splice(l,3),l-=3),Yg(a)}}}function Kg(){function e(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(v){return d=v})},focusReset:"manual",scroll:"manual"})}function n(){d!==null&&(d(),d=null),l||setTimeout(a,20)}function a(){if(!l&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var l=!1,d=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(a,100),function(){l=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),d!==null&&(d(),d=null)}}}function iu(e){this._internalRoot=e}yl.prototype.render=iu.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(s(409));var a=n.current,l=Qe();Ug(a,l,e,n,null,null)},yl.prototype.unmount=iu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;Ug(e.current,2,null,e,null,null),Zr(),n[Xn]=null}};function yl(e){this._internalRoot=e}yl.prototype.unstable_scheduleHydration=function(e){if(e){var n=nh();e={blockedOn:null,target:e,priority:n};for(var a=0;a<yn.length&&n!==0&&n<yn[a].priority;a++);yn.splice(a,0,e),a===0&&Vg(e)}};var $g=t.version;if($g!=="19.2.3")throw Error(s(527,$g,"19.2.3"));G.findDOMNode=function(e){var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(s(188)):(e=Object.keys(e).join(","),Error(s(268,e)));return e=f(n),e=e!==null?p(e):null,e=e===null?null:e.stateNode,e};var Gy={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bl.isDisabled&&bl.supportsFiber)try{js=bl.inject(Gy),je=bl}catch{}}return Ba.createRoot=function(e,n){if(!r(e))throw Error(s(299));var a=!1,l="",d=ef,g=nf,v=sf;return n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onUncaughtError!==void 0&&(d=n.onUncaughtError),n.onCaughtError!==void 0&&(g=n.onCaughtError),n.onRecoverableError!==void 0&&(v=n.onRecoverableError)),n=Pg(e,1,!1,null,null,a,l,null,d,g,v,Kg),e[Xn]=n.current,Pc(e),new iu(n)},Ba.hydrateRoot=function(e,n,a){if(!r(e))throw Error(s(299));var l=!1,d="",g=ef,v=nf,w=sf,M=null;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(d=a.identifierPrefix),a.onUncaughtError!==void 0&&(g=a.onUncaughtError),a.onCaughtError!==void 0&&(v=a.onCaughtError),a.onRecoverableError!==void 0&&(w=a.onRecoverableError),a.formState!==void 0&&(M=a.formState)),n=Pg(e,1,!0,n,a??null,l,d,M,g,v,w,Kg),n.context=Fg(null),a=n.current,l=Qe(),l=Vl(l),d=en(l),d.callback=null,nn(a,d,l),a=l,n.current.lanes=a,qs(n,a),Ai(n),e[Xn]=n.current,Pc(e),new yl(n)},Ba.version="19.2.3",Ba}var ap;function tb(){if(ap)return au.exports;ap=1;function m(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(m)}catch(t){console.error(t)}}return m(),au.exports=Jy(),au.exports}var eb=tb();const ib=Hp(eb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nb=m=>m.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),sb=m=>m.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,i,s)=>s?s.toUpperCase():i.toLowerCase()),rp=m=>{const t=sb(m);return t.charAt(0).toUpperCase()+t.slice(1)},jp=(...m)=>m.filter((t,i,s)=>!!t&&t.trim()!==""&&s.indexOf(t)===i).join(" ").trim(),ab=m=>{for(const t in m)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var rb={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lb=ne.forwardRef(({color:m="currentColor",size:t=24,strokeWidth:i=2,absoluteStrokeWidth:s,className:r="",children:o,iconNode:c,...u},h)=>ne.createElement("svg",{ref:h,...rb,width:t,height:t,stroke:m,strokeWidth:s?Number(i)*24/Number(t):i,className:jp("lucide",r),...!o&&!ab(u)&&{"aria-hidden":"true"},...u},[...c.map(([f,p])=>ne.createElement(f,p)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=(m,t)=>{const i=ne.forwardRef(({className:s,...r},o)=>ne.createElement(lb,{ref:o,iconNode:t,className:jp(`lucide-${nb(rp(m))}`,`lucide-${m}`,s),...r}));return i.displayName=rp(m),i};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ob=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],cb=Te("arrow-left",ob);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ub=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],hb=Te("book-open",ub);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const db=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],fb=Te("circle-alert",db);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gb=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],lp=Te("external-link",gb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pb=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],op=Te("eye-off",pb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mb=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],cp=Te("eye",mb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yb=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],bb=Te("gauge",yb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vb=[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]],Ab=Te("headphones",vb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sb=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],up=Te("loader-circle",Sb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _b=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],wb=Te("pause",_b);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eb=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],xb=Te("play",Eb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tb=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Cb=Te("save",Tb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mb=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],hp=Te("settings",Mb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Db=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],cu=Te("sparkles",Db);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rb=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Ob=Te("upload",Rb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nb=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],dp=Te("user",Nb);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lb=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],kb=Te("volume-2",Lb);var Ga=(m=>(m.TEXT="text",m.DESCRIPTION="description",m))(Ga||{}),Pt=(m=>(m.IDLE="IDLE",m.UPLOADING="UPLOADING",m.PARSING_PDF="PARSING_PDF",m.EXTRACTING_SECTIONS="EXTRACTING_SECTIONS",m.PROCESSING_SECTION="PROCESSING_SECTION",m.GENERATING_VOICE="GENERATING_VOICE",m.PLAYING="PLAYING",m.PAUSED="PAUSED",m.COMPLETED="COMPLETED",m.ERROR="ERROR",m))(Pt||{});const Re=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),vu=[.001,0,0,.001,0,0],uu=1.35,Ze={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},vn={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Va="pdfjs_internal_editor_",yt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Ct={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},Bb={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Au={TRIANGLES:1,LATTICE:2},he={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Ml={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},ce={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Os={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Nl={ERRORS:0,WARNINGS:1,INFOS:5},Xa={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},za={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},zb={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Ll=Nl.WARNINGS;function Pb(m){Number.isInteger(m)&&(Ll=m)}function Fb(){return Ll}function kl(m){Ll>=Nl.INFOS&&console.info(`Info: ${m}`)}function pt(m){Ll>=Nl.WARNINGS&&console.warn(`Warning: ${m}`)}function Gt(m){throw new Error(m)}function Mt(m,t){m||Gt(t)}function Ub(m){switch(m?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Gp(m,t=null,i=null){if(!m)return null;if(i&&typeof m=="string"&&(i.addDefaultProtocol&&m.startsWith("www.")&&m.match(/\./g)?.length>=2&&(m=`http://${m}`),i.tryConvertEncoding))try{m=qb(m)}catch{}const s=t?URL.parse(m,t):URL.parse(m);return Ub(s)?s:null}function qp(m,t,i=!1){const s=URL.parse(m);return s?(s.hash=t,s.href):i&&Gp(m,"http://example.com")?m.split("#",1)[0]+`${t?`#${t}`:""}`:""}function mt(m,t,i,s=!1){return Object.defineProperty(m,t,{value:i,enumerable:!s,configurable:!0,writable:!1}),i}const qn=(function(){function t(i,s){this.message=i,this.name=s}return t.prototype=new Error,t.constructor=t,t})();class fp extends qn{constructor(t,i){super(t,"PasswordException"),this.code=i}}class hu extends qn{constructor(t,i){super(t,"UnknownErrorException"),this.details=i}}class Su extends qn{constructor(t){super(t,"InvalidPDFException")}}class Dl extends qn{constructor(t,i,s){super(t,"ResponseException"),this.status=i,this.missing=s}}class Ib extends qn{constructor(t){super(t,"FormatError")}}class An extends qn{constructor(t){super(t,"AbortException")}}function Vp(m){(typeof m!="object"||m?.length===void 0)&&Gt("Invalid argument for bytesToString");const t=m.length,i=8192;if(t<i)return String.fromCharCode.apply(null,m);const s=[];for(let r=0;r<t;r+=i){const o=Math.min(r+i,t),c=m.subarray(r,o);s.push(String.fromCharCode.apply(null,c))}return s.join("")}function $a(m){typeof m!="string"&&Gt("Invalid argument for stringToBytes");const t=m.length,i=new Uint8Array(t);for(let s=0;s<t;++s)i[s]=m.charCodeAt(s)&255;return i}function Hb(m){return String.fromCharCode(m>>24&255,m>>16&255,m>>8&255,m&255)}function jb(){const m=new Uint8Array(4);return m[0]=1,new Uint32Array(m.buffer,0,1)[0]===1}function Gb(){try{return new Function(""),!0}catch{return!1}}class de{static get isLittleEndian(){return mt(this,"isLittleEndian",jb())}static get isEvalSupported(){return mt(this,"isEvalSupported",Gb())}static get isOffscreenCanvasSupported(){return mt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return mt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return mt(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return mt(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:t,userAgent:i}=navigator;return mt(this,"platform",{isAndroid:i.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:i.includes("Firefox")})}static get isCSSRoundSupported(){return mt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const du=Array.from(Array(256).keys(),m=>m.toString(16).padStart(2,"0"));class it{static makeHexColor(t,i,s){return`#${du[t]}${du[i]}${du[s]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,i){let s;t[0]?(t[0]<0&&(s=i[0],i[0]=i[2],i[2]=s),i[0]*=t[0],i[2]*=t[0],t[3]<0&&(s=i[1],i[1]=i[3],i[3]=s),i[1]*=t[3],i[3]*=t[3]):(s=i[0],i[0]=i[1],i[1]=s,s=i[2],i[2]=i[3],i[3]=s,t[1]<0&&(s=i[1],i[1]=i[3],i[3]=s),i[1]*=t[1],i[3]*=t[1],t[2]<0&&(s=i[0],i[0]=i[2],i[2]=s),i[0]*=t[2],i[2]*=t[2]),i[0]+=t[4],i[1]+=t[5],i[2]+=t[4],i[3]+=t[5]}static transform(t,i){return[t[0]*i[0]+t[2]*i[1],t[1]*i[0]+t[3]*i[1],t[0]*i[2]+t[2]*i[3],t[1]*i[2]+t[3]*i[3],t[0]*i[4]+t[2]*i[5]+t[4],t[1]*i[4]+t[3]*i[5]+t[5]]}static multiplyByDOMMatrix(t,i){return[t[0]*i.a+t[2]*i.b,t[1]*i.a+t[3]*i.b,t[0]*i.c+t[2]*i.d,t[1]*i.c+t[3]*i.d,t[0]*i.e+t[2]*i.f+t[4],t[1]*i.e+t[3]*i.f+t[5]]}static applyTransform(t,i,s=0){const r=t[s],o=t[s+1];t[s]=r*i[0]+o*i[2]+i[4],t[s+1]=r*i[1]+o*i[3]+i[5]}static applyTransformToBezier(t,i,s=0){const r=i[0],o=i[1],c=i[2],u=i[3],h=i[4],f=i[5];for(let p=0;p<6;p+=2){const y=t[s+p],b=t[s+p+1];t[s+p]=y*r+b*c+h,t[s+p+1]=y*o+b*u+f}}static applyInverseTransform(t,i){const s=t[0],r=t[1],o=i[0]*i[3]-i[1]*i[2];t[0]=(s*i[3]-r*i[2]+i[2]*i[5]-i[4]*i[3])/o,t[1]=(-s*i[1]+r*i[0]+i[4]*i[1]-i[5]*i[0])/o}static axialAlignedBoundingBox(t,i,s){const r=i[0],o=i[1],c=i[2],u=i[3],h=i[4],f=i[5],p=t[0],y=t[1],b=t[2],A=t[3];let _=r*p+h,S=_,x=r*b+h,E=x,D=u*y+f,T=D,B=u*A+f,N=B;if(o!==0||c!==0){const k=o*p,z=o*b,K=c*y,Q=c*A;_+=K,E+=K,x+=Q,S+=Q,D+=k,N+=k,B+=z,T+=z}s[0]=Math.min(s[0],_,x,S,E),s[1]=Math.min(s[1],D,B,T,N),s[2]=Math.max(s[2],_,x,S,E),s[3]=Math.max(s[3],D,B,T,N)}static inverseTransform(t){const i=t[0]*t[3]-t[1]*t[2];return[t[3]/i,-t[1]/i,-t[2]/i,t[0]/i,(t[2]*t[5]-t[4]*t[3])/i,(t[4]*t[1]-t[5]*t[0])/i]}static singularValueDecompose2dScale(t,i){const s=t[0],r=t[1],o=t[2],c=t[3],u=s**2+r**2,h=s*o+r*c,f=o**2+c**2,p=(u+f)/2,y=Math.sqrt(p**2-(u*f-h**2));i[0]=Math.sqrt(p+y||1),i[1]=Math.sqrt(p-y||1)}static normalizeRect(t){const i=t.slice(0);return t[0]>t[2]&&(i[0]=t[2],i[2]=t[0]),t[1]>t[3]&&(i[1]=t[3],i[3]=t[1]),i}static intersect(t,i){const s=Math.max(Math.min(t[0],t[2]),Math.min(i[0],i[2])),r=Math.min(Math.max(t[0],t[2]),Math.max(i[0],i[2]));if(s>r)return null;const o=Math.max(Math.min(t[1],t[3]),Math.min(i[1],i[3])),c=Math.min(Math.max(t[1],t[3]),Math.max(i[1],i[3]));return o>c?null:[s,o,r,c]}static pointBoundingBox(t,i,s){s[0]=Math.min(s[0],t),s[1]=Math.min(s[1],i),s[2]=Math.max(s[2],t),s[3]=Math.max(s[3],i)}static rectBoundingBox(t,i,s,r,o){o[0]=Math.min(o[0],t,s),o[1]=Math.min(o[1],i,r),o[2]=Math.max(o[2],t,s),o[3]=Math.max(o[3],i,r)}static#t(t,i,s,r,o,c,u,h,f,p){if(f<=0||f>=1)return;const y=1-f,b=f*f,A=b*f,_=y*(y*(y*t+3*f*i)+3*b*s)+A*r,S=y*(y*(y*o+3*f*c)+3*b*u)+A*h;p[0]=Math.min(p[0],_),p[1]=Math.min(p[1],S),p[2]=Math.max(p[2],_),p[3]=Math.max(p[3],S)}static#e(t,i,s,r,o,c,u,h,f,p,y,b){if(Math.abs(f)<1e-12){Math.abs(p)>=1e-12&&this.#t(t,i,s,r,o,c,u,h,-y/p,b);return}const A=p**2-4*y*f;if(A<0)return;const _=Math.sqrt(A),S=2*f;this.#t(t,i,s,r,o,c,u,h,(-p+_)/S,b),this.#t(t,i,s,r,o,c,u,h,(-p-_)/S,b)}static bezierBoundingBox(t,i,s,r,o,c,u,h,f){f[0]=Math.min(f[0],t,u),f[1]=Math.min(f[1],i,h),f[2]=Math.max(f[2],t,u),f[3]=Math.max(f[3],i,h),this.#e(t,s,o,u,i,r,c,h,3*(-t+3*(s-o)+u),6*(t-2*s+o),3*(s-t),f),this.#e(t,s,o,u,i,r,c,h,3*(-i+3*(r-c)+h),6*(i-2*r+c),3*(r-i),f)}}function qb(m){return decodeURIComponent(escape(m))}let fu=null,gp=null;function Vb(m){return fu||(fu=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,gp=new Map([["","t"]])),m.replaceAll(fu,(t,i,s)=>i?i.normalize("NFKC"):gp.get(s))}function Xp(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const m=new Uint8Array(32);return crypto.getRandomValues(m),Vp(m)}const ks="pdfjs_internal_id_";function Xb(m,t,i){if(!Array.isArray(i)||i.length<2)return!1;const[s,r,...o]=i;if(!m(s)&&!Number.isInteger(s)||!t(r))return!1;const c=o.length;let u=!0;switch(r.name){case"XYZ":if(c<2||c>3)return!1;break;case"Fit":case"FitB":return c===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(c>1)return!1;break;case"FitR":if(c!==4)return!1;u=!1;break;default:return!1}for(const h of o)if(!(typeof h=="number"||u&&h===null))return!1;return!0}function Oe(m,t,i){return Math.min(Math.max(m,t),i)}function Yp(m){return Uint8Array.prototype.toBase64?m.toBase64():btoa(Vp(m))}function Yb(m){return Uint8Array.fromBase64?Uint8Array.fromBase64(m):$a(atob(m))}typeof Promise.try!="function"&&(Promise.try=function(m,...t){return new Promise(i=>{i(m(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(m){return m.reduce((t,i)=>t+i,0)});class Ya{static textContent(t){const i=[],s={items:i,styles:Object.create(null)};function r(o){if(!o)return;let c=null;const u=o.name;if(u==="#text")c=o.value;else if(Ya.shouldBuildText(u))o?.attributes?.textContent?c=o.attributes.textContent:o.value&&(c=o.value);else return;if(c!==null&&i.push({str:c}),!!o.children)for(const h of o.children)r(h)}return r(t),s}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class Kp{static setupStorage(t,i,s,r,o){const c=r.getValue(i,{value:null});switch(s.name){case"textarea":if(c.value!==null&&(t.textContent=c.value),o==="print")break;t.addEventListener("input",u=>{r.setValue(i,{value:u.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(c.value===s.attributes.xfaOn?t.setAttribute("checked",!0):c.value===s.attributes.xfaOff&&t.removeAttribute("checked"),o==="print")break;t.addEventListener("change",u=>{r.setValue(i,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(c.value!==null&&t.setAttribute("value",c.value),o==="print")break;t.addEventListener("input",u=>{r.setValue(i,{value:u.target.value})})}break;case"select":if(c.value!==null){t.setAttribute("value",c.value);for(const u of s.children)u.attributes.value===c.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const h=u.target.options,f=h.selectedIndex===-1?"":h[h.selectedIndex].value;r.setValue(i,{value:f})});break}}static setAttributes({html:t,element:i,storage:s=null,intent:r,linkService:o}){const{attributes:c}=i,u=t instanceof HTMLAnchorElement;c.type==="radio"&&(c.name=`${c.name}-${r}`);for(const[h,f]of Object.entries(c))if(f!=null)switch(h){case"class":f.length&&t.setAttribute(h,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!u||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,f)}u&&o.addLinkAttributes(t,c.href,c.newWindow),s&&c.dataId&&this.setupStorage(t,c.dataId,i,s)}static render(t){const i=t.annotationStorage,s=t.linkService,r=t.xfaHtml,o=t.intent||"display",c=document.createElement(r.name);r.attributes&&this.setAttributes({html:c,element:r,intent:o,linkService:s});const u=o!=="richText",h=t.div;if(h.append(c),t.viewport){const y=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=y}u&&h.setAttribute("class","xfaLayer xfaFont");const f=[];if(r.children.length===0){if(r.value){const y=document.createTextNode(r.value);c.append(y),u&&Ya.shouldBuildText(r.name)&&f.push(y)}return{textDivs:f}}const p=[[r,-1,c]];for(;p.length>0;){const[y,b,A]=p.at(-1);if(b+1===y.children.length){p.pop();continue}const _=y.children[++p.at(-1)[1]];if(_===null)continue;const{name:S}=_;if(S==="#text"){const E=document.createTextNode(_.value);f.push(E),A.append(E);continue}const x=_?.attributes?.xmlns?document.createElementNS(_.attributes.xmlns,S):document.createElement(S);if(A.append(x),_.attributes&&this.setAttributes({html:x,element:_,storage:i,intent:o,linkService:s}),_.children?.length>0)p.push([_,-1,x]);else if(_.value){const E=document.createTextNode(_.value);u&&Ya.shouldBuildText(S)&&f.push(E),x.append(E)}}for(const y of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))y.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const i=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=i,t.div.hidden=!1}}const Vi="http://www.w3.org/2000/svg";class Hs{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Qa(m,t="text"){if(Ha(m,document.baseURI)){const i=await fetch(m);if(!i.ok)throw new Error(i.statusText);switch(t){case"arraybuffer":return i.arrayBuffer();case"blob":return i.blob();case"json":return i.json()}return i.text()}return new Promise((i,s)=>{const r=new XMLHttpRequest;r.open("GET",m,!0),r.responseType=t,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(t){case"arraybuffer":case"blob":case"json":i(r.response);return}i(r.responseText);return}s(new Error(r.statusText))}},r.send(null)})}class Za{constructor({viewBox:t,userUnit:i,scale:s,rotation:r,offsetX:o=0,offsetY:c=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=i,this.scale=s,this.rotation=r,this.offsetX=o,this.offsetY=c,s*=i;const h=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let p,y,b,A;switch(r%=360,r<0&&(r+=360),r){case 180:p=-1,y=0,b=0,A=1;break;case 90:p=0,y=1,b=1,A=0;break;case 270:p=0,y=-1,b=-1,A=0;break;case 0:p=1,y=0,b=0,A=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(b=-b,A=-A);let _,S,x,E;p===0?(_=Math.abs(f-t[1])*s+o,S=Math.abs(h-t[0])*s+c,x=(t[3]-t[1])*s,E=(t[2]-t[0])*s):(_=Math.abs(h-t[0])*s+o,S=Math.abs(f-t[1])*s+c,x=(t[2]-t[0])*s,E=(t[3]-t[1])*s),this.transform=[p*s,y*s,b*s,A*s,_-p*s*h-b*s*f,S-y*s*h-A*s*f],this.width=x,this.height=E}get rawDims(){const t=this.viewBox;return mt(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:i=this.rotation,offsetX:s=this.offsetX,offsetY:r=this.offsetY,dontFlip:o=!1}={}){return new Za({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:i,offsetX:s,offsetY:r,dontFlip:o})}convertToViewportPoint(t,i){const s=[t,i];return it.applyTransform(s,this.transform),s}convertToViewportRectangle(t){const i=[t[0],t[1]];it.applyTransform(i,this.transform);const s=[t[2],t[3]];return it.applyTransform(s,this.transform),[i[0],i[1],s[0],s[1]]}convertToPdfPoint(t,i){const s=[t,i];return it.applyInverseTransform(s,this.transform),s}}class ku extends qn{constructor(t,i=0){super(t,"RenderingCancelledException"),this.extraDelay=i}}function Bl(m){const t=m.length;let i=0;for(;i<t&&m[i].trim()==="";)i++;return m.substring(i,i+5).toLowerCase()==="data:"}function Bu(m){return typeof m=="string"&&/\.pdf$/i.test(m)}function Kb(m){return[m]=m.split(/[#?]/,1),m.substring(m.lastIndexOf("/")+1)}function $b(m,t="document.pdf"){if(typeof m!="string")return t;if(Bl(m))return pt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const s=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(m);if(!s)return t;const r=u=>{try{let h=decodeURIComponent(u);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:u):h}catch{return u}},o=/\.pdf$/i,c=s.pathname.split("/").at(-1);if(o.test(c))return r(c);if(s.searchParams.size>0){const u=Array.from(s.searchParams.values()).reverse();for(const f of u)if(o.test(f))return r(f);const h=Array.from(s.searchParams.keys()).reverse();for(const f of h)if(o.test(f))return r(f)}if(s.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(h)return r(h[0])}return t}class pp{started=Object.create(null);times=[];time(t){t in this.started&&pt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||pt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let i=0;for(const{name:s}of this.times)i=Math.max(s.length,i);for(const{name:s,start:r,end:o}of this.times)t.push(`${s.padEnd(i)} ${o-r}ms
`);return t.join("")}}function Ha(m,t){const i=t?URL.parse(m,t):URL.parse(m);return i?.protocol==="http:"||i?.protocol==="https:"}function fi(m){m.preventDefault()}function Jt(m){m.preventDefault(),m.stopPropagation()}function Qb(m){console.log("Deprecated API usage: "+m)}class _u{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const i=this.#t.exec(t);if(!i)return null;const s=parseInt(i[1],10);let r=parseInt(i[2],10);r=r>=1&&r<=12?r-1:0;let o=parseInt(i[3],10);o=o>=1&&o<=31?o:1;let c=parseInt(i[4],10);c=c>=0&&c<=23?c:0;let u=parseInt(i[5],10);u=u>=0&&u<=59?u:0;let h=parseInt(i[6],10);h=h>=0&&h<=59?h:0;const f=i[7]||"Z";let p=parseInt(i[8],10);p=p>=0&&p<=23?p:0;let y=parseInt(i[9],10)||0;return y=y>=0&&y<=59?y:0,f==="-"?(c+=p,u+=y):f==="+"&&(c-=p,u-=y),new Date(Date.UTC(s,r,o,c,u,h))}}function Zb(m,{scale:t=1,rotation:i=0}){const{width:s,height:r}=m.attributes.style,o=[0,0,parseInt(s),parseInt(r)];return new Za({viewBox:o,userUnit:1,scale:t,rotation:i})}function Wa(m){if(m.startsWith("#")){const t=parseInt(m.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return m.startsWith("rgb(")?m.slice(4,-1).split(",").map(t=>parseInt(t)):m.startsWith("rgba(")?m.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(pt(`Not a valid color format: "${m}"`),[0,0,0])}function Wb(m){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const i of m.keys()){t.style.color=i;const s=window.getComputedStyle(t).color;m.set(i,Wa(s))}t.remove()}function $t(m){const{a:t,b:i,c:s,d:r,e:o,f:c}=m.getTransform();return[t,i,s,r,o,c]}function Si(m){const{a:t,b:i,c:s,d:r,e:o,f:c}=m.getTransform().invertSelf();return[t,i,s,r,o,c]}function jn(m,t,i=!1,s=!0){if(t instanceof Za){const{pageWidth:r,pageHeight:o}=t.rawDims,{style:c}=m,u=de.isCSSRoundSupported,h=`var(--total-scale-factor) * ${r}px`,f=`var(--total-scale-factor) * ${o}px`,p=u?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,y=u?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!i||t.rotation%180===0?(c.width=p,c.height=y):(c.width=y,c.height=p)}s&&m.setAttribute("data-main-rotation",t.rotation)}class xi{constructor(){const{pixelRatio:t}=xi;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,i,s,r,o=-1){let c=1/0,u=1/0,h=1/0;s=xi.capPixels(s,o),s>0&&(c=Math.sqrt(s/(t*i))),r!==-1&&(u=r/t,h=r/i);const f=Math.min(c,u,h);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,i){if(i>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+i/100));return t>0?Math.min(t,s):s}return t}}const wu=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class Jb{static get isDarkMode(){return mt(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class tv{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:i}=t;i.width=i.height="0",i.display="none",i.color="var(--comment-fg-color)",document.body.append(t);const{color:s}=window.getComputedStyle(t);return t.remove(),mt(this,"commentForegroundColor",Wa(s))}}function ev(m,t,i,s){s=Math.min(Math.max(s??1,0),1);const r=255*(1-s);return m=Math.round(m*s+r),t=Math.round(t*s+r),i=Math.round(i*s+r),[m,t,i]}function mp(m,t){const i=m[0]/255,s=m[1]/255,r=m[2]/255,o=Math.max(i,s,r),c=Math.min(i,s,r),u=(o+c)/2;if(o===c)t[0]=t[1]=0;else{const h=o-c;switch(t[1]=u<.5?h/(o+c):h/(2-o-c),o){case i:t[0]=((s-r)/h+(s<r?6:0))*60;break;case s:t[0]=((r-i)/h+2)*60;break;case r:t[0]=((i-s)/h+4)*60;break}}t[2]=u}function Eu(m,t){const i=m[0],s=m[1],r=m[2],o=(1-Math.abs(2*r-1))*s,c=o*(1-Math.abs(i/60%2-1)),u=r-o/2;switch(Math.floor(i/60)){case 0:t[0]=o+u,t[1]=c+u,t[2]=u;break;case 1:t[0]=c+u,t[1]=o+u,t[2]=u;break;case 2:t[0]=u,t[1]=o+u,t[2]=c+u;break;case 3:t[0]=u,t[1]=c+u,t[2]=o+u;break;case 4:t[0]=c+u,t[1]=u,t[2]=o+u;break;case 5:case 6:t[0]=o+u,t[1]=u,t[2]=c+u;break}}function yp(m){return m<=.03928?m/12.92:((m+.055)/1.055)**2.4}function bp(m,t,i){Eu(m,i),i.map(yp);const s=.2126*i[0]+.7152*i[1]+.0722*i[2];Eu(t,i),i.map(yp);const r=.2126*i[0]+.7152*i[1]+.0722*i[2];return s>r?(s+.05)/(r+.05):(r+.05)/(s+.05)}const vp=new Map;function iv(m,t){const i=m[0]+m[1]*256+m[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let s=vp.get(i);if(s)return s;const r=new Float32Array(9),o=r.subarray(0,3),c=r.subarray(3,6);mp(m,c);const u=r.subarray(6,9);mp(t,u);const h=u[2]<.5,f=h?12:4.5;if(c[2]=h?Math.sqrt(c[2]):1-Math.sqrt(1-c[2]),bp(c,u,o)<f){let p,y;h?(p=c[2],y=1):(p=0,y=c[2]);const b=.005;for(;y-p>b;){const A=c[2]=(p+y)/2;h===bp(c,u,o)<f?p=A:y=A}c[2]=h?y:p}return Eu(c,o),s=it.makeHexColor(Math.round(o[0]*255),Math.round(o[1]*255),Math.round(o[2]*255)),vp.set(i,s),s}function $p({html:m,dir:t,className:i},s){const r=document.createDocumentFragment();if(typeof m=="string"){const o=document.createElement("p");o.dir=t||"auto";const c=m.split(/(?:\r\n?|\n)/);for(let u=0,h=c.length;u<h;++u){const f=c[u];o.append(document.createTextNode(f)),u<h-1&&o.append(document.createElement("br"))}r.append(o)}else Kp.render({xfaHtml:m,div:r,intent:"richText"});r.firstElementChild.classList.add("richText",i),s.append(r)}function Qp(m){const t=new Path2D;if(!m)return t;for(let i=0,s=m.length;i<s;)switch(m[i++]){case za.moveTo:t.moveTo(m[i++],m[i++]);break;case za.lineTo:t.lineTo(m[i++],m[i++]);break;case za.curveTo:t.bezierCurveTo(m[i++],m[i++],m[i++],m[i++],m[i++],m[i++]);break;case za.quadraticCurveTo:t.quadraticCurveTo(m[i++],m[i++],m[i++],m[i++]);break;case za.closePath:t.closePath();break;default:pt(`Unrecognized drawing path operator: ${m[i-1]}`);break}return t}class qa{#t=null;#e=null;#n;#i=null;#r=null;#a=null;#s=null;#l=null;static#c=null;constructor(t){this.#n=t,qa.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const i=this.#n._uiManager._signal;i instanceof AbortSignal&&!i.aborted&&(t.addEventListener("contextmenu",fi,{signal:i}),t.addEventListener("pointerdown",qa.#o,{signal:i}));const s=this.#i=document.createElement("div");s.className="buttons",t.append(s);const r=this.#n.toolbarPosition;if(r){const{style:o}=t,c=this.#n._uiManager.direction==="ltr"?1-r[0]:r[0];o.insetInlineEnd=`${100*c}%`,o.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#o(t){t.stopPropagation()}#d(t){this.#n._focusEventsAllowed=!1,Jt(t)}#h(t){this.#n._focusEventsAllowed=!0,Jt(t)}#f(t){const i=this.#n._uiManager._signal;return!(i instanceof AbortSignal)||i.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:i}),t.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:i}),t.addEventListener("contextmenu",fi,{signal:i}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#r?.shown(),this.#a?.shown()}addDeleteButton(){const{editorType:t,_uiManager:i}=this.#n,s=document.createElement("button");s.classList.add("basic","deleteButton"),s.tabIndex=0,s.setAttribute("data-l10n-id",qa.#c[t]),this.#f(s)&&s.addEventListener("click",r=>{i.delete()},{signal:i._signal}),this.#i.append(s)}get#m(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const i=await t.render();this.#f(i),this.#i.append(i,this.#m),this.#r=t}addComment(t,i=null){if(this.#a)return;const s=t.renderForToolbar();if(!s)return;this.#f(s);const r=this.#s=this.#m;i?(this.#i.insertBefore(s,i),this.#i.insertBefore(r,i)):this.#i.append(s,r),this.#a=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const i=t.renderButton();this.#f(i),this.#i.append(i,this.#m)}async addEditSignatureButton(t){const i=this.#l=await t.renderEditButton(this.#n);this.#f(i),this.#i.append(i,this.#m)}removeButton(t){switch(t){case"comment":this.#a?.removeToolbarCommentButton(),this.#a=null,this.#s?.remove(),this.#s=null;break}}async addButton(t,i){switch(t){case"colorPicker":i&&this.addColorPicker(i);break;case"altText":i&&await this.addAltText(i);break;case"editSignature":i&&await this.addEditSignatureButton(i);break;case"delete":this.addDeleteButton();break;case"comment":i&&this.addComment(i);break}}async addButtonBefore(t,i,s){if(!i&&t==="comment")return;const r=this.#i.querySelector(s);r&&t==="comment"&&this.addComment(i,r)}updateEditSignatureButton(t){this.#l&&(this.#l.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class nv{#t=null;#e=null;#n;constructor(t){this.#n=t}#i(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const i=this.#n._signal;i instanceof AbortSignal&&!i.aborted&&t.addEventListener("contextmenu",fi,{signal:i});const s=this.#t=document.createElement("div");return s.className="buttons",t.append(s),this.#n.hasCommentManager()&&this.#a("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#n.commentSelection("floating_button")}),this.#a("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#n.highlightSelection("floating_button")}),t}#r(t,i){let s=0,r=0;for(const o of t){const c=o.y+o.height;if(c<s)continue;const u=o.x+(i?o.width:0);if(c>s){r=u,s=c;continue}i?u>r&&(r=u):u<r&&(r=u)}return[i?1-r:r,s]}show(t,i,s){const[r,o]=this.#r(i,s),{style:c}=this.#e||=this.#i();t.append(this.#e),c.insetInlineEnd=`${100*r}%`,c.top=`calc(${100*o}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#a(t,i,s,r){const o=document.createElement("button");o.classList.add("basic",t),o.tabIndex=0,o.setAttribute("data-l10n-id",i);const c=document.createElement("span");o.append(c),c.className="visuallyHidden",c.setAttribute("data-l10n-id",s);const u=this.#n._signal;u instanceof AbortSignal&&!u.aborted&&(o.addEventListener("contextmenu",fi,{signal:u}),o.addEventListener("click",r,{signal:u})),this.#t.append(o)}}function Zp(m,t,i){for(const s of i)t.addEventListener(s,m[s].bind(m))}class Lt{static#t=NaN;static#e=null;static#n=NaN;static#i=null;static initializeAndAddPointerId(t){(Lt.#e||=new Set).add(t)}static setPointer(t,i){Lt.#t||=i,Lt.#i??=t}static setTimeStamp(t){Lt.#n=t}static isSamePointerId(t){return Lt.#t===t}static isSamePointerIdOrRemove(t){return Lt.#t===t?!0:(Lt.#e?.delete(t),!1)}static isSamePointerType(t){return Lt.#i===t}static isInitializedAndDifferentPointerType(t){return Lt.#i!==null&&!Lt.isSamePointerType(t)}static isSameTimeStamp(t){return Lt.#n===t}static isUsingMultiplePointers(){return Lt.#e?.size>=1}static clearPointerType(){Lt.#i=null}static clearPointerIds(){Lt.#t=NaN,Lt.#e=null}static clearTimeStamp(){Lt.#n=NaN}}class sv{#t=0;get id(){return`${Va}${this.#t++}`}}class zu{#t=Xp();#e=0;#n=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=t;const o=r.decode().then(()=>(s.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return mt(this,"_isSVGFittingCanvas",o)}async#i(t,i){this.#n||=new Map;let s=this.#n.get(t);if(s===null)return null;if(s?.bitmap)return s.refCounter+=1,s;try{s||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let r;if(typeof i=="string"?(s.url=i,r=await Qa(i,"blob")):i instanceof File?r=s.file=i:i instanceof Blob&&(r=i),r.type==="image/svg+xml"){const o=zu._isSVGFittingCanvas,c=new FileReader,u=new Image,h=new Promise((f,p)=>{u.onload=()=>{s.bitmap=u,s.isSvg=!0,f()},c.onload=async()=>{const y=s.svgUrl=c.result;u.src=await o?`${y}#svgView(preserveAspectRatio(none))`:y},u.onerror=c.onerror=p});c.readAsDataURL(r),await h}else s.bitmap=await createImageBitmap(r);s.refCounter=1}catch(r){pt(r),s=null}return this.#n.set(t,s),s&&this.#n.set(s.id,s),s}async getFromFile(t){const{lastModified:i,name:s,size:r,type:o}=t;return this.#i(`${i}_${s}_${r}_${o}`,t)}async getFromUrl(t){return this.#i(t,t)}async getFromBlob(t,i){const s=await i;return this.#i(t,s)}async getFromId(t){this.#n||=new Map;const i=this.#n.get(t);if(!i)return null;if(i.bitmap)return i.refCounter+=1,i;if(i.file)return this.getFromFile(i.file);if(i.blobPromise){const{blobPromise:s}=i;return delete i.blobPromise,this.getFromBlob(i.id,s)}return this.getFromUrl(i.url)}getFromCanvas(t,i){this.#n||=new Map;let s=this.#n.get(t);if(s?.bitmap)return s.refCounter+=1,s;const r=new OffscreenCanvas(i.width,i.height);return r.getContext("2d").drawImage(i,0,0),s={bitmap:r.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#n.set(t,s),this.#n.set(s.id,s),s}getSvgUrl(t){const i=this.#n.get(t);return i?.isSvg?i.svgUrl:null}deleteId(t){this.#n||=new Map;const i=this.#n.get(t);if(!i||(i.refCounter-=1,i.refCounter!==0))return;const{bitmap:s}=i;if(!i.url&&!i.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),i.blobPromise=r.convertToBlob()}s.close?.(),i.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class av{#t=[];#e=!1;#n;#i=-1;constructor(t=128){this.#n=t}add({cmd:t,undo:i,post:s,mustExec:r,type:o=NaN,overwriteIfSameType:c=!1,keepUndo:u=!1}){if(r&&t(),this.#e)return;const h={cmd:t,undo:i,post:s,type:o};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(h);return}if(c&&this.#t[this.#i].type===o){u&&(h.undo=this.#t[this.#i].undo),this.#t[this.#i]=h;return}const f=this.#i+1;f===this.#n?this.#t.splice(0,1):(this.#i=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(h)}undo(){if(this.#i===-1)return;this.#e=!0;const{undo:t,post:i}=this.#t[this.#i];t(),i?.(),this.#e=!1,this.#i-=1}redo(){if(this.#i<this.#t.length-1){this.#i+=1,this.#e=!0;const{cmd:t,post:i}=this.#t[this.#i];t(),i?.(),this.#e=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}cleanType(t){if(this.#i!==-1){for(let i=this.#i;i>=0;i--)if(this.#t[i].type!==t){this.#t.splice(i+1,this.#i-i),this.#i=i;return}this.#t.length=0,this.#i=-1}}destroy(){this.#t=null}}class Ja{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:i}=de.platform;for(const[s,r,o={}]of t)for(const c of s){const u=c.startsWith("mac+");i&&u?(this.callbacks.set(c.slice(4),{callback:r,options:o}),this.allKeys.add(c.split("+").at(-1))):!i&&!u&&(this.callbacks.set(c,{callback:r,options:o}),this.allKeys.add(c.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const i=this.buffer.join("+");return this.buffer.length=0,i}exec(t,i){if(!this.allKeys.has(i.key))return;const s=this.callbacks.get(this.#t(i));if(!s)return;const{callback:r,options:{bubbles:o=!1,args:c=[],checker:u=null}}=s;u&&!u(t,i)||(r.bind(t,...c,i)(),o||Jt(i))}}class Pu{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return Wb(t),mt(this,"_colors",t)}convert(t){const i=Wa(t);if(!window.matchMedia("(forced-colors: active)").matches)return i;for(const[s,r]of this._colors)if(r.every((o,c)=>o===i[c]))return Pu._colorsMapping.get(s);return i}getHexCode(t){const i=this._colors.get(t);return i?it.makeHexColor(...i):t}}class Sn{#t=new AbortController;#e=null;#n=null;#i=new Map;#r=new Map;#a=null;#s=null;#l=null;#c=new av;#o=null;#d=null;#h=null;#f=0;#m=new Set;#p=null;#u=null;#g=new Set;_editorUndoBar=null;#y=!1;#v=!1;#b=!1;#x=null;#w=null;#S=null;#C=null;#A=!1;#E=null;#R=new sv;#M=!1;#D=!1;#P=!1;#N=null;#k=null;#F=null;#B=null;#q=null;#T=yt.NONE;#_=new Set;#L=null;#U=null;#H=null;#Y=null;#X=null;#K={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#j=[0,0];#z=null;#V=null;#W=null;#J=null;#I=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=Sn.prototype,i=c=>c.#V.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&c.hasSomethingToControl(),s=(c,{target:u})=>{if(u instanceof HTMLInputElement){const{type:h}=u;return h!=="text"&&h!=="number"}return!0},r=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return mt(this,"_keyboardManager",new Ja([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],t.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:s}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#V.contains(u)&&!c.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#V.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-o,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[o,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-o],checker:i}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,o],checker:i}]]))}constructor(t,i,s,r,o,c,u,h,f,p,y,b,A,_,S,x){const E=this._signal=this.#t.signal;this.#V=t,this.#W=i,this.#J=s,this.#a=r,this.#o=o,this.#U=c,this.#X=h,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:E}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:E}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:E}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:E}),u._on("setpreference",this.onSetPreference.bind(this),{signal:E}),u._on("switchannotationeditorparams",D=>this.updateParams(D.type,D.value),{signal:E}),window.addEventListener("pointerdown",()=>{this.#D=!0},{capture:!0,signal:E}),window.addEventListener("pointerup",()=>{this.#D=!1},{capture:!0,signal:E}),this.#rt(),this.#dt(),this.#et(),this.#s=h.annotationStorage,this.#x=h.filterFactory,this.#H=f,this.#C=p||null,this.#y=y,this.#v=b,this.#b=A,this.#q=_||null,this.viewParameters={realScale:Hs.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=S||null,this._supportsPinchToZoom=x!==!1,o?.setSidebarUiManager(this)}destroy(){this.#I?.resolve(),this.#I=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#r.values())t.destroy();this.#r.clear(),this.#i.clear(),this.#g.clear(),this.#B?.clear(),this.#e=null,this.#_.clear(),this.#c.destroy(),this.#a?.destroy(),this.#o?.destroy(),this.#U?.destroy(),this.#E?.hide(),this.#E=null,this.#F?.destroy(),this.#F=null,this.#n=null,this.#w&&(clearTimeout(this.#w),this.#w=null),this.#z&&(clearTimeout(this.#z),this.#z=null),this._editorUndoBar?.destroy(),this.#X=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#q}get useNewAltTextFlow(){return this.#v}get useNewAltTextWhenAddingImage(){return this.#b}get hcmFilter(){return mt(this,"hcmFilter",this.#H?this.#x.addHCMFilter(this.#H.foreground,this.#H.background):"none")}get direction(){return mt(this,"direction",getComputedStyle(this.#V).direction)}get _highlightColors(){return mt(this,"_highlightColors",this.#C?new Map(this.#C.split(",").map(t=>(t=t.split("=").map(i=>i.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return mt(this,"highlightColors",null);const i=new Map,s=!!this.#H;for(const[r,o]of t){const c=r.endsWith("_HCM");if(s&&c){i.set(r.replace("_HCM",""),o);continue}!s&&!c&&i.set(r,o)}return mt(this,"highlightColors",i)}get highlightColorNames(){return mt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const i=this.highlightColorNames.get(t);return this._highlightColors.get(i)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=t}setMainHighlightColorPicker(t){this.#F=t}editAltText(t,i=!1){this.#a?.editAltText(this,t,i)}hasCommentManager(){return!!this.#o}editComment(t,i,s,r){this.#o?.showDialog(this,t,i,s,r)}selectComment(t,i){this.#r.get(t)?.getEditorByUID(i)?.toggleComment(!0,!0)}updateComment(t){this.#o?.updateComment(t.getData())}updatePopupColor(t){this.#o?.updatePopupColor(t)}removeComment(t){this.#o?.removeComments([t.uid])}toggleComment(t,i,s=void 0){this.#o?.toggleCommentPopup(t,i,s)}makeCommentColor(t,i){return t&&this.#o?.makeCommentColor(t,i)||null}getCommentDialogElement(){return this.#o?.dialogElement||null}async waitForEditorsRendered(t){if(this.#r.has(t-1))return;const{resolve:i,promise:s}=Promise.withResolvers(),r=o=>{o.pageNumber===t&&(this._eventBus._off("editorsrendered",r),i())};this._eventBus.on("editorsrendered",r),await s}getSignature(t){this.#U?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#U}switchToMode(t,i){this._eventBus.on("annotationeditormodechanged",i,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,i){this._eventBus.dispatch("setpreference",{source:this,name:t,value:i})}onSetPreference({name:t,value:i}){switch(t){case"enableNewAltTextWhenAddingImage":this.#b=i;break}}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#V.focus()}findParent(t,i){for(const s of this.#r.values()){const{x:r,y:o,width:c,height:u}=s.div.getBoundingClientRect();if(t>=r&&t<=r+c&&i>=o&&i<=o+u)return s}return null}disableUserSelect(t=!1){this.#W.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#g.add(t)}removeShouldRescale(t){this.#g.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Hs.PDF_TO_CSS_UNITS;for(const i of this.#g)i.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#Z({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:i}=this;if(i.hasTextLayer(t))return i;for(const s of this.#r.values())if(s.hasTextLayer(t))return s;return null}highlightSelection(t="",i=!1){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:r,anchorOffset:o,focusNode:c,focusOffset:u}=s,h=s.toString(),p=this.#Z(s).closest(".textLayer"),y=this.getSelectionBoxes(p);if(!y)return;s.empty();const b=this.#tt(p),A=this.#T===yt.NONE,_=()=>{const S=b?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:y,anchorNode:r,anchorOffset:o,focusNode:c,focusOffset:u,text:h});A&&this.showAllEditors("highlight",!0,!0),i&&S?.editComment()};if(A){this.switchToMode(yt.HIGHLIGHT,_);return}_()}commentSelection(t=""){this.highlightSelection(t,!0)}#st(){const t=document.getSelection();if(!t||t.isCollapsed)return;const s=this.#Z(t).closest(".textLayer"),r=this.getSelectionBoxes(s);r&&(this.#E||=new nv(this),this.#E.show(s,r,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#s)return null;const i=`${Va}${t}`,s=this.#s.getRawValue(i);return s&&this.#s.remove(i),s}addToAnnotationStorage(t){!t.isEmpty()&&this.#s&&!this.#s.has(t.id)&&this.#s.setValue(t.id,t)}a11yAlert(t,i=null){const s=this.#J;s&&(s.setAttribute("data-l10n-id",t),i?s.setAttribute("data-l10n-args",JSON.stringify(i)):s.removeAttribute("data-l10n-args"))}#at(){const t=document.getSelection();if(!t||t.isCollapsed){this.#L&&(this.#E?.hide(),this.#L=null,this.#O({hasSelectedText:!1}));return}const{anchorNode:i}=t;if(i===this.#L)return;const r=this.#Z(t).closest(".textLayer");if(!r){this.#L&&(this.#E?.hide(),this.#L=null,this.#O({hasSelectedText:!1}));return}if(this.#E?.hide(),this.#L=i,this.#O({hasSelectedText:!0}),!(this.#T!==yt.HIGHLIGHT&&this.#T!==yt.NONE)&&(this.#T===yt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#A=this.isShiftKeyDown,!this.isShiftKeyDown)){const o=this.#T===yt.HIGHLIGHT?this.#tt(r):null;if(o?.toggleDrawing(),this.#D){const c=new AbortController,u=this.combinedSignal(c),h=f=>{f.type==="pointerup"&&f.button!==0||(c.abort(),o?.toggleDrawing(!0),f.type==="pointerup"&&this.#$("main_toolbar"))};window.addEventListener("pointerup",h,{signal:u}),window.addEventListener("blur",h,{signal:u})}else o?.toggleDrawing(!0),this.#$("main_toolbar")}}#$(t=""){this.#T===yt.HIGHLIGHT?this.highlightSelection(t):this.#y&&this.#st()}#rt(){document.addEventListener("selectionchange",this.#at.bind(this),{signal:this._signal})}#lt(){if(this.#S)return;this.#S=new AbortController;const t=this.combinedSignal(this.#S);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#ot(){this.#S?.abort(),this.#S=null}blur(){if(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#$("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const i of this.#_)if(i.div.contains(t)){this.#k=[i,t],i._focusEventsAllowed=!1;break}}focus(){if(!this.#k)return;const[t,i]=this.#k;this.#k=null,i.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),i.focus()}#et(){if(this.#N)return;this.#N=new AbortController;const t=this.combinedSignal(this.#N);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ct(){this.#N?.abort(),this.#N=null}#ut(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#ht(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.setEditingState(!0)}removeEditListeners(){this.#ct(),this.setEditingState(!1)}dragOver(t){for(const{type:i}of t.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(i)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const i of t.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(i.type)){s.paste(i,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const i=[];for(const s of this.#_){const r=s.serialize(!0);r&&i.push(r)}i.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(i))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:i}=t;for(const o of i.items)for(const c of this.#u)if(c.isHandlingMimeForPasting(o.type)){c.paste(o,this.currentLayer);return}let s=i.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(o){pt(`paste: "${o.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const r=this.currentLayer;try{const o=[];for(const h of s){const f=await r.deserialize(h);if(!f)return;o.push(f)}const c=()=>{for(const h of o)this.#it(h);this.#nt(o)},u=()=>{for(const h of o)h.remove()};this.addCommands({cmd:c,undo:u,mustExec:!0})}catch(o){pt(`paste: "${o.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#T!==yt.NONE&&!this.isEditorHandlingKeyboard&&Sn._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#$("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#O(t){Object.entries(t).some(([s,r])=>this.#K[s]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#K,t)}),this.#T===yt.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#G([[Ct.HIGHLIGHT_FREE,!0]]))}#G(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#lt(),this.#ut(),this.#O({isEditing:this.#T!==yt.NONE,isEmpty:this.#Q(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ot(),this.#ht(),this.#O({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#u){this.#u=t;for(const i of this.#u)this.#G(i.defaultPropertiesToUpdate)}}getId(){return this.#R.id}get currentLayer(){return this.#r.get(this.#f)}getLayer(t){return this.#r.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#r.set(t.pageIndex,t),this.#M?t.enable():t.disable()}removeLayer(t){this.#r.delete(t.pageIndex)}async updateMode(t,i=null,s=!1,r=!1,o=!1,c=!1){if(this.#T!==t&&!(this.#I&&(await this.#I.promise,!this.#I))){if(this.#I=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#T===yt.POPUP&&this.#o?.hideSidebar(),this.#o?.destroyPopup(),this.#T=t,t===yt.NONE){this.setEditingState(!1),this.#gt();for(const u of this.#i.values())u.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#I.resolve();return}for(const u of this.#i.values())u.addStandaloneCommentButton();t===yt.SIGNATURE&&await this.#U?.loadSignatures(),s&&Lt.clearPointerType(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const u of this.#r.values())u.updateMode(t);if(t===yt.POPUP){this.#n||=await this.#X.getAnnotationsByType(new Set(this.#u.map(f=>f._editorType)));const u=new Set,h=[];for(const f of this.#i.values()){const{annotationElementId:p,hasComment:y,deleted:b}=f;p&&u.add(p),y&&!b&&h.push(f.getData())}for(const f of this.#n){const{id:p,popupRef:y,contentsObj:b}=f;y&&b?.str&&!u.has(p)&&!this.#m.has(p)&&h.push(f)}this.#o?.showSidebar(h)}if(!i){r&&this.addNewEditorFromKeyboard(),this.#I.resolve();return}for(const u of this.#i.values())u.uid===i?(this.setSelected(u),c?u.editComment():o?u.enterInEditMode():u.focus()):u.unselect();this.#I.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#T&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,i){if(this.#u){switch(t){case Ct.CREATE:this.currentLayer.addNewEditor(i);return;case Ct.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#Y||=new Map).set(t,i),this.showAllEditors("highlight",i);break}if(this.hasSelection)for(const s of this.#_)s.updateParams(t,i);else for(const s of this.#u)s.updateDefaultParams(t,i)}}showAllEditors(t,i,s=!1){for(const o of this.#i.values())o.editorType===t&&o.show(i);(this.#Y?.get(Ct.HIGHLIGHT_SHOW_ALL)??!0)!==i&&this.#G([[Ct.HIGHLIGHT_SHOW_ALL,i]])}enableWaiting(t=!1){if(this.#P!==t){this.#P=t;for(const i of this.#r.values())t?i.disableClick():i.enableClick(),i.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#M){this.#M=!0;const t=[];for(const i of this.#r.values())t.push(i.enable());await Promise.all(t);for(const i of this.#i.values())i.enable()}}#gt(){if(this.unselectAll(),this.#M){this.#M=!1;for(const t of this.#r.values())t.disable();for(const t of this.#i.values())t.disable()}}*getEditors(t){for(const i of this.#i.values())i.pageIndex===t&&(yield i)}getEditor(t){return this.#i.get(t)}addEditor(t){this.#i.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#w&&clearTimeout(this.#w),this.#w=setTimeout(()=>{this.focusMainContainer(),this.#w=null},0)),this.#i.delete(t.id),t.annotationElementId&&this.#B?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#m.has(t.annotationElementId))&&this.#s?.remove(t.id)}addDeletedAnnotationElement(t){this.#m.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#m.has(t)}removeDeletedAnnotationElement(t){this.#m.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#it(t){const i=this.#r.get(t.pageIndex);i?i.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#G(t.propertiesToUpdate))}get#pt(){let t=null;for(t of this.#_);return t}updateUI(t){this.#pt===t&&this.#G(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#G(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#_.has(t)){this.#_.delete(t),t.unselect(),this.#O({hasSelectedEditor:this.hasSelection});return}this.#_.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#O({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.uid}),this.#h?.commitOrRemove();for(const i of this.#_)i!==t&&i.unselect();this.#_.clear(),this.#_.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#O({hasSelectedEditor:!0})}isSelected(t){return this.#_.has(t)}get firstSelectedEditor(){return this.#_.values().next().value}unselect(t){t.unselect(),this.#_.delete(t),this.#O({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#_.size!==0}get isEnterHandled(){return this.#_.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#O({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#Q()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#O({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#Q()})}addCommands(t){this.#c.add(t),this.#O({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#Q()})}cleanUndoStack(t){this.#c.cleanType(t)}#Q(){if(this.#i.size===0)return!0;if(this.#i.size===1)for(const t of this.#i.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const i=t?[t]:[...this.#_],s=()=>{this._editorUndoBar?.show(r,i.length===1?i[0].editorType:i.length);for(const o of i)o.remove()},r=()=>{for(const o of i)this.#it(o)};this.addCommands({cmd:s,undo:r,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#nt(t){for(const i of this.#_)i.unselect();this.#_.clear();for(const i of t)i.isEmpty()||(this.#_.add(i),i.select());this.#O({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#_)t.commit();this.#nt(this.#i.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#T!==yt.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const t of this.#_)t.unselect();this.#_.clear(),this.#O({hasSelectedEditor:!1})}}translateSelectedEditors(t,i,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;this.#j[0]+=t,this.#j[1]+=i;const[r,o]=this.#j,c=[...this.#_],u=1e3;this.#z&&clearTimeout(this.#z),this.#z=setTimeout(()=>{this.#z=null,this.#j[0]=this.#j[1]=0,this.addCommands({cmd:()=>{for(const h of c)this.#i.has(h.id)&&(h.translateInPage(r,o),h.translationDone())},undo:()=>{for(const h of c)this.#i.has(h.id)&&(h.translateInPage(-r,-o),h.translationDone())},mustExec:!1})},u);for(const h of c)h.translateInPage(t,i),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#p=new Map;for(const t of this.#_)this.#p.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#p)return!1;this.disableUserSelect(!1);const t=this.#p;this.#p=null;let i=!1;for(const[{x:r,y:o,pageIndex:c},u]of t)u.newX=r,u.newY=o,u.newPageIndex=c,i||=r!==u.savedX||o!==u.savedY||c!==u.savedPageIndex;if(!i)return!1;const s=(r,o,c,u)=>{if(this.#i.has(r.id)){const h=this.#r.get(u);h?r._setParentAndPosition(h,o,c):(r.pageIndex=u,r.x=o,r.y=c)}};return this.addCommands({cmd:()=>{for(const[r,{newX:o,newY:c,newPageIndex:u}]of t)s(r,o,c,u)},undo:()=>{for(const[r,{savedX:o,savedY:c,savedPageIndex:u}]of t)s(r,o,c,u)},mustExec:!0}),!0}dragSelectedEditors(t,i){if(this.#p)for(const s of this.#p.keys())s.drag(t,i)}rebuild(t){if(t.parent===null){const i=this.getLayer(t.pageIndex);i?(i.changeParent(t),i.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#_.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#T}isEditingMode(){return this.#T!==yt.NONE}get imageManager(){return mt(this,"imageManager",new zu)}getSelectionBoxes(t){if(!t)return null;const i=document.getSelection();for(let f=0,p=i.rangeCount;f<p;f++)if(!t.contains(i.getRangeAt(f).commonAncestorContainer))return null;const{x:s,y:r,width:o,height:c}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(f,p,y,b)=>({x:(p-r)/c,y:1-(f+y-s)/o,width:b/c,height:y/o});break;case"180":u=(f,p,y,b)=>({x:1-(f+y-s)/o,y:1-(p+b-r)/c,width:y/o,height:b/c});break;case"270":u=(f,p,y,b)=>({x:1-(p+b-r)/c,y:(f-s)/o,width:b/c,height:y/o});break;default:u=(f,p,y,b)=>({x:(f-s)/o,y:(p-r)/c,width:y/o,height:b/c});break}const h=[];for(let f=0,p=i.rangeCount;f<p;f++){const y=i.getRangeAt(f);if(!y.collapsed)for(const{x:b,y:A,width:_,height:S}of y.getClientRects())_===0||S===0||h.push(u(b,A,_,S))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:i}){(this.#l||=new Map).set(t,i)}removeChangedExistingAnnotation({annotationElementId:t}){this.#l?.delete(t)}renderAnnotationElement(t){const i=this.#l?.get(t.data.id);if(!i)return;const s=this.#s.getRawValue(i);s&&(this.#T===yt.NONE&&!s.hasBeenModified||s.renderAnnotationElement(t))}setMissingCanvas(t,i,s){const r=this.#B?.get(t);r&&(r.setCanvas(i,s),this.#B.delete(t))}addMissingCanvas(t,i){(this.#B||=new Map).set(t,i)}}class Ei{#t=null;#e=!1;#n=null;#i=null;#r=null;#a=null;#s=!1;#l=null;#c=null;#o=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#h=t._uiManager.useNewAltTextFlow,Ei.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){Ei._l10n??=t}async render(){const t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";const i=this.#i=document.createElement("span");t.append(i),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",Ei.#f.missing),i.setAttribute("data-l10n-id",Ei.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=this.#c._uiManager._signal;t.addEventListener("contextmenu",fi,{signal:s}),t.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:s});const r=o=>{o.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return t.addEventListener("click",r,{capture:!0,signal:s}),t.addEventListener("keydown",o=>{o.target===t&&o.key==="Enter"&&(this.#s=!0,r(o))},{signal:s}),await this.#p(),t}get#m(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#s}),this.#s=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#o:this.isEmpty()}get guessedText(){return this.#o}async setGuessedText(t){this.#t===null&&(this.#o=t,this.#d=await Ei._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#p())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#l?.remove(),this.#l=null;return}if(!this.#l){const i=this.#l=document.createElement("div");i.className="noAltTextBadge",this.#c.div.append(i)}this.#l.classList.toggle("hidden",!t)}serialize(t){let i=this.#t;return!t&&this.#o===i&&(i=this.#d),{altText:i,decorative:this.#e,guessedText:this.#o,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:i,guessedText:s,textWithDisclaimer:r,cancel:o=!1}){s&&(this.#o=s,this.#d=r),!(this.#t===t&&this.#e===i)&&(o||(this.#t=t,this.#e=i),this.#p())}toggle(t=!1){this.#n&&(!t&&this.#a&&(clearTimeout(this.#a),this.#a=null),this.#n.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#r=null,this.#l?.remove(),this.#l=null}async#p(){const t=this.#n;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",Ei.#f[this.#m]),this.#i?.setAttribute("data-l10n-id",Ei.#f[`${this.#m}-label`]),!this.#t){this.#r?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#r?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let i=this.#r;if(!i){this.#r=i=document.createElement("span"),i.className="tooltip",i.setAttribute("role","tooltip"),i.id=`alt-text-tooltip-${this.#c.id}`;const r=100,o=this.#c._uiManager._signal;o.addEventListener("abort",()=>{clearTimeout(this.#a),this.#a=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#a=setTimeout(()=>{this.#a=null,this.#r.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},r)},{signal:o}),t.addEventListener("mouseleave",()=>{this.#a&&(clearTimeout(this.#a),this.#a=null),this.#r?.classList.remove("show")},{signal:o})}this.#e?i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(i.removeAttribute("data-l10n-id"),i.textContent=this.#t),i.parentNode||t.append(i),this.#c.getElementForAltText()?.setAttribute("aria-describedby",i.id)}}class vl{#t=null;#e=null;#n=!1;#i=null;#r=null;#a=null;#s=null;#l=null;#c=!1;#o=null;constructor(t){this.#i=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const i=this.#i.commentButtonPosition;if(i){const{style:s}=t;s.insetInlineEnd=`calc(${100*(this.#i._uiManager.direction==="ltr"?1-i[0]:i[0])}% - var(--comment-button-dim))`,s.top=`calc(${100*i[1]}% - var(--comment-button-dim))`;const r=this.#i.commentButtonColor;r&&(s.backgroundColor=r)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#i.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#i._uiManager.updatePopupColor(this.#i)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#i.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#o)return this.#o;if(!this.#t)return null;const{x:t,y:i,height:s}=this.#t.getBoundingClientRect(),{x:r,y:o,width:c,height:u}=this.#i.parent.boundingClientRect;return[(t-r)/c,(i+s-o)/u]}set commentPopupPositionInLayer(t){this.#o=t}hasDefaultPopupPosition(){return this.#o===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:i}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=i)}#d(t,i){if(!this.#i._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",i?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#i._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const s=this.#i._uiManager._signal;if(!(s instanceof AbortSignal)||s.aborted)return t;t.addEventListener("contextmenu",fi,{signal:s}),i&&(t.addEventListener("focusin",o=>{this.#i._focusEventsAllowed=!1,Jt(o)},{capture:!0,signal:s}),t.addEventListener("focusout",o=>{this.#i._focusEventsAllowed=!0,Jt(o)},{capture:!0,signal:s})),t.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:s});const r=o=>{o.preventDefault(),t===this.#e?this.edit():this.#i.toggleComment(!0)};return t.addEventListener("click",r,{capture:!0,signal:s}),t.addEventListener("keydown",o=>{o.target===t&&o.key==="Enter"&&(this.#n=!0,r(o))},{signal:s}),t.addEventListener("pointerenter",()=>{this.#i.toggleComment(!1,!0)},{signal:s}),t.addEventListener("pointerleave",()=>{this.#i.toggleComment(!1,!1)},{signal:s}),t}edit(t){const i=this.commentPopupPositionInLayer;let s,r;if(i)[s,r]=i;else{[s,r]=this.#i.commentButtonPosition;const{width:p,height:y,x:b,y:A}=this.#i;s=b+s*p,r=A+r*y}const o=this.#i.parent.boundingClientRect,{x:c,y:u,width:h,height:f}=o;this.#i._uiManager.editComment(this.#i,c+s*h,u+r*f,{...t,parentDimensions:o})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#n}),this.#n=!1)}isDeleted(){return this.#c||this.#s===""}isEmpty(){return this.#s===null}hasBeenEdited(){return this.isDeleted()||this.#s!==this.#r}serialize(){return this.data}get data(){return{text:this.#s,richText:this.#a,date:this.#l,deleted:this.isDeleted()}}set data(t){if(t!==this.#s&&(this.#a=null),t===null){this.#s="",this.#c=!0;return}this.#s=t,this.#l=new Date,this.#c=!1}setInitialText(t,i=null){this.#r=t,this.data=t,this.#l=null,this.#a=i}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#s="",this.#a=null,this.#l=null,this.#i=null,this.#n=!1,this.#c=!1}}class zl{#t;#e=!1;#n=null;#i;#r;#a;#s;#l=null;#c;#o=null;#d;#h=null;constructor({container:t,isPinchingDisabled:i=null,isPinchingStopped:s=null,onPinchStart:r=null,onPinching:o=null,onPinchEnd:c=null,signal:u}){this.#t=t,this.#n=s,this.#i=i,this.#r=r,this.#a=o,this.#s=c,this.#d=new AbortController,this.#c=AbortSignal.any([u,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/xi.pixelRatio}#f(t){if(this.#i?.())return;if(t.touches.length===1){if(this.#l)return;const r=this.#l=new AbortController,o=AbortSignal.any([this.#c,r.signal]),c=this.#t,u={capture:!0,signal:o,passive:!1},h=f=>{f.pointerType==="touch"&&(this.#l?.abort(),this.#l=null)};c.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(Jt(f),h(f))},u),c.addEventListener("pointerup",h,u),c.addEventListener("pointercancel",h,u);return}if(!this.#h){this.#h=new AbortController;const r=AbortSignal.any([this.#c,this.#h.signal]),o=this.#t,c={signal:r,capture:!1,passive:!1};o.addEventListener("touchmove",this.#m.bind(this),c);const u=this.#p.bind(this);o.addEventListener("touchend",u,c),o.addEventListener("touchcancel",u,c),c.capture=!0,o.addEventListener("pointerdown",Jt,c),o.addEventListener("pointermove",Jt,c),o.addEventListener("pointercancel",Jt,c),o.addEventListener("pointerup",Jt,c),this.#r?.()}if(Jt(t),t.touches.length!==2||this.#n?.()){this.#o=null;return}let[i,s]=t.touches;i.identifier>s.identifier&&([i,s]=[s,i]),this.#o={touch0X:i.screenX,touch0Y:i.screenY,touch1X:s.screenX,touch1Y:s.screenY}}#m(t){if(!this.#o||t.touches.length!==2)return;Jt(t);let[i,s]=t.touches;i.identifier>s.identifier&&([i,s]=[s,i]);const{screenX:r,screenY:o}=i,{screenX:c,screenY:u}=s,h=this.#o,{touch0X:f,touch0Y:p,touch1X:y,touch1Y:b}=h,A=y-f,_=b-p,S=c-r,x=u-o,E=Math.hypot(S,x)||1,D=Math.hypot(A,_)||1;if(!this.#e&&Math.abs(D-E)<=zl.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=r,h.touch0Y=o,h.touch1X=c,h.touch1Y=u,!this.#e){this.#e=!0;return}const T=[(r+c)/2,(o+u)/2];this.#a?.(T,D,E)}#p(t){t.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#s?.()),this.#o&&(Jt(t),this.#o=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#l?.abort(),this.#l=null}}class ct{#t=null;#e=null;#n=null;#i=null;#r=null;#a=!1;#s=null;#l="";#c=null;#o=null;#d=null;#h=null;#f=null;#m="";#p=!1;#u=null;#g=!1;#y=!1;#v=!1;#b=null;#x=0;#w=0;#S=null;#C=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#A=!1;#E=ct._zIndex++;static _borderLineWidth=-1;static _colorManager=new Pu;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=ct.prototype._resizeWithKeyboard,i=Sn.TRANSLATE_SMALL,s=Sn.TRANSLATE_BIG;return mt(this,"_resizerKeyboardManager",new Ja([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-i,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[i,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-i]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,i]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,s]}],[["Escape","mac+Escape"],ct.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null,this.canAddComment=!0;const{rotation:i,rawDims:{pageWidth:s,pageHeight:r,pageX:o,pageY:c}}=this.parent.viewport;this.rotation=i,this.pageRotation=(360+i-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,r],this.pageTranslation=[o,c];const[u,h]=this.parentDimensions;this.x=t.x/u,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return mt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const i=new rv({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});i.annotationElementId=t.annotationElementId,i.deleted=!0,i._uiManager.addToAnnotationStorage(i)}static initialize(t,i){if(ct._l10n??=t,ct._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),ct._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);ct._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,i){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,i){Gt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#A}set _isDraggable(t){this.#A=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,i]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*i/(t*2),this.y+=this.width*t/(i*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*i/(t*2),this.y-=this.width*t/(i*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#E}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#z(),this.#h?.remove(),this.#h=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#p?this.#p=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,i,s,r){const[o,c]=this.parentDimensions;[s,r]=this.screenToPageTranslation(s,r),this.x=(t+s)/o,this.y=(i+r)/c,this.fixAndSetPosition()}_moveAfterPaste(t,i){const[s,r]=this.parentDimensions;this.setAt(t*s,i*r,this.width*s,this.height*r),this._onTranslated()}#R([t,i],s,r){[s,r]=this.screenToPageTranslation(s,r),this.x+=s/t,this.y+=r/i,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,i){this.#R(this.parentDimensions,t,i)}translateInPage(t,i){this.#u||=[this.x,this.y,this.width,this.height],this.#R(this.pageDimensions,t,i),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,i){this.#u||=[this.x,this.y,this.width,this.height];const{div:s,parentDimensions:[r,o]}=this;if(this.x+=t/r,this.y+=i/o,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:y,y:b}=this.div.getBoundingClientRect();this.parent.findNewParent(this,y,b)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:c,y:u}=this;const[h,f]=this.getBaseTranslation();c+=h,u+=f;const{style:p}=s;p.left=`${(100*c).toFixed(2)}%`,p.top=`${(100*u).toFixed(2)}%`,this._onTranslating(c,u),s.scrollIntoView({block:"nearest"})}_onTranslating(t,i){}_onTranslated(t,i){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[t,i]=this.parentDimensions,{_borderLineWidth:s}=ct,r=s/t,o=s/i;switch(this.rotation){case 90:return[-r,o];case 180:return[r,o];case 270:return[r,-o];default:return[-r,-o]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:i},pageDimensions:[s,r]}=this;let{x:o,y:c,width:u,height:h}=this;if(u*=s,h*=r,o*=s,c*=r,this._mustFixPosition)switch(t){case 0:o=Oe(o,0,s-u),c=Oe(c,0,r-h);break;case 90:o=Oe(o,0,s-h),c=Oe(c,u,r);break;case 180:o=Oe(o,u,s),c=Oe(c,h,r);break;case 270:o=Oe(o,h,s),c=Oe(c,0,r-u);break}this.x=o/=s,this.y=c/=r;const[f,p]=this.getBaseTranslation();o+=f,c+=p,i.left=`${(100*o).toFixed(2)}%`,i.top=`${(100*c).toFixed(2)}%`,this.moveInDOM()}static#M(t,i,s){switch(s){case 90:return[i,-t];case 180:return[-t,-i];case 270:return[-i,t];default:return[t,i]}}screenToPageTranslation(t,i){return ct.#M(t,i,this.parentRotation)}pageTranslationToScreen(t,i){return ct.#M(t,i,360-this.parentRotation)}#D(t){switch(t){case 90:{const[i,s]=this.pageDimensions;return[0,-i/s,s/i,0]}case 180:return[-1,0,0,-1];case 270:{const[i,s]=this.pageDimensions;return[0,i/s,-s/i,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[i,s]}=this;return[i*t,s*t]}setDims(){const{div:{style:t},width:i,height:s}=this;t.width=`${(100*i).toFixed(2)}%`,t.height=`${(100*s).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#P(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],i=this._uiManager._signal;for(const s of t){const r=document.createElement("div");this.#c.append(r),r.classList.add("resizer",s),r.setAttribute("data-resizer-name",s),r.addEventListener("pointerdown",this.#N.bind(this,s),{signal:i}),r.addEventListener("contextmenu",fi,{signal:i}),r.tabIndex=-1}this.div.prepend(this.#c)}#N(t,i){i.preventDefault();const{isMac:s}=de.platform;if(i.button!==0||i.ctrlKey&&s)return;this.#n?.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,this.#o=[i.screenX,i.screenY];const o=new AbortController,c=this._uiManager.combinedSignal(o);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#B.bind(this,t),{passive:!0,capture:!0,signal:c}),window.addEventListener("touchmove",Jt,{passive:!1,signal:c}),window.addEventListener("contextmenu",fi,{signal:c}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(i.target).cursor;const f=()=>{o.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=u,this.div.style.cursor=h,this.#F()};window.addEventListener("pointerup",f,{signal:c}),window.addEventListener("blur",f,{signal:c})}#k(t,i,s,r){this.width=s,this.height=r,this.x=t,this.y=i,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#F(){if(!this.#d)return;const{savedX:t,savedY:i,savedWidth:s,savedHeight:r}=this.#d;this.#d=null;const o=this.x,c=this.y,u=this.width,h=this.height;o===t&&c===i&&u===s&&h===r||this.addCommands({cmd:this.#k.bind(this,o,c,u,h),undo:this.#k.bind(this,t,i,s,r),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#B(t,i){const[s,r]=this.parentDimensions,o=this.x,c=this.y,u=this.width,h=this.height,f=ct.MIN_SIZE/s,p=ct.MIN_SIZE/r,y=this.#D(this.rotation),b=(O,G)=>[y[0]*O+y[2]*G,y[1]*O+y[3]*G],A=this.#D(360-this.rotation),_=(O,G)=>[A[0]*O+A[2]*G,A[1]*O+A[3]*G];let S,x,E=!1,D=!1;switch(t){case"topLeft":E=!0,S=(O,G)=>[0,0],x=(O,G)=>[O,G];break;case"topMiddle":S=(O,G)=>[O/2,0],x=(O,G)=>[O/2,G];break;case"topRight":E=!0,S=(O,G)=>[O,0],x=(O,G)=>[0,G];break;case"middleRight":D=!0,S=(O,G)=>[O,G/2],x=(O,G)=>[0,G/2];break;case"bottomRight":E=!0,S=(O,G)=>[O,G],x=(O,G)=>[0,0];break;case"bottomMiddle":S=(O,G)=>[O/2,G],x=(O,G)=>[O/2,0];break;case"bottomLeft":E=!0,S=(O,G)=>[0,G],x=(O,G)=>[O,0];break;case"middleLeft":D=!0,S=(O,G)=>[0,G/2],x=(O,G)=>[O,G/2];break}const T=S(u,h),B=x(u,h);let N=b(...B);const k=ct._round(o+N[0]),z=ct._round(c+N[1]);let K=1,Q=1,et,W;if(i.fromKeyboard)({deltaX:et,deltaY:W}=i);else{const{screenX:O,screenY:G}=i,[J,$]=this.#o;[et,W]=this.screenToPageTranslation(O-J,G-$),this.#o[0]=O,this.#o[1]=G}if([et,W]=_(et/s,W/r),E){const O=Math.hypot(u,h);K=Q=Math.max(Math.min(Math.hypot(B[0]-T[0]-et,B[1]-T[1]-W)/O,1/u,1/h),f/u,p/h)}else D?K=Oe(Math.abs(B[0]-T[0]-et),f,1)/u:Q=Oe(Math.abs(B[1]-T[1]-W),p,1)/h;const dt=ct._round(u*K),_t=ct._round(h*Q);N=b(...x(dt,_t));const ft=k-N[0],xt=z-N[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=dt,this.height=_t,this.x=ft,this.y=xt,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new qa(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[i,s]of t)await this._editToolbar.addButton(i,s);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#n?.destroy()}addContainer(t){const i=this._editToolbar?.div;i?i.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#n||(Ei.initialize(ct._l10n),this.#n=new Ei(this),this.#t&&(this.#n.data=this.#t,this.#t=null)),this.#n}get altTextData(){return this.#n?.data}set altTextData(t){this.#n&&(this.#n.data=t)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(t){await this.#n?.setGuessedText(t)}serializeAltText(t){return this.#n?.serialize(t)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}focusCommentButton(){this.#i?.focusButton()}addCommentButton(){return this.canAddComment?this.#i||=new vl(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#r){this._uiManager.isEditingMode()&&this.#r.classList.remove("hidden");return}this.hasComment&&(this.#r=this.#i.renderForStandalone(),this.div.append(this.#r))}}removeStandaloneCommentButton(){this.#i.removeStandaloneCommentButton(),this.#r=null}hideStandaloneCommentButton(){this.#r?.classList.add("hidden")}get comment(){const{data:{richText:t,text:i,date:s,deleted:r}}=this.#i;return{text:i,richText:t,date:s,deleted:r,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#i||=new vl(this),this.#i.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:i,richText:s}){if(!i||(this.#i||=new vl(this),this.#i.setInitialText(t,s),!this.annotationElementId))return;const r=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);r&&this.updateFromAnnotationLayer(r)}get hasEditedComment(){return this.#i?.hasBeenEdited()}get hasDeletedComment(){return this.#i?.isDeleted()}get hasComment(){return!!this.#i&&!this.#i.isEmpty()&&!this.#i.isDeleted()}async editComment(t){this.#i||=new vl(this),this.#i.edit(t)}toggleComment(t,i=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,i)}setSelectedCommentButton(t){this.#i.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,r]=t.rect,[o]=this.pageDimensions,[c]=this.pageTranslation,u=c+o+1,h=r-100,f=u+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,h,f,r]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:i}}){this.#i.data=i?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#a?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#H();const[i,s]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*s/i).toFixed(2)}%`,t.style.maxHeight=`${(100*i/s).toFixed(2)}%`);const[r,o]=this.getInitialTranslation();return this.translate(r,o),Zp(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#C||=new zl({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#q.bind(this),onPinching:this.#T.bind(this),onPinchEnd:this.#_.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#q(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#T(t,i,s){let o=.7*(s/i)+1-.7;if(o===1)return;const c=this.#D(this.rotation),u=(k,z)=>[c[0]*k+c[2]*z,c[1]*k+c[3]*z],[h,f]=this.parentDimensions,p=this.x,y=this.y,b=this.width,A=this.height,_=ct.MIN_SIZE/h,S=ct.MIN_SIZE/f;o=Math.max(Math.min(o,1/b,1/A),_/b,S/A);const x=ct._round(b*o),E=ct._round(A*o);if(x===b&&E===A)return;this.#u||=[p,y,b,A];const D=u(b/2,A/2),T=ct._round(p+D[0]),B=ct._round(y+D[1]),N=u(x/2,E/2);this.x=T-N[0],this.y=B-N[1],this.width=x,this.height=E,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#_(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#F()}pointerdown(t){const{isMac:i}=de.platform;if(t.button!==0||t.ctrlKey&&i){t.preventDefault();return}if(this.#p=!0,this._isDraggable){this.#U(t);return}this.#L(t)}#L(t){const{isMac:i}=de.platform;t.ctrlKey&&!i||t.shiftKey||t.metaKey&&i?this.parent.toggleSelected(this):this.parent.setSelected(this)}#U(t){const{isSelected:i}=this;this._uiManager.setUpDragSession();let s=!1;const r=new AbortController,o=this._uiManager.combinedSignal(r),c={capture:!0,passive:!1,signal:o},u=f=>{r.abort(),this.#s=null,this.#p=!1,this._uiManager.endDragSession()||this.#L(f),s&&this._onStopDragging()};i&&(this.#x=t.clientX,this.#w=t.clientY,this.#s=t.pointerId,this.#l=t.pointerType,window.addEventListener("pointermove",f=>{s||(s=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:p,clientY:y,pointerId:b}=f;if(b!==this.#s){Jt(f);return}const[A,_]=this.screenToPageTranslation(p-this.#x,y-this.#w);this.#x=p,this.#w=y,this._uiManager.dragSelectedEditors(A,_)},c),window.addEventListener("touchmove",Jt,c),window.addEventListener("pointerdown",f=>{f.pointerType===this.#l&&(this.#C||f.isPrimary)&&u(f),Jt(f)},c));const h=f=>{if(!this.#s||this.#s===f.pointerId){u(f);return}Jt(f)};window.addEventListener("pointerup",h,{signal:o}),window.addEventListener("blur",h,{signal:o})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#b&&clearTimeout(this.#b),this.#b=setTimeout(()=>{this.#b=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,i,s){t.changeParent(this),this.x=i,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(t,i,s=this.rotation){const r=this.parentScale,[o,c]=this.pageDimensions,[u,h]=this.pageTranslation,f=t/r,p=i/r,y=this.x*o,b=this.y*c,A=this.width*o,_=this.height*c;switch(s){case 0:return[y+f+u,c-b-p-_+h,y+f+A+u,c-b-p+h];case 90:return[y+p+u,c-b+f+h,y+p+_+u,c-b+f+A+h];case 180:return[y-f-A+u,c-b+p+h,y-f+u,c-b+p+_+h];case 270:return[y-p-_+u,c-b-f-A+h,y-p+u,c-b-f+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,i){const[s,r,o,c]=t,u=o-s,h=c-r;switch(this.rotation){case 0:return[s,i-c,u,h];case 90:return[s,i-r,h,u];case 180:return[o,i-r,u,h];case 270:return[o,i-c,h,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&ct._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#i?.onUpdatedColor()}getData(){const{comment:{text:t,color:i,date:s,opacity:r,deleted:o,richText:c},uid:u,pageIndex:h,creationDate:f,modificationDate:p}=this;return{id:u,pageIndex:h,rect:this.getPDFRect(),richText:c,contentsObj:{str:t},creationDate:f,modificationDate:s||p,popupRef:!o,color:i,opacity:r}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#v}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:i,bottom:s,right:r}=this.getClientDimensions(),{innerHeight:o,innerWidth:c}=window;return i<c&&r>0&&t<o&&s>0}#H(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#H()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,i=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,i,s){const r=new this.prototype.constructor({parent:i,id:i.getNextId(),uiManager:s,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});r.rotation=t.rotation,r.#t=t.accessibilityData,r._isCopy=t.isCopy||!1;const[o,c]=r.pageDimensions,[u,h,f,p]=r.getRectInCurrentCoords(t.rect,c);return r.x=u/o,r.y=h/c,r.width=f/o,r.height=p/c,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#b&&(clearTimeout(this.#b),this.#b=null),this.#z(),this.removeEditToolbar(),this.#S){for(const t of this.#S.values())clearTimeout(t);this.#S=null}this.parent=null,this.#C?.destroy(),this.#C=null,this.#h?.remove(),this.#h=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#P(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,i]}=this,[s,r,o,c]=this.getPDFRect();return[ct._round(s+(o-s)*t),ct._round(r+(c-r)*(1-i))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#i.commentPopupPositionInLayer}set commentPopupPosition(t){this.#i.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#i.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#i.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#i?.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const i=this.#c.children;if(!this.#e){this.#e=Array.from(i);const c=this.#Y.bind(this),u=this.#X.bind(this),h=this._uiManager._signal;for(const f of this.#e){const p=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",c,{signal:h}),f.addEventListener("blur",u,{signal:h}),f.addEventListener("focus",this.#K.bind(this,p),{signal:h}),f.setAttribute("data-l10n-id",ct._l10nResizer[p])}}const s=this.#e[0];let r=0;for(const c of i){if(c===s)break;r++}const o=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(o!==r){if(o<r)for(let u=0;u<r-o;u++)this.#c.append(this.#c.firstElementChild);else if(o>r)for(let u=0;u<o-r;u++)this.#c.firstElementChild.before(this.#c.lastElementChild);let c=0;for(const u of i){const f=this.#e[c++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",ct._l10nResizer[f])}}this.#j(0),this.#v=!0,this.#c.firstElementChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#Y(t){ct._resizerKeyboardManager.exec(this,t)}#X(t){this.#v&&t.relatedTarget?.parentNode!==this.#c&&this.#z()}#K(t){this.#m=this.#v?t:""}#j(t){if(this.#e)for(const i of this.#e)i.tabIndex=t}_resizeWithKeyboard(t,i){this.#v&&this.#B(this.#m,{deltaX:t,deltaY:i,fromKeyboard:!0})}#z(){this.#v=!1,this.#j(-1),this.#F()}_stopResizingWithKeyboard(){this.#z(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(t,i){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#g}set isEditing(t){this.#g=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,i=!1){if(i){this.#S||=new Map;const{action:s}=t;let r=this.#S.get(s);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(t),this.#S.delete(s),this.#S.size===0&&(this.#S=null)},ct._telemetryTimeout),this.#S.set(s,r);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#a=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#a=!0}updateFakeAnnotationElement(t){if(!this.#h&&!this.deleted){this.#h=t.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let i=t.container.querySelector(".annotationContent");if(!i)i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),t.container.prepend(i);else if(i.nodeName==="CANVAS"){const s=i;i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),s.before(i)}return i}resetAnnotationElement(t){const{firstElementChild:i}=t.container;i?.nodeName==="DIV"&&i.classList.contains("annotationContent")&&i.remove()}}class rv extends ct{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Ap=3285377520,ui=4294901760,_i=65535;class Wp{constructor(t){this.h1=t?t&4294967295:Ap,this.h2=t?t&4294967295:Ap}update(t){let i,s;if(typeof t=="string"){i=new Uint8Array(t.length*2),s=0;for(let S=0,x=t.length;S<x;S++){const E=t.charCodeAt(S);E<=255?i[s++]=E:(i[s++]=E>>>8,i[s++]=E&255)}}else if(ArrayBuffer.isView(t))i=t.slice(),s=i.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=s>>2,o=s-r*4,c=new Uint32Array(i.buffer,0,r);let u=0,h=0,f=this.h1,p=this.h2;const y=3432918353,b=461845907,A=y&_i,_=b&_i;for(let S=0;S<r;S++)S&1?(u=c[S],u=u*y&ui|u*A&_i,u=u<<15|u>>>17,u=u*b&ui|u*_&_i,f^=u,f=f<<13|f>>>19,f=f*5+3864292196):(h=c[S],h=h*y&ui|h*A&_i,h=h<<15|h>>>17,h=h*b&ui|h*_&_i,p^=h,p=p<<13|p>>>19,p=p*5+3864292196);switch(u=0,o){case 3:u^=i[r*4+2]<<16;case 2:u^=i[r*4+1]<<8;case 1:u^=i[r*4],u=u*y&ui|u*A&_i,u=u<<15|u>>>17,u=u*b&ui|u*_&_i,r&1?f^=u:p^=u}this.h1=f,this.h2=p}hexdigest(){let t=this.h1,i=this.h2;return t^=i>>>1,t=t*3981806797&ui|t*36045&_i,i=i*4283543511&ui|((i<<16|t>>>16)*2950163797&ui)>>>16,t^=i>>>1,t=t*444984403&ui|t*60499&_i,i=i*3301882366&ui|((i<<16|t>>>16)*3120437893&ui)>>>16,t^=i>>>1,(t>>>0).toString(16).padStart(8,"0")+(i>>>0).toString(16).padStart(8,"0")}}const xu=Object.freeze({map:null,hash:"",transfer:void 0});class Fu{#t=!1;#e=null;#n=null;#i=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,i){const s=this.#i.get(t);return s===void 0?i:Object.assign(i,s)}getRawValue(t){return this.#i.get(t)}remove(t){const i=this.#i.get(t);if(i!==void 0&&(i instanceof ct&&this.#n.delete(i.annotationElementId),this.#i.delete(t),this.#i.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const s of this.#i.values())if(s instanceof ct)return;this.onAnnotationEditor(null)}}setValue(t,i){const s=this.#i.get(t);let r=!1;if(s!==void 0)for(const[o,c]of Object.entries(i))s[o]!==c&&(r=!0,s[o]=c);else r=!0,this.#i.set(t,i);r&&this.#r(),i instanceof ct&&((this.#n||=new Map).set(i.annotationElementId,i),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(i.constructor._type))}has(t){return this.#i.has(t)}get size(){return this.#i.size}#r(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Jp(this)}get serializable(){if(this.#i.size===0)return xu;const t=new Map,i=new Wp,s=[],r=Object.create(null);let o=!1;for(const[c,u]of this.#i){const h=u instanceof ct?u.serialize(!1,r):u;h&&(t.set(c,h),i.update(`${c}:${JSON.stringify(h)}`),o||=!!h.bitmap)}if(o)for(const c of t.values())c.bitmap&&s.push(c.bitmap);return t.size>0?{map:t,hash:i.hexdigest(),transfer:s}:xu}get editorStats(){let t=null;const i=new Map;let s=0,r=0;for(const o of this.#i.values()){if(!(o instanceof ct)){o.popup&&(o.popup.deleted?r+=1:s+=1);continue}o.isCommentDeleted?r+=1:o.hasEditedComment&&(s+=1);const c=o.telemetryFinalData;if(!c)continue;const{type:u}=c;i.has(u)||i.set(u,Object.getPrototypeOf(o).constructor),t||=Object.create(null);const h=t[u]||=new Map;for(const[f,p]of Object.entries(c)){if(f==="type")continue;let y=h.get(f);y||(y=new Map,h.set(f,y));const b=y.get(p)??0;y.set(p,b+1)}}if((r>0||s>0)&&(t||=Object.create(null),t.comments={deleted:r,edited:s}),!t)return null;for(const[o,c]of i)t[o]=c.computeTelemetryFinalData(t[o]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,i){const s=this.#n?.get(t);return s?(s.updateFromAnnotationLayer(i),!0):!1}getEditor(t){return this.#n?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#n)for(const i of this.#n.values())i.serialize()&&t.push(i.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#i.entries()}}class Jp extends Fu{#t;constructor(t){super();const{map:i,hash:s,transfer:r}=t.serializable,o=structuredClone(i,r?{transfer:r}:null);this.#t={map:o,hash:s,transfer:r}}get print(){Gt("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return mt(this,"modifiedIds",{ids:new Set,hash:""})}}class lv{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:i=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const i=this.styleElement.sheet;i.insertRule(t,i.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:i,_inspectFont:s}){if(!(!t||this.#t.has(t.loadedName))){if(Mt(!i,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:o,style:c}=t,u=new FontFace(r,o,c);this.addNativeFontFace(u);try{await u.load(),this.#t.add(r),s?.(t)}catch{pt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}Gt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const s=t.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(r){throw pt(`Failed to load font '${s.family}': '${r}'.`),t.disableFontFace=!0,r}}return}const i=t.createFontFaceRule();if(i){if(this.insertRule(i),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const r=this._queueLoadingCallback(s);this._prepareFontLoadEvent(t,r)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return mt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return mt(this,"isSyncFontLoadingSupported",Re||de.platform.isFirefox)}_queueLoadingCallback(t){function i(){for(Mt(!r.done,"completeRequest() cannot be called twice."),r.done=!0;s.length>0&&s[0].done;){const o=s.shift();setTimeout(o.callback,0)}}const{loadingRequests:s}=this,r={done:!1,complete:i,callback:t};return s.push(r),r}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return mt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,i){function s(B,N){return B.charCodeAt(N)<<24|B.charCodeAt(N+1)<<16|B.charCodeAt(N+2)<<8|B.charCodeAt(N+3)&255}function r(B,N,k,z){const K=B.substring(0,N),Q=B.substring(N+k);return K+z+Q}let o,c;const u=this._document.createElement("canvas");u.width=1,u.height=1;const h=u.getContext("2d");let f=0;function p(B,N){if(++f>30){pt("Load test font never loaded."),N();return}if(h.font="30px "+B,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){N();return}setTimeout(p.bind(null,B,N))}const y=`lt${Date.now()}${this.loadTestFontId++}`;let b=this._loadTestFont;b=r(b,976,y.length,y);const _=16,S=1482184792;let x=s(b,_);for(o=0,c=y.length-3;o<c;o+=4)x=x-S+s(y,o)|0;o<y.length&&(x=x-S+s(y+"XXX",o)|0),b=r(b,_,4,Hb(x));const E=`url(data:font/opentype;base64,${btoa(b)});`,D=`@font-face {font-family:"${y}";src:${E}}`;this.insertRule(D);const T=this._document.createElement("div");T.style.visibility="hidden",T.style.width=T.style.height="10px",T.style.position="absolute",T.style.top=T.style.left="0px";for(const B of[t.loadedName,y]){const N=this._document.createElement("span");N.textContent="Hi",N.style.fontFamily=B,T.append(N)}this._document.body.append(T),p(y,()=>{T.remove(),i.complete()})}}class ov{#t;constructor(t,i=null,s,r){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=i,s&&Object.assign(this,s),r&&(this.charProcOperatorList=r)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${Yp(this.data)});`;let i;if(!this.cssFontInfo)i=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),i=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${t}}`}return this._inspectFont?.(this,t),i}getPathGenerator(t,i){if(this.compiledGlyphs[i]!==void 0)return this.compiledGlyphs[i];const s=this.loadedName+"_path_"+i;let r;try{r=t.get(s)}catch(c){pt(`getPathGenerator - ignoring character: "${c}".`)}const o=Qp(r?.path);return this.fontExtraProperties||t.delete(s),this.compiledGlyphs[i]=o}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}set disableFontFace(t){mt(this,"disableFontFace",!!t)}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}set bbox(t){mt(this,"bbox",t)}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}class Ps{#t;#e;#n;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const i=new TextEncoder,s={};let r=0;for(const f of Ps.strings){const p=i.encode(t[f]);s[f]=p,r+=4+p.length}const o=new ArrayBuffer(r),c=new Uint8Array(o),u=new DataView(o);let h=0;for(const f of Ps.strings){const p=s[f],y=p.length;u.setUint32(h,y),c.set(p,h+4),h+=4+y}return Mt(h===o.byteLength,"CssFontInfo.write: Buffer overflow"),o}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#n=new TextDecoder}#i(t){Mt(t<Ps.strings.length,"Invalid string index");let i=0;for(let r=0;r<t;r++)i+=this.#e.getUint32(i)+4;const s=this.#e.getUint32(i);return this.#n.decode(new Uint8Array(this.#t,i+4,s))}get fontFamily(){return this.#i(0)}get fontWeight(){return this.#i(1)}get italicAngle(){return this.#i(2)}}class Fs{#t;#e;#n;static strings=["css","loadedName","baseFontName","src"];static write(t){const i=new TextEncoder,s={};let r=0;for(const b of Fs.strings){const A=i.encode(t[b]);s[b]=A,r+=4+A.length}r+=4;let o,c,u=1+r;t.style&&(o=i.encode(t.style.style),c=i.encode(t.style.weight),u+=4+o.length+4+c.length);const h=new ArrayBuffer(u),f=new Uint8Array(h),p=new DataView(h);let y=0;p.setUint8(y++,t.guessFallback?1:0),p.setUint32(y,0),y+=4,r=0;for(const b of Fs.strings){const A=s[b],_=A.length;r+=4+_,p.setUint32(y,_),f.set(A,y+4),y+=4+_}return p.setUint32(y-r-4,r),t.style&&(p.setUint32(y,o.length),f.set(o,y+4),y+=4+o.length,p.setUint32(y,c.length),f.set(c,y+4),y+=4+c.length),Mt(y<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(y)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#n=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#i(t){Mt(t<Fs.strings.length,"Invalid string index");let i=5;for(let r=0;r<t;r++)i+=this.#e.getUint32(i)+4;const s=this.#e.getUint32(i);return this.#n.decode(new Uint8Array(this.#t,i+4,s))}get css(){return this.#i(0)}get loadedName(){return this.#i(1)}get baseFontName(){return this.#i(2)}get src(){return this.#i(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const i=this.#e.getUint32(t),s=this.#n.decode(new Uint8Array(this.#t,t+4,i));t+=4+i;const r=this.#e.getUint32(t),o=this.#n.decode(new Uint8Array(this.#t,t+4,r));return{style:s,weight:o}}}class Ht{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#n=this.#e+1+8;static#i=this.#n+1+48;static#r=this.#i+1+6;#a;#s;#l;constructor({data:t,extra:i}){this.#a=t,this.#s=new TextDecoder,this.#l=new DataView(this.#a),i&&Object.assign(this,i)}#c(t){Mt(t<Ht.bools.length,"Invalid boolean index");const i=Math.floor(t/4),s=t*2%8,r=this.#l.getUint8(i)>>s&3;return r===0?void 0:r===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#o(t){return Mt(t<Ht.numbers.length,"Invalid number index"),this.#l.getFloat64(Ht.#t+t*8)}get ascent(){return this.#o(0)}get defaultWidth(){return this.#o(1)}get descent(){return this.#o(2)}get bbox(){let t=Ht.#e;if(this.#l.getUint8(t)===0)return;t+=1;const s=[];for(let r=0;r<4;r++)s.push(this.#l.getInt16(t,!0)),t+=2;return s}get fontMatrix(){let t=Ht.#n;if(this.#l.getUint8(t)===0)return;t+=1;const s=[];for(let r=0;r<6;r++)s.push(this.#l.getFloat64(t,!0)),t+=8;return s}get defaultVMetrics(){let t=Ht.#i;if(this.#l.getUint8(t)===0)return;t+=1;const s=[];for(let r=0;r<3;r++)s.push(this.#l.getInt16(t,!0)),t+=2;return s}#d(t){Mt(t<Ht.strings.length,"Invalid string index");let i=Ht.#r+4;for(let o=0;o<t;o++)i+=this.#l.getUint32(i)+4;const s=this.#l.getUint32(i),r=new Uint8Array(s);return r.set(new Uint8Array(this.#a,i+4,s)),this.#s.decode(r)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=Ht.#r;const i=this.#l.getUint32(t);t+=4+i;const s=this.#l.getUint32(t);t+=4+s;const r=this.#l.getUint32(t);t+=4+r;const o=this.#l.getUint32(t);if(o!==0)return new Uint8Array(this.#a,t+4,o)}clearData(){let t=Ht.#r;const i=this.#l.getUint32(t);t+=4+i;const s=this.#l.getUint32(t);t+=4+s;const r=this.#l.getUint32(t);t+=4+r;const o=this.#l.getUint32(t);new Uint8Array(this.#a,t+4,o).fill(0),this.#l.setUint32(t,0)}get cssFontInfo(){let t=Ht.#r;const i=this.#l.getUint32(t);t+=4+i;const s=this.#l.getUint32(t);t+=4+s;const r=this.#l.getUint32(t);if(r===0)return null;const o=new Uint8Array(r);return o.set(new Uint8Array(this.#a,t+4,r)),new Ps(o.buffer)}get systemFontInfo(){let t=Ht.#r;const i=this.#l.getUint32(t);t+=4+i;const s=this.#l.getUint32(t);if(s===0)return null;const r=new Uint8Array(s);return r.set(new Uint8Array(this.#a,t+4,s)),new Fs(r.buffer)}static write(t){const i=t.systemFontInfo?Fs.write(t.systemFontInfo):null,s=t.cssFontInfo?Ps.write(t.cssFontInfo):null,r=new TextEncoder,o={};let c=0;for(const S of Ht.strings)o[S]=r.encode(t[S]),c+=4+o[S].length;const u=Ht.#r+4+c+4+(i?i.byteLength:0)+4+(s?s.byteLength:0)+4+(t.data?t.data.length:0),h=new ArrayBuffer(u),f=new Uint8Array(h),p=new DataView(h);let y=0;const b=Ht.bools.length;let A=0,_=0;for(let S=0;S<b;S++){const x=t[Ht.bools[S]];A|=(x===void 0?0:x?2:1)<<_,_+=2,(_===8||S===b-1)&&(p.setUint8(y++,A),A=0,_=0)}Mt(y===Ht.#t,"FontInfo.write: Boolean properties offset mismatch");for(const S of Ht.numbers)p.setFloat64(y,t[S]),y+=8;if(Mt(y===Ht.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){p.setUint8(y++,4);for(const S of t.bbox)p.setInt16(y,S,!0),y+=2}else p.setUint8(y++,0),y+=8;if(Mt(y===Ht.#n,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){p.setUint8(y++,6);for(const S of t.fontMatrix)p.setFloat64(y,S,!0),y+=8}else p.setUint8(y++,0),y+=48;if(Mt(y===Ht.#i,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){p.setUint8(y++,1);for(const S of t.defaultVMetrics)p.setInt16(y,S,!0),y+=2}else p.setUint8(y++,0),y+=6;Mt(y===Ht.#r,"FontInfo.write: DefaultVMetrics properties offset mismatch"),p.setUint32(Ht.#r,0),y+=4;for(const S of Ht.strings){const x=o[S],E=x.length;p.setUint32(y,E),f.set(x,y+4),y+=4+E}if(p.setUint32(Ht.#r,y-Ht.#r-4),!i)p.setUint32(y,0),y+=4;else{const S=i.byteLength;p.setUint32(y,S),Mt(y+4+S<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(i),y+4),y+=4+S}if(!s)p.setUint32(y,0),y+=4;else{const S=s.byteLength;p.setUint32(y,S),Mt(y+4+S<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(s),y+4),y+=4+S}return t.data===void 0?(p.setUint32(y,0),y+=4):(p.setUint32(y,t.data.length),f.set(t.data,y+4),y+=4+t.data.length),Mt(y<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(y)}}class me{static#t=0;static#e=1;static#n=2;static#i=3;static#r=4;static#a=8;static#s=12;static#l=16;constructor(t){this.buffer=t,this.view=new DataView(t),this.data=new Uint8Array(t)}static write(t){let i,s=null,r=[],o=[],c=[],u=[],h=null,f=null;switch(t[0]){case"RadialAxial":i=t[1]==="axial"?1:2,s=t[2],c=t[3],i===1?r.push(...t[4],...t[5]):r.push(t[4][0],t[4][1],t[6],t[5][0],t[5][1],t[7]);break;case"Mesh":i=3,h=t[1],r=t[2],o=t[3],u=t[4]||[],s=t[6],f=t[7];break;default:throw new Error(`Unsupported pattern type: ${t[0]}`)}const p=Math.floor(r.length/2),y=Math.floor(o.length/3),b=c.length,A=u.length;let _=0;for(const N of u)_+=1,_=Math.ceil(_/4)*4,_+=4+N.coords.length*4,_+=4+N.colors.length*4,N.verticesPerRow!==void 0&&(_+=4);const S=20+p*8+y*3+b*8+(s?16:0)+(f?3:0)+_,x=new ArrayBuffer(S),E=new DataView(x),D=new Uint8Array(x);E.setUint8(me.#t,i),E.setUint8(me.#e,s?1:0),E.setUint8(me.#n,f?1:0),E.setUint8(me.#i,h),E.setUint32(me.#r,p,!0),E.setUint32(me.#a,y,!0),E.setUint32(me.#s,b,!0),E.setUint32(me.#l,A,!0);let T=20;new Float32Array(x,T,p*2).set(r),T+=p*8,D.set(o,T),T+=y*3;for(const[N,k]of c)E.setFloat32(T,N,!0),T+=4,E.setUint32(T,parseInt(k.slice(1),16),!0),T+=4;if(s)for(const N of s)E.setFloat32(T,N,!0),T+=4;f&&(D.set(f,T),T+=3);for(let N=0;N<u.length;N++){const k=u[N];E.setUint8(T,k.type),T+=1,T=Math.ceil(T/4)*4,E.setUint32(T,k.coords.length,!0),T+=4,new Int32Array(x,T,k.coords.length).set(k.coords),T+=k.coords.length*4,E.setUint32(T,k.colors.length,!0),T+=4,new Int32Array(x,T,k.colors.length).set(k.colors),T+=k.colors.length*4,k.verticesPerRow!==void 0&&(E.setUint32(T,k.verticesPerRow,!0),T+=4)}return x}getIR(){const t=this.view,i=this.data[me.#t],s=!!this.data[me.#e],r=!!this.data[me.#n],o=t.getUint32(me.#r,!0),c=t.getUint32(me.#a,!0),u=t.getUint32(me.#s,!0),h=t.getUint32(me.#l,!0);let f=20;const p=new Float32Array(this.buffer,f,o*2);f+=o*8;const y=new Uint8Array(this.buffer,f,c*3);f+=c*3;const b=[];for(let x=0;x<u;++x){const E=t.getFloat32(f,!0);f+=4;const D=t.getUint32(f,!0);f+=4,b.push([E,`#${D.toString(16).padStart(6,"0")}`])}let A=null;if(s){A=[];for(let x=0;x<4;++x)A.push(t.getFloat32(f,!0)),f+=4}let _=null;r&&(_=new Uint8Array(this.buffer,f,3),f+=3);const S=[];for(let x=0;x<h;++x){const E=t.getUint8(f);f+=1,f=Math.ceil(f/4)*4;const D=t.getUint32(f,!0);f+=4;const T=new Int32Array(this.buffer,f,D);f+=D*4;const B=t.getUint32(f,!0);f+=4;const N=new Int32Array(this.buffer,f,B);f+=B*4;const k={type:E,coords:T,colors:N};E===Au.LATTICE&&(k.verticesPerRow=t.getUint32(f,!0),f+=4),S.push(k)}if(i===1)return["RadialAxial","axial",A,b,Array.from(p.slice(0,2)),Array.from(p.slice(2,4)),null,null];if(i===2)return["RadialAxial","radial",A,b,[p[0],p[1]],[p[3],p[4]],p[2],p[5]];if(i===3){const x=this.data[me.#i];let E=null;if(p.length>0){let D=p[0],T=p[0],B=p[1],N=p[1];for(let k=0;k<p.length;k+=2){const z=p[k],K=p[k+1];D=D>z?z:D,B=B>K?K:B,T=T<z?z:T,N=N<K?K:N}E=[D,B,T,N]}return["Mesh",x,p,y,S,E,A,_]}throw new Error(`Unsupported pattern kind: ${i}`)}}class cv{static write(t){let i,s;return de.isFloat16ArraySupported?(s=new ArrayBuffer(t.length*2),i=new Float16Array(s)):(s=new ArrayBuffer(t.length*4),i=new Float32Array(s)),i.set(t),s}#t;constructor(t){this.#t=t}get path(){return de.isFloat16ArraySupported?new Float16Array(this.#t):new Float32Array(this.#t)}}function uv(m){if(m instanceof URL)return m.href;if(typeof m=="string"){if(Re)return m;const t=URL.parse(m,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function hv(m){if(Re&&typeof Buffer<"u"&&m instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(m instanceof Uint8Array&&m.byteLength===m.buffer.byteLength)return m;if(typeof m=="string")return $a(m);if(m instanceof ArrayBuffer||ArrayBuffer.isView(m)||typeof m=="object"&&!isNaN(m?.length))return new Uint8Array(m);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Al(m){if(typeof m!="string")return null;if(m.endsWith("/"))return m;throw new Error(`Invalid factory url: "${m}" must include trailing slash.`)}const Tu=m=>typeof m=="object"&&Number.isInteger(m?.num)&&m.num>=0&&Number.isInteger(m?.gen)&&m.gen>=0,dv=m=>typeof m=="object"&&typeof m?.name=="string",fv=Xb.bind(null,Tu,dv);class gv{#t=new Map;#e=Promise.resolve();postMessage(t,i){const s={data:structuredClone(t,i?{transfer:i}:null)};this.#e.then(()=>{for(const[r]of this.#t)r.call(this,s)})}addEventListener(t,i,s=null){let r=null;if(s?.signal instanceof AbortSignal){const{signal:o}=s;if(o.aborted){pt("LoopbackPort - cannot use an `aborted` signal.");return}const c=()=>this.removeEventListener(t,i);r=()=>o.removeEventListener("abort",c),o.addEventListener("abort",c)}this.#t.set(i,r)}removeEventListener(t,i){this.#t.get(i)?.(),this.#t.delete(i)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const Sl={DATA:1,ERROR:2},oe={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Sp(){}function Ue(m){if(m instanceof An||m instanceof Su||m instanceof fp||m instanceof Dl||m instanceof hu)return m;switch(m instanceof Error||typeof m=="object"&&m!==null||Gt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),m.name){case"AbortException":return new An(m.message);case"InvalidPDFException":return new Su(m.message);case"PasswordException":return new fp(m.message,m.code);case"ResponseException":return new Dl(m.message,m.status,m.missing);case"UnknownErrorException":return new hu(m.message,m.details)}return new hu(m.message,m.toString())}class ja{#t=new AbortController;constructor(t,i,s){this.sourceName=t,this.targetName=i,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#i(t);return}if(t.callback){const s=t.callbackId,r=this.callbackCapabilities[s];if(!r)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],t.callback===Sl.DATA)r.resolve(t.data);else if(t.callback===Sl.ERROR)r.reject(Ue(t.reason));else throw new Error("Unexpected callback case");return}const i=this.actionHandler[t.action];if(!i)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const s=this.sourceName,r=t.sourceName,o=this.comObj;Promise.try(i,t.data).then(function(c){o.postMessage({sourceName:s,targetName:r,callback:Sl.DATA,callbackId:t.callbackId,data:c})},function(c){o.postMessage({sourceName:s,targetName:r,callback:Sl.ERROR,callbackId:t.callbackId,reason:Ue(c)})});return}if(t.streamId){this.#n(t);return}i(t.data)}on(t,i){const s=this.actionHandler;if(s[t])throw new Error(`There is already an actionName called "${t}"`);s[t]=i}send(t,i,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:i},s)}sendWithPromise(t,i,s){const r=this.callbackId++,o=Promise.withResolvers();this.callbackCapabilities[r]=o;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:r,data:i},s)}catch(c){o.reject(c)}return o.promise}sendWithStream(t,i,s,r){const o=this.streamId++,c=this.sourceName,u=this.targetName,h=this.comObj;return new ReadableStream({start:f=>{const p=Promise.withResolvers();return this.streamControllers[o]={controller:f,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:c,targetName:u,action:t,streamId:o,data:i,desiredSize:f.desiredSize},r),p.promise},pull:f=>{const p=Promise.withResolvers();return this.streamControllers[o].pullCall=p,h.postMessage({sourceName:c,targetName:u,stream:oe.PULL,streamId:o,desiredSize:f.desiredSize}),p.promise},cancel:f=>{Mt(f instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[o].cancelCall=p,this.streamControllers[o].isClosed=!0,h.postMessage({sourceName:c,targetName:u,stream:oe.CANCEL,streamId:o,reason:Ue(f)}),p.promise}},s)}#n(t){const i=t.streamId,s=this.sourceName,r=t.sourceName,o=this.comObj,c=this,u=this.actionHandler[t.action],h={enqueue(f,p=1,y){if(this.isCancelled)return;const b=this.desiredSize;this.desiredSize-=p,b>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),o.postMessage({sourceName:s,targetName:r,stream:oe.ENQUEUE,streamId:i,chunk:f},y)},close(){this.isCancelled||(this.isCancelled=!0,o.postMessage({sourceName:s,targetName:r,stream:oe.CLOSE,streamId:i}),delete c.streamSinks[i])},error(f){Mt(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,o.postMessage({sourceName:s,targetName:r,stream:oe.ERROR,streamId:i,reason:Ue(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[i]=h,Promise.try(u,t.data,h).then(function(){o.postMessage({sourceName:s,targetName:r,stream:oe.START_COMPLETE,streamId:i,success:!0})},function(f){o.postMessage({sourceName:s,targetName:r,stream:oe.START_COMPLETE,streamId:i,reason:Ue(f)})})}#i(t){const i=t.streamId,s=this.sourceName,r=t.sourceName,o=this.comObj,c=this.streamControllers[i],u=this.streamSinks[i];switch(t.stream){case oe.START_COMPLETE:t.success?c.startCall.resolve():c.startCall.reject(Ue(t.reason));break;case oe.PULL_COMPLETE:t.success?c.pullCall.resolve():c.pullCall.reject(Ue(t.reason));break;case oe.PULL:if(!u){o.postMessage({sourceName:s,targetName:r,stream:oe.PULL_COMPLETE,streamId:i,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||Sp).then(function(){o.postMessage({sourceName:s,targetName:r,stream:oe.PULL_COMPLETE,streamId:i,success:!0})},function(f){o.postMessage({sourceName:s,targetName:r,stream:oe.PULL_COMPLETE,streamId:i,reason:Ue(f)})});break;case oe.ENQUEUE:if(Mt(c,"enqueue should have stream controller"),c.isClosed)break;c.controller.enqueue(t.chunk);break;case oe.CLOSE:if(Mt(c,"close should have stream controller"),c.isClosed)break;c.isClosed=!0,c.controller.close(),this.#r(c,i);break;case oe.ERROR:Mt(c,"error should have stream controller"),c.controller.error(Ue(t.reason)),this.#r(c,i);break;case oe.CANCEL_COMPLETE:t.success?c.cancelCall.resolve():c.cancelCall.reject(Ue(t.reason)),this.#r(c,i);break;case oe.CANCEL:if(!u)break;const h=Ue(t.reason);Promise.try(u.onCancel||Sp,h).then(function(){o.postMessage({sourceName:s,targetName:r,stream:oe.CANCEL_COMPLETE,streamId:i,success:!0})},function(f){o.postMessage({sourceName:s,targetName:r,stream:oe.CANCEL_COMPLETE,streamId:i,reason:Ue(f)})}),u.sinkCapability.reject(h),u.isCancelled=!0,delete this.streamSinks[i];break;default:throw new Error("Unexpected stream case")}}async#r(t,i){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[i]}destroy(){this.#t?.abort(),this.#t=null}}class tm{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,i){if(t<=0||i<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(t,i);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,i,s){if(!t.canvas)throw new Error("Canvas is not specified");if(i<=0||s<=0)throw new Error("Invalid canvas size");t.canvas.width=i,t.canvas.height=s}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,i){Gt("Abstract method `_createCanvas` called.")}}class pv extends tm{constructor({ownerDocument:t=globalThis.document,enableHWA:i=!1}){super({enableHWA:i}),this._document=t}_createCanvas(t,i){const s=this._document.createElement("canvas");return s.width=t,s.height=i,s}}class em{constructor({baseUrl:t=null,isCompressed:i=!0}){this.baseUrl=t,this.isCompressed=i}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const i=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(i).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${i}`)})}async _fetch(t){Gt("Abstract method `_fetch` called.")}}class _p extends em{async _fetch(t){const i=await Qa(t,this.isCompressed?"arraybuffer":"text");return i instanceof ArrayBuffer?new Uint8Array(i):$a(i)}}class im{addFilter(t){return"none"}addHCMFilter(t,i){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,i,s,r,o){return"none"}destroy(t=!1){}}class mv extends im{#t;#e;#n;#i;#r;#a;#s=0;constructor({docId:t,ownerDocument:i=globalThis.document}){super(),this.#i=t,this.#r=i}get#l(){return this.#e||=new Map}get#c(){return this.#a||=new Map}get#o(){if(!this.#n){const t=this.#r.createElement("div"),{style:i}=t;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const s=this.#r.createElementNS(Vi,"svg");s.setAttribute("width",0),s.setAttribute("height",0),this.#n=this.#r.createElementNS(Vi,"defs"),t.append(s),s.append(this.#n),this.#r.body.append(t)}return this.#n}#d(t){if(t.length===1){const h=t[0],f=new Array(256);for(let y=0;y<256;y++)f[y]=h[y]/255;const p=f.join(",");return[p,p,p]}const[i,s,r]=t,o=new Array(256),c=new Array(256),u=new Array(256);for(let h=0;h<256;h++)o[h]=i[h]/255,c[h]=s[h]/255,u[h]=r[h]/255;return[o.join(","),c.join(","),u.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const i=this.#r.URL;i!==this.#r.baseURI&&(Bl(i)?pt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=qp(i,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let i=this.#l.get(t);if(i)return i;const[s,r,o]=this.#d(t),c=t.length===1?s:`${s}${r}${o}`;if(i=this.#l.get(c),i)return this.#l.set(t,i),i;const u=`g_${this.#i}_transfer_map_${this.#s++}`,h=this.#h(u);this.#l.set(t,h),this.#l.set(c,h);const f=this.#p(u);return this.#g(s,r,o,f),h}addHCMFilter(t,i){const s=`${t}-${i}`,r="base";let o=this.#c.get(r);if(o?.key===s||(o?(o.filter?.remove(),o.key=s,o.url="none",o.filter=null):(o={key:s,url:"none",filter:null},this.#c.set(r,o)),!t||!i))return o.url;const c=this.#v(t);t=it.makeHexColor(...c);const u=this.#v(i);if(i=it.makeHexColor(...u),this.#o.style.color="",t==="#000000"&&i==="#ffffff"||t===i)return o.url;const h=new Array(256);for(let A=0;A<=255;A++){const _=A/255;h[A]=_<=.03928?_/12.92:((_+.055)/1.055)**2.4}const f=h.join(","),p=`g_${this.#i}_hcm_filter`,y=o.filter=this.#p(p);this.#g(f,f,f,y),this.#m(y);const b=(A,_)=>{const S=c[A]/255,x=u[A]/255,E=new Array(_+1);for(let D=0;D<=_;D++)E[D]=S+D/_*(x-S);return E.join(",")};return this.#g(b(0,5),b(1,5),b(2,5),y),o.url=this.#h(p),o.url}addAlphaFilter(t){let i=this.#l.get(t);if(i)return i;const[s]=this.#d([t]),r=`alpha_${s}`;if(i=this.#l.get(r),i)return this.#l.set(t,i),i;const o=`g_${this.#i}_alpha_map_${this.#s++}`,c=this.#h(o);this.#l.set(t,c),this.#l.set(r,c);const u=this.#p(o);return this.#y(s,u),c}addLuminosityFilter(t){let i=this.#l.get(t||"luminosity");if(i)return i;let s,r;if(t?([s]=this.#d([t]),r=`luminosity_${s}`):r="luminosity",i=this.#l.get(r),i)return this.#l.set(t,i),i;const o=`g_${this.#i}_luminosity_map_${this.#s++}`,c=this.#h(o);this.#l.set(t,c),this.#l.set(r,c);const u=this.#p(o);return this.#f(u),t&&this.#y(s,u),c}addHighlightHCMFilter(t,i,s,r,o){const c=`${i}-${s}-${r}-${o}`;let u=this.#c.get(t);if(u?.key===c||(u?(u.filter?.remove(),u.key=c,u.url="none",u.filter=null):(u={key:c,url:"none",filter:null},this.#c.set(t,u)),!i||!s))return u.url;const[h,f]=[i,s].map(this.#v.bind(this));let p=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),y=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[b,A]=[r,o].map(this.#v.bind(this));y<p&&([p,y,b,A]=[y,p,A,b]),this.#o.style.color="";const _=(E,D,T)=>{const B=new Array(256),N=(y-p)/T,k=E/255,z=(D-E)/(255*T);let K=0;for(let Q=0;Q<=T;Q++){const et=Math.round(p+Q*N),W=k+Q*z;for(let dt=K;dt<=et;dt++)B[dt]=W;K=et+1}for(let Q=K;Q<256;Q++)B[Q]=B[K-1];return B.join(",")},S=`g_${this.#i}_hcm_${t}_filter`,x=u.filter=this.#p(S);return this.#m(x),this.#g(_(b[0],A[0],5),_(b[1],A[1],5),_(b[2],A[2],5),x),u.url=this.#h(S),u.url}destroy(t=!1){t&&this.#a?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#e?.clear(),this.#e=null,this.#a?.clear(),this.#a=null,this.#s=0)}#f(t){const i=this.#r.createElementNS(Vi,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(i)}#m(t){const i=this.#r.createElementNS(Vi,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(i)}#p(t){const i=this.#r.createElementNS(Vi,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",t),this.#o.append(i),i}#u(t,i,s){const r=this.#r.createElementNS(Vi,i);r.setAttribute("type","discrete"),r.setAttribute("tableValues",s),t.append(r)}#g(t,i,s,r){const o=this.#r.createElementNS(Vi,"feComponentTransfer");r.append(o),this.#u(o,"feFuncR",t),this.#u(o,"feFuncG",i),this.#u(o,"feFuncB",s)}#y(t,i){const s=this.#r.createElementNS(Vi,"feComponentTransfer");i.append(s),this.#u(s,"feFuncA",t)}#v(t){return this.#o.style.color=t,Wa(getComputedStyle(this.#o).getPropertyValue("color"))}}class nm{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetch(i).catch(s=>{throw new Error(`Unable to load font data at: ${i}`)})}async _fetch(t){Gt("Abstract method `_fetch` called.")}}class wp extends nm{async _fetch(t){const i=await Qa(t,"arraybuffer");return new Uint8Array(i)}}class sm{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetch(i).catch(s=>{throw new Error(`Unable to load wasm data at: ${i}`)})}async _fetch(t){Gt("Abstract method `_fetch` called.")}}class Ep extends sm{async _fetch(t){const i=await Qa(t,"arraybuffer");return new Uint8Array(i)}}Re&&pt("Please use the `legacy` build in Node.js environments.");async function Uu(m){const i=await process.getBuiltinModule("fs").promises.readFile(m);return new Uint8Array(i)}class yv extends im{}class bv extends tm{_createCanvas(t,i){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,i)}}class vv extends em{async _fetch(t){return Uu(t)}}class Av extends nm{async _fetch(t){return Uu(t)}}class Sv extends sm{async _fetch(t){return Uu(t)}}const Rs="__forcedDependency",{floor:xp,ceil:Tp}=Math;function _l(m,t,i,s,r,o){m[t*4+0]=Math.min(m[t*4+0],i),m[t*4+1]=Math.min(m[t*4+1],s),m[t*4+2]=Math.max(m[t*4+2],r),m[t*4+3]=Math.max(m[t*4+3],o)}const Cu=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class _v{#t;#e;constructor(t,i){this.#t=t,this.#e=i}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===Cu}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const wl=(m,t)=>{if(!m)return;let i=m.get(t);return i||(i={dependencies:new Set,isRenderingOperation:!1},m.set(t,i)),i};class wv{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[Rs]:[]};#n=new Map;#i=[];#r=[];#a=[[1,0,0,1,0,0]];#s=[-1/0,-1/0,1/0,1/0];#l=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#o=new Set;#d=new Map;#h=new Map;#f;#m;#p;#u;#g;constructor(t,i,s=!1){this.#f=t.width,this.#m=t.height,this.#y(i),s&&(this.#g=new Map)}growOperationsCount(t){t>=this.#u.length&&this.#y(t,this.#u)}#y(t,i){const s=new ArrayBuffer(t*4);this.#p=new Uint8ClampedArray(s),this.#u=new Uint32Array(s),i&&i.length>0?(this.#u.set(i),this.#u.fill(Cu,i.length)):this.#u.fill(Cu)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[Rs]:{__proto__:this.#e[Rs]}},this.#s={__proto__:this.#s},this.#i.push(t),this}restore(t){const i=Object.getPrototypeOf(this.#t);if(i===null)return this;this.#t=i,this.#e=Object.getPrototypeOf(this.#e),this.#s=Object.getPrototypeOf(this.#s);const s=this.#i.pop();return s!==void 0&&(wl(this.#g,t)?.dependencies.add(s),this.#u[t]=this.#u[s]),this}recordOpenMarker(t){return this.#i.push(t),this}getOpenMarker(){return this.#i.length===0?null:this.#i.at(-1)}recordCloseMarker(t){const i=this.#i.pop();return i!==void 0&&(wl(this.#g,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}beginMarkedContent(t){return this.#r.push(t),this}endMarkedContent(t){const i=this.#r.pop();return i!==void 0&&(wl(this.#g,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}pushBaseTransform(t){return this.#a.push(it.multiplyByDOMMatrix(this.#a.at(-1),t.getTransform())),this}popBaseTransform(){return this.#a.length>1&&this.#a.pop(),this}recordSimpleData(t,i){return this.#t[t]=i,this}recordIncrementalData(t,i){return this.#e[t].push(i),this}resetIncrementalData(t,i){return this.#e[t].length=0,this}recordNamedData(t,i){return this.#n.set(t,i),this}recordSimpleDataFromNamed(t,i,s){this.#t[t]=this.#n.get(i)??s}recordFutureForcedDependency(t,i){return this.recordIncrementalData(Rs,i),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const i of t)i in this.#t&&this.recordFutureForcedDependency(i,this.#t[i]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#o)this.recordFutureForcedDependency(Rs,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#l[0]=1/0,this.#l[1]=1/0,this.#l[2]=-1/0,this.#l[3]=-1/0),this}recordClipBox(t,i,s,r,o,c){const u=it.multiplyByDOMMatrix(this.#a.at(-1),i.getTransform()),h=[1/0,1/0,-1/0,-1/0];it.axialAlignedBoundingBox([s,o,r,c],u,h);const f=it.intersect(this.#s,h);return f?(this.#s[0]=f[0],this.#s[1]=f[1],this.#s[2]=f[2],this.#s[3]=f[3]):(this.#s[0]=this.#s[1]=1/0,this.#s[2]=this.#s[3]=-1/0),this}recordBBox(t,i,s,r,o,c){const u=this.#s;if(u[0]===1/0)return this;const h=it.multiplyByDOMMatrix(this.#a.at(-1),i.getTransform());if(u[0]===-1/0)return it.axialAlignedBoundingBox([s,o,r,c],h,this.#l),this;const f=[1/0,1/0,-1/0,-1/0];return it.axialAlignedBoundingBox([s,o,r,c],h,f),this.#l[0]=Math.min(this.#l[0],Math.max(f[0],u[0])),this.#l[1]=Math.min(this.#l[1],Math.max(f[1],u[1])),this.#l[2]=Math.max(this.#l[2],Math.min(f[2],u[2])),this.#l[3]=Math.max(this.#l[3],Math.min(f[3],u[3])),this}recordCharacterBBox(t,i,s,r=1,o=0,c=0,u){const h=s.bbox;let f,p;if(h&&(f=h[2]!==h[0]&&h[3]!==h[1]&&this.#h.get(s),f!==!1&&(p=[0,0,0,0],it.axialAlignedBoundingBox(h,s.fontMatrix,p),(r!==1||o!==0||c!==0)&&it.scaleMinMax([r,0,0,-r,o,c],p),f)))return this.recordBBox(t,i,p[0],p[2],p[1],p[3]);if(!u)return this.recordFullPageBBox(t);const y=u();return h&&p&&f===void 0&&(f=p[0]<=o-y.actualBoundingBoxLeft&&p[2]>=o+y.actualBoundingBoxRight&&p[1]<=c-y.actualBoundingBoxAscent&&p[3]>=c+y.actualBoundingBoxDescent,this.#h.set(s,f),f)?this.recordBBox(t,i,p[0],p[2],p[1],p[3]):this.recordBBox(t,i,o-y.actualBoundingBoxLeft,o+y.actualBoundingBoxRight,c-y.actualBoundingBoxAscent,c+y.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#l[0]=Math.max(0,this.#s[0]),this.#l[1]=Math.max(0,this.#s[1]),this.#l[2]=Math.min(this.#f,this.#s[2]),this.#l[3]=Math.min(this.#m,this.#s[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,i){const s=this.#o,r=this.#t,o=this.#e;for(const c of i)c in this.#t?s.add(r[c]):c in o&&o[c].forEach(s.add,s);return this}recordNamedDependency(t,i){return this.#n.has(i)&&this.#o.add(this.#n.get(i)),this}recordOperation(t,i=!1){if(this.recordDependencies(t,[Rs]),this.#g){const s=wl(this.#g,t),{dependencies:r}=s;this.#o.forEach(r.add,r),this.#i.forEach(r.add,r),this.#r.forEach(r.add,r),r.delete(t),s.isRenderingOperation=!0}if(this.#c===t){const s=xp(this.#l[0]*256/this.#f),r=xp(this.#l[1]*256/this.#m),o=Tp(this.#l[2]*256/this.#f),c=Tp(this.#l[3]*256/this.#m);_l(this.#p,t,s,r,o,c);for(const u of this.#o)u!==t&&_l(this.#p,u,s,r,o,c);for(const u of this.#i)u!==t&&_l(this.#p,u,s,r,o,c);for(const u of this.#r)u!==t&&_l(this.#p,u,s,r,o,c);i||(this.#o.clear(),this.#c=-1)}return this}recordShowTextOperation(t,i=!1){const s=Array.from(this.#o);this.recordOperation(t,i),this.recordIncrementalData("sameLineText",t);for(const r of s)this.recordIncrementalData("sameLineText",r);return this}bboxToClipBoxDropOperation(t,i=!1){return this.#c===t&&(this.#c=-1,this.#s[0]=Math.max(this.#s[0],this.#l[0]),this.#s[1]=Math.max(this.#s[1],this.#l[1]),this.#s[2]=Math.min(this.#s[2],this.#l[2]),this.#s[3]=Math.min(this.#s[3],this.#l[3]),i||this.#o.clear()),this}_takePendingDependencies(){const t=this.#o;return this.#o=new Set,t}_extractOperation(t){const i=this.#d.get(t);return this.#d.delete(t),i}_pushPendingDependencies(t){for(const i of t)this.#o.add(i)}take(){return this.#h.clear(),new _v(this.#u,this.#p)}takeDebugMetadata(){return this.#g}}class Rl{#t;#e;#n;#i=0;#r=0;constructor(t,i,s){if(t instanceof Rl&&t.#n===!!s)return t;this.#t=t,this.#e=i,this.#n=!!s}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#r++,this.#t.save(this.#e),this}restore(t){return this.#r>0&&(this.#t.restore(this.#e),this.#r--),this}recordOpenMarker(t){return this.#i++,this}getOpenMarker(){return this.#i>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#i--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,i){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,i){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,i){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,i){return this}recordSimpleDataFromNamed(t,i,s){return this.#t.recordSimpleDataFromNamed(t,i,this.#e),this}recordFutureForcedDependency(t,i){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#n||this.#t.resetBBox(this.#e),this}recordClipBox(t,i,s,r,o,c){return this.#n||this.#t.recordClipBox(this.#e,i,s,r,o,c),this}recordBBox(t,i,s,r,o,c){return this.#n||this.#t.recordBBox(this.#e,i,s,r,o,c),this}recordCharacterBBox(t,i,s,r,o,c,u){return this.#n||this.#t.recordCharacterBBox(this.#e,i,s,r,o,c,u),this}recordFullPageBBox(t){return this.#n||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,i){return this.#t.recordDependencies(this.#e,i),this}recordNamedDependency(t,i){return this.#t.recordNamedDependency(this.#e,i),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#n||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const hi={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},xe={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Mu(m,t){if(!t)return;const i=t[2]-t[0],s=t[3]-t[1],r=new Path2D;r.rect(t[0],t[1],i,s),m.clip(r)}class Iu{isModifyingCurrentTransform(){return!1}getPattern(){Gt("Abstract method `getPattern` called.")}}class Ev extends Iu{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(t,i=null){let s,r=this._p0,o=this._p1;if(i&&(r=r.slice(),o=o.slice(),it.applyTransform(r,i),it.applyTransform(o,i)),this._type==="axial")s=t.createLinearGradient(r[0],r[1],o[0],o[1]);else if(this._type==="radial"){let c=this._r0,u=this._r1;if(i){const h=new Float32Array(2);it.singularValueDecompose2dScale(i,h),c*=h[0],u*=h[0]}s=t.createRadialGradient(r[0],r[1],c,o[0],o[1],u)}for(const c of this._colorStops)s.addColorStop(c[0],c[1]);return s}getPattern(t,i,s,r){let o;if(r===xe.STROKE||r===xe.FILL){if(this.isOriginBased()){let b=it.transform(s,i.baseTransform);this.matrix&&(b=it.transform(b,this.matrix));const A=.001,_=Math.hypot(b[0],b[1]),S=Math.hypot(b[2],b[3]),x=(b[0]*b[2]+b[1]*b[3])/(_*S);if(Math.abs(x)<A)if(this.isRadial()){if(Math.abs(_-S)<A)return this._createGradient(t,b)}else return this._createGradient(t,b)}const c=i.current.getClippedPathBoundingBox(r,$t(t))||[0,0,0,0],u=Math.ceil(c[2]-c[0])||1,h=Math.ceil(c[3]-c[1])||1,f=i.cachedCanvases.getCanvas("pattern",u,h),p=f.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-c[0],-c[1]),s=it.transform(s,[1,0,0,1,c[0],c[1]]),p.transform(...i.baseTransform),this.matrix&&p.transform(...this.matrix),Mu(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),o=t.createPattern(f.canvas,"no-repeat");const y=new DOMMatrix(s);o.setTransform(y)}else Mu(t,this._bbox),o=this._createGradient(t);return o}}function gu(m,t,i,s,r,o,c,u){const h=t.coords,f=t.colors,p=m.data,y=m.width*4;let b;h[i+1]>h[s+1]&&(b=i,i=s,s=b,b=o,o=c,c=b),h[s+1]>h[r+1]&&(b=s,s=r,r=b,b=c,c=u,u=b),h[i+1]>h[s+1]&&(b=i,i=s,s=b,b=o,o=c,c=b);const A=(h[i]+t.offsetX)*t.scaleX,_=(h[i+1]+t.offsetY)*t.scaleY,S=(h[s]+t.offsetX)*t.scaleX,x=(h[s+1]+t.offsetY)*t.scaleY,E=(h[r]+t.offsetX)*t.scaleX,D=(h[r+1]+t.offsetY)*t.scaleY;if(_>=D)return;const T=f[o],B=f[o+1],N=f[o+2],k=f[c],z=f[c+1],K=f[c+2],Q=f[u],et=f[u+1],W=f[u+2],dt=Math.round(_),_t=Math.round(D);let ft,xt,O,G,J,$,st,C;for(let F=dt;F<=_t;F++){if(F<x){const ut=F<_?0:(_-F)/(_-x);ft=A-(A-S)*ut,xt=T-(T-k)*ut,O=B-(B-z)*ut,G=N-(N-K)*ut}else{let ut;F>D?ut=1:x===D?ut=0:ut=(x-F)/(x-D),ft=S-(S-E)*ut,xt=k-(k-Q)*ut,O=z-(z-et)*ut,G=K-(K-W)*ut}let Y;F<_?Y=0:F>D?Y=1:Y=(_-F)/(_-D),J=A-(A-E)*Y,$=T-(T-Q)*Y,st=B-(B-et)*Y,C=N-(N-W)*Y;const tt=Math.round(Math.min(ft,J)),Z=Math.round(Math.max(ft,J));let lt=y*F+tt*4;for(let ut=tt;ut<=Z;ut++)Y=(ft-ut)/(ft-J),Y<0?Y=0:Y>1&&(Y=1),p[lt++]=xt-(xt-$)*Y|0,p[lt++]=O-(O-st)*Y|0,p[lt++]=G-(G-C)*Y|0,p[lt++]=255}}function xv(m,t,i){const s=t.coords,r=t.colors;let o,c;switch(t.type){case Au.LATTICE:const u=t.verticesPerRow,h=Math.floor(s.length/u)-1,f=u-1;for(o=0;o<h;o++){let p=o*u;for(let y=0;y<f;y++,p++)gu(m,i,s[p],s[p+1],s[p+u],r[p],r[p+1],r[p+u]),gu(m,i,s[p+u+1],s[p+1],s[p+u],r[p+u+1],r[p+1],r[p+u])}break;case Au.TRIANGLES:for(o=0,c=s.length;o<c;o+=3)gu(m,i,s[o],s[o+1],s[o+2],r[o],r[o+1],r[o+2]);break;default:throw new Error("illegal figure")}}class Tv extends Iu{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,i,s){const u=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-u,p=Math.ceil(this._bounds[3])-h,y=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),b=Math.min(Math.ceil(Math.abs(p*t[1]*1.1)),3e3),A=f/y,_=p/b,S={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-h,scaleX:1/A,scaleY:1/_},x=y+4,E=b+4,D=s.getCanvas("mesh",x,E),T=D.context,B=T.createImageData(y,b);if(i){const k=B.data;for(let z=0,K=k.length;z<K;z+=4)k[z]=i[0],k[z+1]=i[1],k[z+2]=i[2],k[z+3]=255}for(const k of this._figures)xv(B,k,S);return T.putImageData(B,2,2),{canvas:D.canvas,offsetX:u-2*A,offsetY:h-2*_,scaleX:A,scaleY:_}}isModifyingCurrentTransform(){return!0}getPattern(t,i,s,r){Mu(t,this._bbox);const o=new Float32Array(2);if(r===xe.SHADING)it.singularValueDecompose2dScale($t(t),o);else if(this.matrix){it.singularValueDecompose2dScale(this.matrix,o);const[u,h]=o;it.singularValueDecompose2dScale(i.baseTransform,o),o[0]*=u,o[1]*=h}else it.singularValueDecompose2dScale(i.baseTransform,o);const c=this._createMeshCanvas(o,r===xe.SHADING?null:this._background,i.cachedCanvases);return r!==xe.SHADING&&(t.setTransform(...i.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(c.offsetX,c.offsetY),t.scale(c.scaleX,c.scaleY),t.createPattern(c.canvas,"no-repeat")}}class Cv extends Iu{getPattern(){return"hotpink"}}function Mv(m){switch(m[0]){case"RadialAxial":return new Ev(m);case"Mesh":return new Tv(m);case"Dummy":return new Cv}throw new Error(`Unknown IR type: ${m[0]}`)}const Cp={COLORED:1,UNCOLORED:2};class Hu{static MAX_PATTERN_SIZE=3e3;constructor(t,i,s,r){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=i,this.canvasGraphicsFactory=s,this.baseTransform=r}createPatternCanvas(t,i){const{bbox:s,operatorList:r,paintType:o,tilingType:c,color:u,canvasGraphicsFactory:h}=this;let{xstep:f,ystep:p}=this;f=Math.abs(f),p=Math.abs(p),kl("TilingType: "+c);const y=s[0],b=s[1],A=s[2],_=s[3],S=A-y,x=_-b,E=new Float32Array(2);it.singularValueDecompose2dScale(this.matrix,E);const[D,T]=E;it.singularValueDecompose2dScale(this.baseTransform,E);const B=D*E[0],N=T*E[1];let k=S,z=x,K=!1,Q=!1;const et=Math.ceil(f*B),W=Math.ceil(p*N),dt=Math.ceil(S*B),_t=Math.ceil(x*N);et>=dt?k=f:K=!0,W>=_t?z=p:Q=!0;const ft=this.getSizeAndScale(k,this.ctx.canvas.width,B),xt=this.getSizeAndScale(z,this.ctx.canvas.height,N),O=t.cachedCanvases.getCanvas("pattern",ft.size,xt.size),G=O.context,J=h.createCanvasGraphics(G,i);if(J.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(J,o,u),G.translate(-ft.scale*y,-xt.scale*b),J.transform(0,ft.scale,0,0,xt.scale,0,0),G.save(),J.dependencyTracker?.save(),this.clipBbox(J,y,b,A,_),J.baseTransform=$t(J.ctx),J.executeOperatorList(r),J.endDrawing(),J.dependencyTracker?.restore(),G.restore(),K||Q){const $=O.canvas;K&&(k=f),Q&&(z=p);const st=this.getSizeAndScale(k,this.ctx.canvas.width,B),C=this.getSizeAndScale(z,this.ctx.canvas.height,N),F=st.size,Y=C.size,tt=t.cachedCanvases.getCanvas("pattern-workaround",F,Y),Z=tt.context,lt=K?Math.floor(S/f):0,ut=Q?Math.floor(x/p):0;for(let Kt=0;Kt<=lt;Kt++)for(let kt=0;kt<=ut;kt++)Z.drawImage($,F*Kt,Y*kt,F,Y,0,0,F,Y);return{canvas:tt.canvas,scaleX:st.scale,scaleY:C.scale,offsetX:y,offsetY:b}}return{canvas:O.canvas,scaleX:ft.scale,scaleY:xt.scale,offsetX:y,offsetY:b}}getSizeAndScale(t,i,s){const r=Math.max(Hu.MAX_PATTERN_SIZE,i);let o=Math.ceil(t*s);return o>=r?o=r:s=o/t,{scale:s,size:o}}clipBbox(t,i,s,r,o){const c=r-i,u=o-s;t.ctx.rect(i,s,c,u),it.axialAlignedBoundingBox([i,s,r,o],$t(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,i,s){const r=t.ctx,o=t.current;switch(i){case Cp.COLORED:const{fillStyle:c,strokeStyle:u}=this.ctx;r.fillStyle=o.fillColor=c,r.strokeStyle=o.strokeColor=u;break;case Cp.UNCOLORED:r.fillStyle=r.strokeStyle=s,o.fillColor=o.strokeColor=s;break;default:throw new Ib(`Unsupported paint type: ${i}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,i,s,r,o){let c=s;r!==xe.SHADING&&(c=it.transform(c,i.baseTransform),this.matrix&&(c=it.transform(c,this.matrix)));const u=this.createPatternCanvas(i,o);let h=new DOMMatrix(c);h=h.translate(u.offsetX,u.offsetY),h=h.scale(1/u.scaleX,1/u.scaleY);const f=t.createPattern(u.canvas,"repeat");return f.setTransform(h),f}}function Dv({src:m,srcPos:t=0,dest:i,width:s,height:r,nonBlackColor:o=4294967295,inverseDecode:c=!1}){const u=de.isLittleEndian?4278190080:255,[h,f]=c?[o,u]:[u,o],p=s>>3,y=s&7,b=m.length;i=new Uint32Array(i.buffer);let A=0;for(let _=0;_<r;_++){for(const x=t+p;t<x;t++){const E=t<b?m[t]:255;i[A++]=E&128?f:h,i[A++]=E&64?f:h,i[A++]=E&32?f:h,i[A++]=E&16?f:h,i[A++]=E&8?f:h,i[A++]=E&4?f:h,i[A++]=E&2?f:h,i[A++]=E&1?f:h}if(y===0)continue;const S=t<b?m[t++]:255;for(let x=0;x<y;x++)i[A++]=S&1<<7-x?f:h}return{srcPos:t,destPos:A}}const Mp=16,Dp=100,Rv=15,Rp=10,Ie=16,pu=new DOMMatrix,Je=new Float32Array(2),Bs=new Float32Array([1/0,1/0,-1/0,-1/0]);function Ov(m,t){if(m._removeMirroring)throw new Error("Context is already forwarding operations.");m.__originalSave=m.save,m.__originalRestore=m.restore,m.__originalRotate=m.rotate,m.__originalScale=m.scale,m.__originalTranslate=m.translate,m.__originalTransform=m.transform,m.__originalSetTransform=m.setTransform,m.__originalResetTransform=m.resetTransform,m.__originalClip=m.clip,m.__originalMoveTo=m.moveTo,m.__originalLineTo=m.lineTo,m.__originalBezierCurveTo=m.bezierCurveTo,m.__originalRect=m.rect,m.__originalClosePath=m.closePath,m.__originalBeginPath=m.beginPath,m._removeMirroring=()=>{m.save=m.__originalSave,m.restore=m.__originalRestore,m.rotate=m.__originalRotate,m.scale=m.__originalScale,m.translate=m.__originalTranslate,m.transform=m.__originalTransform,m.setTransform=m.__originalSetTransform,m.resetTransform=m.__originalResetTransform,m.clip=m.__originalClip,m.moveTo=m.__originalMoveTo,m.lineTo=m.__originalLineTo,m.bezierCurveTo=m.__originalBezierCurveTo,m.rect=m.__originalRect,m.closePath=m.__originalClosePath,m.beginPath=m.__originalBeginPath,delete m._removeMirroring},m.save=function(){t.save(),this.__originalSave()},m.restore=function(){t.restore(),this.__originalRestore()},m.translate=function(i,s){t.translate(i,s),this.__originalTranslate(i,s)},m.scale=function(i,s){t.scale(i,s),this.__originalScale(i,s)},m.transform=function(i,s,r,o,c,u){t.transform(i,s,r,o,c,u),this.__originalTransform(i,s,r,o,c,u)},m.setTransform=function(i,s,r,o,c,u){t.setTransform(i,s,r,o,c,u),this.__originalSetTransform(i,s,r,o,c,u)},m.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},m.rotate=function(i){t.rotate(i),this.__originalRotate(i)},m.clip=function(i){t.clip(i),this.__originalClip(i)},m.moveTo=function(i,s){t.moveTo(i,s),this.__originalMoveTo(i,s)},m.lineTo=function(i,s){t.lineTo(i,s),this.__originalLineTo(i,s)},m.bezierCurveTo=function(i,s,r,o,c,u){t.bezierCurveTo(i,s,r,o,c,u),this.__originalBezierCurveTo(i,s,r,o,c,u)},m.rect=function(i,s,r,o){t.rect(i,s,r,o),this.__originalRect(i,s,r,o)},m.closePath=function(){t.closePath(),this.__originalClosePath()},m.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class Nv{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,i,s){let r;return this.cache[t]!==void 0?(r=this.cache[t],this.canvasFactory.reset(r,i,s)):(r=this.canvasFactory.create(i,s),this.cache[t]=r),r}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const i=this.cache[t];this.canvasFactory.destroy(i),delete this.cache[t]}}}function El(m,t,i,s,r,o,c,u,h,f){const[p,y,b,A,_,S]=$t(m);if(y===0&&b===0){const D=c*p+_,T=Math.round(D),B=u*A+S,N=Math.round(B),k=(c+h)*p+_,z=Math.abs(Math.round(k)-T)||1,K=(u+f)*A+S,Q=Math.abs(Math.round(K)-N)||1;return m.setTransform(Math.sign(p),0,0,Math.sign(A),T,N),m.drawImage(t,i,s,r,o,0,0,z,Q),m.setTransform(p,y,b,A,_,S),[z,Q]}if(p===0&&A===0){const D=u*b+_,T=Math.round(D),B=c*y+S,N=Math.round(B),k=(u+f)*b+_,z=Math.abs(Math.round(k)-T)||1,K=(c+h)*y+S,Q=Math.abs(Math.round(K)-N)||1;return m.setTransform(0,Math.sign(y),Math.sign(b),0,T,N),m.drawImage(t,i,s,r,o,0,0,Q,z),m.setTransform(p,y,b,A,_,S),[Q,z]}m.drawImage(t,i,s,r,o,c,u,h,f);const x=Math.hypot(p,y),E=Math.hypot(b,A);return[x*h,E*f]}class Op{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=vu;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=he.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,i,s){s?.(this),this.clipBox=new Float32Array([0,0,t,i]),this.minMax=Bs.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=xe.FILL,i=null){const s=this.minMax.slice();if(t===xe.STROKE){i||Gt("Stroke bounding box must include transform."),it.singularValueDecompose2dScale(i,Je);const r=Je[0]*this.lineWidth/2,o=Je[1]*this.lineWidth/2;s[0]-=r,s[1]-=o,s[2]+=r,s[3]+=o}return s}updateClipFromPath(){const t=it.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(Bs,0)}getClippedPathBoundingBox(t=xe.FILL,i=null){return it.intersect(this.clipBox,this.getPathBoundingBox(t,i))}}function Np(m,t){if(t instanceof ImageData){m.putImageData(t,0,0);return}const i=t.height,s=t.width,r=i%Ie,o=(i-r)/Ie,c=r===0?o:o+1,u=m.createImageData(s,Ie);let h=0,f;const p=t.data,y=u.data;let b,A,_,S;if(t.kind===Ml.GRAYSCALE_1BPP){const x=p.byteLength,E=new Uint32Array(y.buffer,0,y.byteLength>>2),D=E.length,T=s+7>>3,B=4294967295,N=de.isLittleEndian?4278190080:255;for(b=0;b<c;b++){for(_=b<o?Ie:r,f=0,A=0;A<_;A++){const k=x-h;let z=0;const K=k>T?s:k*8-7,Q=K&-8;let et=0,W=0;for(;z<Q;z+=8)W=p[h++],E[f++]=W&128?B:N,E[f++]=W&64?B:N,E[f++]=W&32?B:N,E[f++]=W&16?B:N,E[f++]=W&8?B:N,E[f++]=W&4?B:N,E[f++]=W&2?B:N,E[f++]=W&1?B:N;for(;z<K;z++)et===0&&(W=p[h++],et=128),E[f++]=W&et?B:N,et>>=1}for(;f<D;)E[f++]=0;m.putImageData(u,0,b*Ie)}}else if(t.kind===Ml.RGBA_32BPP){for(A=0,S=s*Ie*4,b=0;b<o;b++)y.set(p.subarray(h,h+S)),h+=S,m.putImageData(u,0,A),A+=Ie;b<c&&(S=s*r*4,y.set(p.subarray(h,h+S)),m.putImageData(u,0,A))}else if(t.kind===Ml.RGB_24BPP)for(_=Ie,S=s*_,b=0;b<c;b++){for(b>=o&&(_=r,S=s*_),f=0,A=S;A--;)y[f++]=p[h++],y[f++]=p[h++],y[f++]=p[h++],y[f++]=255;m.putImageData(u,0,b*Ie)}else throw new Error(`bad image kind: ${t.kind}`)}function Lp(m,t){if(t.bitmap){m.drawImage(t.bitmap,0,0);return}const i=t.height,s=t.width,r=i%Ie,o=(i-r)/Ie,c=r===0?o:o+1,u=m.createImageData(s,Ie);let h=0;const f=t.data,p=u.data;for(let y=0;y<c;y++){const b=y<o?Ie:r;({srcPos:h}=Dv({src:f,srcPos:h,dest:p,width:s,height:b,nonBlackColor:0})),m.putImageData(u,0,y*Ie)}}function Pa(m,t){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of i)m[s]!==void 0&&(t[s]=m[s]);m.setLineDash!==void 0&&(t.setLineDash(m.getLineDash()),t.lineDashOffset=m.lineDashOffset)}function xl(m){m.strokeStyle=m.fillStyle="#000000",m.fillRule="nonzero",m.globalAlpha=1,m.lineWidth=1,m.lineCap="butt",m.lineJoin="miter",m.miterLimit=10,m.globalCompositeOperation="source-over",m.font="10px sans-serif",m.setLineDash!==void 0&&(m.setLineDash([]),m.lineDashOffset=0);const{filter:t}=m;t!=="none"&&t!==""&&(m.filter="none")}function kp(m,t){if(t)return!0;it.singularValueDecompose2dScale(m,Je);const i=Math.fround(xi.pixelRatio*Hs.PDF_TO_CSS_UNITS);return Je[0]<=i&&Je[1]<=i}const Lv=["butt","round","square"],kv=["miter","round","bevel"],Bv={},Bp={};class Us{constructor(t,i,s,r,o,{optionalContentConfig:c,markedContentStack:u=null},h,f,p){this.ctx=t,this.current=new Op(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=i,this.objs=s,this.canvasFactory=r,this.filterFactory=o,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=c,this.cachedCanvases=new Nv(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=p??null}getObject(t,i,s=null){return typeof i=="string"?(this.dependencyTracker?.recordNamedDependency(t,i),i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i)):s}beginDrawing({transform:t,viewport:i,transparency:s=!1,background:r=null}){const o=this.ctx.canvas.width,c=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,o,c),this.ctx.fillStyle=u,s){const h=this.cachedCanvases.getCanvas("transparent",o,c);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...$t(this.compositeCtx))}this.ctx.save(),xl(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...i.transform),this.viewportScale=i.scale,this.baseTransform=$t(this.ctx)}executeOperatorList(t,i,s,r,o){const c=t.argsArray,u=t.fnArray;let h=i||0;const f=c.length;if(f===h)return h;const p=f-h>Rp&&typeof s=="function",y=p?Date.now()+Rv:0;let b=0;const A=this.commonObjs,_=this.objs;let S,x;for(;;){if(r!==void 0&&h===r.nextBreakPoint)return r.breakIt(h,s),h;if(!o||o(h))if(S=u[h],x=c[h]??null,S!==Xa.dependency)x===null?this[S](h):this[S](h,...x);else for(const E of x){this.dependencyTracker?.recordNamedData(E,h);const D=E.startsWith("g_")?A:_;if(!D.has(E))return D.get(E,s),h}if(h++,h===f)return h;if(p&&++b>Rp){if(Date.now()>y)return s(),h;b=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const i of t.values())typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&(i.width=i.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const i=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=i}}}_scaleImage(t,i){const s=t.width??t.displayWidth,r=t.height??t.displayHeight;let o=Math.max(Math.hypot(i[0],i[1]),1),c=Math.max(Math.hypot(i[2],i[3]),1),u=s,h=r,f="prescale1",p,y;for(;o>2&&u>1||c>2&&h>1;){let b=u,A=h;o>2&&u>1&&(b=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),o/=u/b),c>2&&h>1&&(A=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,c/=h/A),p=this.cachedCanvases.getCanvas(f,b,A),y=p.context,y.clearRect(0,0,b,A),y.drawImage(t,0,0,u,h,0,0,b,A),t=p.canvas,u=b,h=A,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:h}}_createMaskCanvas(t,i){const s=this.ctx,{width:r,height:o}=i,c=this.current.fillColor,u=this.current.patternFill,h=$t(s);let f,p,y,b;if((i.bitmap||i.data)&&i.count>1){const et=i.bitmap||i.data.buffer;p=JSON.stringify(u?h:[h.slice(0,4),c]),f=this._cachedBitmapsMap.get(et),f||(f=new Map,this._cachedBitmapsMap.set(et,f));const W=f.get(p);if(W&&!u){const dt=Math.round(Math.min(h[0],h[2])+h[4]),_t=Math.round(Math.min(h[1],h[3])+h[5]);return this.dependencyTracker?.recordDependencies(t,hi.transformAndFill),{canvas:W,offsetX:dt,offsetY:_t}}y=W}y||(b=this.cachedCanvases.getCanvas("maskCanvas",r,o),Lp(b.context,i));let A=it.transform(h,[1/r,0,0,-1/o,0,0]);A=it.transform(A,[1,0,0,1,0,-o]);const _=Bs.slice();it.axialAlignedBoundingBox([0,0,r,o],A,_);const[S,x,E,D]=_,T=Math.round(E-S)||1,B=Math.round(D-x)||1,N=this.cachedCanvases.getCanvas("fillCanvas",T,B),k=N.context,z=S,K=x;k.translate(-z,-K),k.transform(...A),y||(y=this._scaleImage(b.canvas,Si(k)),y=y.img,f&&u&&f.set(p,y)),k.imageSmoothingEnabled=kp($t(k),i.interpolate),El(k,y,0,0,y.width,y.height,0,0,r,o),k.globalCompositeOperation="source-in";const Q=it.transform(Si(k),[1,0,0,1,-z,-K]);return k.fillStyle=u?c.getPattern(s,this,Q,xe.FILL,t):c,k.fillRect(0,0,r,o),f&&!u&&(this.cachedCanvases.delete("fillCanvas"),f.set(p,N.canvas)),this.dependencyTracker?.recordDependencies(t,hi.transformAndFill),{canvas:N.canvas,offsetX:Math.round(z),offsetY:Math.round(K)}}setLineWidth(t,i){this.dependencyTracker?.recordSimpleData("lineWidth",t),i!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=i,this.ctx.lineWidth=i}setLineCap(t,i){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=Lv[i]}setLineJoin(t,i){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=kv[i]}setMiterLimit(t,i){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=i}setDash(t,i,s){this.dependencyTracker?.recordSimpleData("dash",t);const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(i),r.lineDashOffset=s)}setRenderingIntent(t,i){}setFlatness(t,i){}setGState(t,i){for(const[s,r]of i)switch(s){case"LW":this.setLineWidth(t,r);break;case"LC":this.setLineCap(t,r);break;case"LJ":this.setLineJoin(t,r);break;case"ML":this.setMiterLimit(t,r);break;case"D":this.setDash(t,r[0],r[1]);break;case"RI":this.setRenderingIntent(t,r);break;case"FL":this.setFlatness(t,r);break;case"Font":this.setFont(t,r[0],r[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=r;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=r;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=r;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const i=this.ctx.canvas.width,s=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(r,i,s);this.suspendedCtx=this.ctx;const c=this.ctx=o.context;c.setTransform(this.suspendedCtx.getTransform()),Pa(this.suspendedCtx,c),Ov(c,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Pa(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const i=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,i,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,i,s,r){const o=r[0],c=r[1],u=r[2]-o,h=r[3]-c;u===0||h===0||(this.genericComposeSMask(i.context,s,u,h,i.subtype,i.backdrop,i.transferMap,o,c,i.offsetX,i.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(s.canvas,0,0),t.restore())}genericComposeSMask(t,i,s,r,o,c,u,h,f,p,y){let b=t.canvas,A=h-p,_=f-y;if(c)if(A<0||_<0||A+s>b.width||_+r>b.height){const x=this.cachedCanvases.getCanvas("maskExtension",s,r),E=x.context;E.drawImage(b,-A,-_),E.globalCompositeOperation="destination-atop",E.fillStyle=c,E.fillRect(0,0,s,r),E.globalCompositeOperation="source-over",b=x.canvas,A=_=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const x=new Path2D;x.rect(A,_,s,r),t.clip(x),t.globalCompositeOperation="destination-atop",t.fillStyle=c,t.fillRect(A,_,s,r),t.restore()}i.save(),i.globalAlpha=1,i.setTransform(1,0,0,1,0,0),o==="Alpha"&&u?i.filter=this.filterFactory.addAlphaFilter(u):o==="Luminosity"&&(i.filter=this.filterFactory.addLuminosityFilter(u));const S=new Path2D;S.rect(h,f,s,r),i.clip(S),i.globalCompositeOperation="destination-in",i.drawImage(b,A,_,s,r,h,f,s,r),i.restore()}save(t){this.inSMaskMode&&Pa(this.ctx,this.suspendedCtx),this.ctx.save();const i=this.current;this.stateStack.push(i),this.current=i.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Pa(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,i,s,r,o,c,u){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(i,s,r,o,c,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,i,s,r){let[o]=s;if(!r){o||=s[0]=new Path2D,this[i](t,o);return}if(this.dependencyTracker!==null){const c=i===Xa.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,r[0]-c,r[2]+c,r[1]-c,r[3]+c).recordDependencies(t,["transform"])}o instanceof Path2D||(o=s[0]=Qp(o)),it.axialAlignedBoundingBox(r,$t(this.ctx),this.current.minMax),this[i](t,o),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,i,s=!0){const r=this.ctx,o=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof o=="object"&&o?.getPattern){const c=o.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.strokeStyle=o.getPattern(r,this,Si(r),xe.STROKE,t),c){const u=new Path2D;u.addPath(i,r.getTransform().invertSelf().multiplySelf(c)),i=u}this.rescaleAndStroke(i,!1),r.restore()}else this.rescaleAndStroke(i,!0);this.dependencyTracker?.recordDependencies(t,hi.stroke),s&&this.consumePath(t,i,this.current.getClippedPathBoundingBox(xe.STROKE,$t(this.ctx))),r.globalAlpha=this.current.fillAlpha}closeStroke(t,i){this.stroke(t,i)}fill(t,i,s=!0){const r=this.ctx,o=this.current.fillColor,c=this.current.patternFill;let u=!1;if(c){const f=o.isModifyingCurrentTransform()?r.getTransform():null;if(this.dependencyTracker?.save(t),r.save(),r.fillStyle=o.getPattern(r,this,Si(r),xe.FILL,t),f){const p=new Path2D;p.addPath(i,r.getTransform().invertSelf().multiplySelf(f)),i=p}u=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(r.fill(i,"evenodd"),this.pendingEOFill=!1):r.fill(i)),this.dependencyTracker?.recordDependencies(t,hi.fill),u&&(r.restore(),this.dependencyTracker?.restore(t)),s&&this.consumePath(t,i,h)}eoFill(t,i){this.pendingEOFill=!0,this.fill(t,i)}fillStroke(t,i){this.fill(t,i,!1),this.stroke(t,i,!1),this.consumePath(t,i)}eoFillStroke(t,i){this.pendingEOFill=!0,this.fillStroke(t,i)}closeFillStroke(t,i){this.fillStroke(t,i)}closeEOFillStroke(t,i){this.pendingEOFill=!0,this.fillStroke(t,i)}endPath(t,i){this.consumePath(t,i)}rawFillPath(t,i){this.ctx.fill(i),this.dependencyTracker?.recordDependencies(t,hi.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=Bv}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=Bp}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const i=this.pendingTextPaths,s=this.ctx;if(this.dependencyTracker){const{dependencyTracker:r}=this;i!==void 0&&r.recordFutureForcedDependency("textClip",r.getOpenMarker()).recordFutureForcedDependency("textClip",t),r.recordCloseMarker(t)}if(i!==void 0){const r=new Path2D,o=s.getTransform().invertSelf();for(const{transform:c,x:u,y:h,fontSize:f,path:p}of i)p&&r.addPath(p,new DOMMatrix(c).preMultiplySelf(o).translate(u,h).scale(f,-f));s.clip(r)}delete this.pendingTextPaths}setCharSpacing(t,i){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=i}setWordSpacing(t,i){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=i}setHScale(t,i){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=i/100}setLeading(t,i){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-i}setFont(t,i,s){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",i,t);const r=this.commonObjs.get(i),o=this.current;if(!r)throw new Error(`Can't find font for ${i}`);if(o.fontMatrix=r.fontMatrix||vu,(o.fontMatrix[0]===0||o.fontMatrix[3]===0)&&pt("Invalid font matrix for font "+i),s<0?(s=-s,o.fontDirection=-1):o.fontDirection=1,this.current.font=r,this.current.fontSize=s,r.isType3Font)return;const c=r.loadedName||"sans-serif",u=r.systemFontInfo?.css||`"${c}", ${r.fallbackName}`;let h="normal";r.black?h="900":r.bold&&(h="bold");const f=r.italic?"italic":"normal";let p=s;s<Mp?p=Mp:s>Dp&&(p=Dp),this.current.fontSizeScale=s/p,this.ctx.font=`${f} ${h} ${p}px ${u}`}setTextRenderingMode(t,i){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=i}setTextRise(t,i){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=i}moveText(t,i,s){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=i,this.current.y=this.current.lineY+=s}setLeadingMoveText(t,i,s){this.setLeading(t,-s),this.moveText(t,i,s)}setTextMatrix(t,i){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",t);const{current:s}=this;s.textMatrix=i,s.textMatrixScale=Math.hypot(i[0],i[1]),s.x=s.lineX=0,s.y=s.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#n(t,i,s){const r=new Path2D;return r.addPath(t,new DOMMatrix(s).invertSelf().multiplySelf(i)),r}paintChar(t,i,s,r,o,c){const u=this.ctx,h=this.current,f=h.font,p=h.textRenderingMode,y=h.fontSize/h.fontSizeScale,b=p&he.FILL_STROKE_MASK,A=!!(p&he.ADD_TO_PATH_FLAG),_=h.patternFill&&!f.missingFile,S=h.patternStroke&&!f.missingFile;let x;if((f.disableFontFace||A||_||S)&&!f.missingFile&&(x=f.getPathGenerator(this.commonObjs,i)),x&&(f.disableFontFace||_||S)){u.save(),u.translate(s,r),u.scale(y,-y),this.dependencyTracker?.recordCharacterBBox(t,u,f);let E;if(b===he.FILL||b===he.FILL_STROKE)if(o){E=u.getTransform(),u.setTransform(...o);const D=this.#n(x,E,o);u.fill(D)}else u.fill(x);if(b===he.STROKE||b===he.FILL_STROKE)if(c){E||=u.getTransform(),u.setTransform(...c);const{a:D,b:T,c:B,d:N}=E,k=it.inverseTransform(c),z=it.transform([D,T,B,N,0,0],k);it.singularValueDecompose2dScale(z,Je),u.lineWidth*=Math.max(Je[0],Je[1])/y,u.stroke(this.#n(x,E,c))}else u.lineWidth/=y,u.stroke(x);u.restore()}else(b===he.FILL||b===he.FILL_STROKE)&&(u.fillText(i,s,r),this.dependencyTracker?.recordCharacterBBox(t,u,f,y,s,r,()=>u.measureText(i))),(b===he.STROKE||b===he.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,u,f,y,s,r,()=>u.measureText(i)).recordDependencies(t,hi.stroke),u.strokeText(i,s,r));A&&((this.pendingTextPaths||=[]).push({transform:$t(u),x:s,y:r,fontSize:y,path:x}),this.dependencyTracker?.recordCharacterBBox(t,u,f,y,s,r))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const i=t.getImageData(0,0,10,10).data;let s=!1;for(let r=3;r<i.length;r+=4)if(i[r]>0&&i[r]<255){s=!0;break}return mt(this,"isFontSubpixelAAEnabled",s)}showText(t,i){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,hi.showText).resetBBox(t),this.current.textRenderingMode&he.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const s=this.current,r=s.font;if(r.isType3Font){this.showType3Text(t,i),this.dependencyTracker?.recordShowTextOperation(t);return}const o=s.fontSize;if(o===0){this.dependencyTracker?.recordOperation(t);return}const c=this.ctx,u=s.fontSizeScale,h=s.charSpacing,f=s.wordSpacing,p=s.fontDirection,y=s.textHScale*p,b=i.length,A=r.vertical,_=A?1:-1,S=r.defaultVMetrics,x=o*s.fontMatrix[0],E=s.textRenderingMode===he.FILL&&!r.disableFontFace&&!s.patternFill;c.save(),s.textMatrix&&c.transform(...s.textMatrix),c.translate(s.x,s.y+s.textRise),p>0?c.scale(y,-1):c.scale(y,1);let D,T;const B=s.textRenderingMode&he.FILL_STROKE_MASK,N=B===he.FILL||B===he.FILL_STROKE,k=B===he.STROKE||B===he.FILL_STROKE;if(N&&s.patternFill){c.save();const W=s.fillColor.getPattern(c,this,Si(c),xe.FILL,t);D=$t(c),c.restore(),c.fillStyle=W}if(k&&s.patternStroke){c.save();const W=s.strokeColor.getPattern(c,this,Si(c),xe.STROKE,t);T=$t(c),c.restore(),c.strokeStyle=W}let z=s.lineWidth;const K=s.textMatrixScale;if(K===0||z===0?k&&(z=this.getSinglePixelWidth()):z/=K,u!==1&&(c.scale(u,u),z/=u),c.lineWidth=z,r.isInvalidPDFjsFont){const W=[];let dt=0;for(const ft of i)W.push(ft.unicode),dt+=ft.width;const _t=W.join("");if(c.fillText(_t,0,0),this.dependencyTracker!==null){const ft=c.measureText(_t);this.dependencyTracker.recordBBox(t,this.ctx,-ft.actualBoundingBoxLeft,ft.actualBoundingBoxRight,-ft.actualBoundingBoxAscent,ft.actualBoundingBoxDescent).recordShowTextOperation(t)}s.x+=dt*x*y,c.restore(),this.compose();return}let Q=0,et;for(et=0;et<b;++et){const W=i[et];if(typeof W=="number"){Q+=_*W*o/1e3;continue}let dt=!1;const _t=(W.isSpace?f:0)+h,ft=W.fontChar,xt=W.accent;let O,G,J=W.width;if(A){const C=W.vmetric||S,F=-(W.vmetric?C[1]:J*.5)*x,Y=C[2]*x;J=C?-C[0]:J,O=F/u,G=(Q+Y)/u}else O=Q/u,G=0;let $;if(r.remeasure&&J>0){$=c.measureText(ft);const C=$.width*1e3/o*u;if(J<C&&this.isFontSubpixelAAEnabled){const F=J/C;dt=!0,c.save(),c.scale(F,1),O/=F}else J!==C&&(O+=(J-C)/2e3*o/u)}if(this.contentVisible&&(W.isInFont||r.missingFile)){if(E&&!xt)c.fillText(ft,O,G),this.dependencyTracker?.recordCharacterBBox(t,c,$?{bbox:null}:r,o/u,O,G,()=>$??c.measureText(ft));else if(this.paintChar(t,ft,O,G,D,T),xt){const C=O+o*xt.offset.x/u,F=G-o*xt.offset.y/u;this.paintChar(t,xt.fontChar,C,F,D,T)}}const st=A?J*x-_t*p:J*x+_t*p;Q+=st,dt&&c.restore()}A?s.y-=Q:s.x+=Q*y,c.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,i){const s=this.ctx,r=this.current,o=r.font,c=r.fontSize,u=r.fontDirection,h=o.vertical?1:-1,f=r.charSpacing,p=r.wordSpacing,y=r.textHScale*u,b=r.fontMatrix||vu,A=i.length,_=r.textRenderingMode===he.INVISIBLE;let S,x,E,D;if(_||c===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),r.textMatrix&&s.transform(...r.textMatrix),s.translate(r.x,r.y+r.textRise),s.scale(y,u);const T=this.dependencyTracker;for(this.dependencyTracker=T?new Rl(T,t):null,S=0;S<A;++S){if(x=i[S],typeof x=="number"){D=h*x*c/1e3,this.ctx.translate(D,0),r.x+=D*y;continue}const B=(x.isSpace?p:0)+f,N=o.charProcOperatorList[x.operatorListId];N?this.contentVisible&&(this.save(),s.scale(c,c),s.transform(...b),this.executeOperatorList(N),this.restore()):pt(`Type3 character "${x.operatorListId}" is not available.`);const k=[x.width,0];it.applyTransform(k,b),E=k[0]*c+B,s.translate(E,0),r.x+=E*y}s.restore(),T&&(this.dependencyTracker=T)}setCharWidth(t,i,s){}setCharWidthAndBounds(t,i,s,r,o,c,u){const h=new Path2D;h.rect(r,o,c-r,u-o),this.ctx.clip(h),this.dependencyTracker?.recordBBox(t,this.ctx,r,c,o,u).recordClipBox(t,this.ctx,r,c,o,u),this.endPath(t)}getColorN_Pattern(t,i){let s;if(i[0]==="TilingPattern"){const r=this.baseTransform||$t(this.ctx),o={createCanvasGraphics:(c,u)=>new Us(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Rl(this.dependencyTracker,u,!0):null)};s=new Hu(i,this.ctx,o,r)}else s=this._getPattern(t,i[1],i[2]);return s}setStrokeColorN(t,...i){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,i),this.current.patternStroke=!0}setFillColorN(t,...i){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,i),this.current.patternFill=!0}setStrokeRGBColor(t,i){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=i,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,i){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=i,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,i,s=null){let r;return this.cachedPatterns.has(i)?r=this.cachedPatterns.get(i):(r=Mv(this.getObject(t,i)),this.cachedPatterns.set(i,r)),s&&(r.matrix=s),r}shadingFill(t,i){if(!this.contentVisible)return;const s=this.ctx;this.save(t);const r=this._getPattern(t,i);s.fillStyle=r.getPattern(s,this,Si(s),xe.SHADING,t);const o=Si(s);if(o){const{width:c,height:u}=s.canvas,h=Bs.slice();it.axialAlignedBoundingBox([0,0,c,u],o,h);const[f,p,y,b]=h;this.ctx.fillRect(f,p,y-f,b-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,hi.transform).recordDependencies(t,hi.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){Gt("Should not call beginInlineImage")}beginImageData(){Gt("Should not call beginImageData")}paintFormXObjectBegin(t,i,s){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),i&&this.transform(t,...i),this.baseTransform=$t(this.ctx),s)){it.axialAlignedBoundingBox(s,this.baseTransform,this.current.minMax);const[r,o,c,u]=s,h=new Path2D;h.rect(r,o,c-r,u-o),this.ctx.clip(h),this.dependencyTracker?.recordClipBox(t,this.ctx,r,c,o,u),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,i){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;i.isolated||kl("TODO: Support non-isolated groups."),i.knockout&&pt("Knockout groups not supported.");const r=$t(s);if(i.matrix&&s.transform(...i.matrix),!i.bbox)throw new Error("Bounding box is required.");let o=Bs.slice();it.axialAlignedBoundingBox(i.bbox,$t(s),o);const c=[0,0,s.canvas.width,s.canvas.height];o=it.intersect(o,c)||[0,0,0,0];const u=Math.floor(o[0]),h=Math.floor(o[1]),f=Math.max(Math.ceil(o[2])-u,1),p=Math.max(Math.ceil(o[3])-h,1);this.current.startNewPathAndClipBox([0,0,f,p]);let y="groupAt"+this.groupLevel;i.smask&&(y+="_smask_"+this.smaskCounter++%2);const b=this.cachedCanvases.getCanvas(y,f,p),A=b.context;A.translate(-u,-h),A.transform(...r);let _=new Path2D;const[S,x,E,D]=i.bbox;if(_.rect(S,x,E-S,D-x),i.matrix){const T=new Path2D;T.addPath(_,new DOMMatrix(i.matrix)),_=T}A.clip(_),i.smask&&this.smaskStack.push({canvas:b.canvas,context:A,offsetX:u,offsetY:h,subtype:i.smask.subtype,backdrop:i.smask.backdrop,transferMap:i.smask.transferMap||null,startTransformInverse:null}),(!i.smask||this.dependencyTracker)&&(s.setTransform(1,0,0,1,0,0),s.translate(u,h),s.save()),Pa(s,A),this.ctx=A,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(s),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(t,i){if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),i.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const o=$t(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...o);const c=Bs.slice();it.axialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],o,c),this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(c)}}beginAnnotation(t,i,s,r,o,c){if(this.#t(),xl(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const u=s[2]-s[0],h=s[3]-s[1];if(c&&this.annotationCanvasMap){r=r.slice(),r[4]-=s[0],r[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=u,s[3]=h,it.singularValueDecompose2dScale($t(this.ctx),Je);const{viewportScale:f}=this,p=Math.ceil(u*this.outputScaleX*f),y=Math.ceil(h*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(p,y);const{canvas:b,context:A}=this.annotationCanvas;this.annotationCanvasMap.set(i,b),this.annotationCanvas.savedCtx=this.ctx,this.ctx=A,this.ctx.save(),this.ctx.setTransform(Je[0],0,0,-Je[1],0,h*Je[1]),xl(this.ctx)}else{xl(this.ctx),this.endPath(t);const f=new Path2D;f.rect(s[0],s[1],u,h),this.ctx.clip(f)}}this.current=new Op(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...r),this.transform(t,...o)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,i){if(!this.contentVisible)return;const s=i.count;i=this.getObject(t,i.data,i),i.count=s;const r=this.ctx,o=this._createMaskCanvas(t,i),c=o.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(c,o.offsetX,o.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,o.offsetX,o.offsetX+c.width,o.offsetY,o.offsetY+c.height).recordOperation(t),r.restore(),this.compose()}paintImageMaskXObjectRepeat(t,i,s,r=0,o=0,c,u){if(!this.contentVisible)return;i=this.getObject(t,i.data,i);const h=this.ctx;h.save();const f=$t(h);h.transform(s,r,o,c,0,0);const p=this._createMaskCanvas(t,i);h.setTransform(1,0,0,1,p.offsetX-f[4],p.offsetY-f[5]),this.dependencyTracker?.resetBBox(t);for(let y=0,b=u.length;y<b;y+=2){const A=it.transform(f,[s,r,o,c,u[y],u[y+1]]);h.drawImage(p.canvas,A[4],A[5]),this.dependencyTracker?.recordBBox(t,this.ctx,A[4],A[4]+p.canvas.width,A[5],A[5]+p.canvas.height)}h.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,i){if(!this.contentVisible)return;const s=this.ctx,r=this.current.fillColor,o=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,hi.transformAndFill);for(const c of i){const{data:u,width:h,height:f,transform:p}=c,y=this.cachedCanvases.getCanvas("maskCanvas",h,f),b=y.context;b.save();const A=this.getObject(t,u,c);Lp(b,A),b.globalCompositeOperation="source-in",b.fillStyle=o?r.getPattern(b,this,Si(s),xe.FILL,t):r,b.fillRect(0,0,h,f),b.restore(),s.save(),s.transform(...p),s.scale(1,-1),El(s,y.canvas,0,0,h,f,0,-1,1,1),this.dependencyTracker?.recordBBox(t,s,0,h,0,f),s.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,i){if(!this.contentVisible)return;const s=this.getObject(t,i);if(!s){pt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,s)}paintImageXObjectRepeat(t,i,s,r,o){if(!this.contentVisible)return;const c=this.getObject(t,i);if(!c){pt("Dependent image isn't ready yet");return}const u=c.width,h=c.height,f=[];for(let p=0,y=o.length;p<y;p+=2)f.push({transform:[s,0,0,r,o[p],o[p+1]],x:0,y:0,w:u,h});this.paintInlineImageXObjectGroup(t,c,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:i,width:s,height:r}=t,o=this.cachedCanvases.getCanvas("inlineImage",s,r),c=o.context;return c.filter=this.current.transferMaps,c.drawImage(i,0,0),c.filter="none",o.canvas}paintInlineImageXObject(t,i){if(!this.contentVisible)return;const s=i.width,r=i.height,o=this.ctx;this.save(t);const{filter:c}=o;c!=="none"&&c!==""&&(o.filter="none"),o.scale(1/s,-1/r);let u;if(i.bitmap)u=this.applyTransferMapsToBitmap(i);else if(typeof HTMLElement=="function"&&i instanceof HTMLElement||!i.data)u=i;else{const p=this.cachedCanvases.getCanvas("inlineImage",s,r).context;Np(p,i),u=this.applyTransferMapsToCanvas(p)}const h=this._scaleImage(u,Si(o));o.imageSmoothingEnabled=kp($t(o),i.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,o,0,s,-r,0).recordDependencies(t,hi.imageXObject).recordOperation(t),El(o,h.img,0,0,h.paintWidth,h.paintHeight,0,-r,s,r),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,i,s){if(!this.contentVisible)return;const r=this.ctx;let o;if(i.bitmap)o=i.bitmap;else{const c=i.width,u=i.height,f=this.cachedCanvases.getCanvas("inlineImage",c,u).context;Np(f,i),o=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(t);for(const c of s)r.save(),r.transform(...c.transform),r.scale(1,-1),El(r,o,c.x,c.y,c.w,c.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,r,0,1,-1,0),r.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,hi.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,i){}markPointProps(t,i,s){}beginMarkedContent(t,i){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,i,s){this.dependencyTracker?.beginMarkedContent(t),i==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,i,s){const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const o=this.ctx;this.pendingClip?(r||(this.pendingClip===Bp?o.clip(i,"evenodd"):o.clip(i)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=$t(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const i=Math.abs(t[0]*t[3]-t[2]*t[1]),s=Math.hypot(t[0],t[2]),r=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(s,r)/i}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:i,b:s,c:r,d:o}=this.ctx.getTransform();let c,u;if(s===0&&r===0){const h=Math.abs(i),f=Math.abs(o);if(h===f)if(t===0)c=u=1/h;else{const p=h*t;c=u=p<1?1/p:1}else if(t===0)c=1/h,u=1/f;else{const p=h*t,y=f*t;c=p<1?1/p:1,u=y<1?1/y:1}}else{const h=Math.abs(i*o-s*r),f=Math.hypot(i,s),p=Math.hypot(r,o);if(t===0)c=p/h,u=f/h;else{const y=t*h;c=p>y?p/y:1,u=f>y?f/y:1}}this._cachedScaleForStroking[0]=c,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,i){const{ctx:s,current:{lineWidth:r}}=this,[o,c]=this.getScaleForStroking();if(o===c){s.lineWidth=(r||1)*o,s.stroke(t);return}const u=s.getLineDash();i&&s.save(),s.scale(o,c),pu.a=1/o,pu.d=1/c;const h=new Path2D;if(h.addPath(t,pu),u.length>0){const f=Math.max(o,c);s.setLineDash(u.map(p=>p/f)),s.lineDashOffset/=f}s.lineWidth=r||1,s.stroke(h),i&&s.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const m in Xa)Us.prototype[m]!==void 0&&(Us.prototype[Xa[m]]=Us.prototype[m]);class Is{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class zv{#t;#e;constructor({parsedData:t,rawData:i}){this.#t=t,this.#e=i}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const Ns=Symbol("INTERNAL");class Pv{#t=!1;#e=!1;#n=!1;#i=!0;constructor(t,{name:i,intent:s,usage:r,rbGroups:o}){this.#t=!!(t&Ze.DISPLAY),this.#e=!!(t&Ze.PRINT),this.name=i,this.intent=s,this.usage=r,this.rbGroups=o}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;const{print:t,view:i}=this.usage;return this.#t?i?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,i,s=!1){t!==Ns&&Gt("Internal method `_setVisible` called."),this.#n=s,this.#i=i}}class Fv{#t=null;#e=new Map;#n=null;#i=null;constructor(t,i=Ze.DISPLAY){if(this.renderingIntent=i,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#i=t.order;for(const s of t.groups)this.#e.set(s.id,new Pv(i,s));if(t.baseState==="OFF")for(const s of this.#e.values())s._setVisible(Ns,!1);for(const s of t.on)this.#e.get(s)._setVisible(Ns,!0);for(const s of t.off)this.#e.get(s)._setVisible(Ns,!1);this.#n=this.getHash()}}#r(t){const i=t.length;if(i<2)return!0;const s=t[0];for(let r=1;r<i;r++){const o=t[r];let c;if(Array.isArray(o))c=this.#r(o);else if(this.#e.has(o))c=this.#e.get(o).visible;else return pt(`Optional content group not found: ${o}`),!0;switch(s){case"And":if(!c)return!1;break;case"Or":if(c)return!0;break;case"Not":return!c;default:return!0}}return s==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return kl("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(pt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#r(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const i of t.ids){if(!this.#e.has(i))return pt(`Optional content group not found: ${i}`),!0;if(this.#e.get(i).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const i of t.ids){if(!this.#e.has(i))return pt(`Optional content group not found: ${i}`),!0;if(!this.#e.get(i).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const i of t.ids){if(!this.#e.has(i))return pt(`Optional content group not found: ${i}`),!0;if(!this.#e.get(i).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const i of t.ids){if(!this.#e.has(i))return pt(`Optional content group not found: ${i}`),!0;if(this.#e.get(i).visible)return!1}return!0}return pt(`Unknown optional content policy ${t.policy}.`),!0}return pt(`Unknown group type ${t.type}.`),!0}setVisibility(t,i=!0,s=!0){const r=this.#e.get(t);if(!r){pt(`Optional content group not found: ${t}`);return}if(s&&i&&r.rbGroups.length)for(const o of r.rbGroups)for(const c of o)c!==t&&this.#e.get(c)?._setVisible(Ns,!1,!0);r._setVisible(Ns,!!i,!0),this.#t=null}setOCGState({state:t,preserveRB:i}){let s;for(const r of t){switch(r){case"ON":case"OFF":case"Toggle":s=r;continue}const o=this.#e.get(r);if(o)switch(s){case"ON":this.setVisibility(r,!0,i);break;case"OFF":this.setVisibility(r,!1,i);break;case"Toggle":this.setVisibility(r,!o.visible,i);break}}this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new Wp;for(const[i,s]of this.#e)t.update(`${i}:${s.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class Uv{constructor(t,{disableRange:i=!1,disableStream:s=!1}){Mt(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:o,progressiveDone:c,contentDispositionFilename:u}=t;if(this._queuedChunks=[],this._progressiveDone=c,this._contentDispositionFilename=u,o?.length>0){const h=o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength?o.buffer:new Uint8Array(o).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!s,this._isRangeSupported=!i,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,f)=>{this._onReceiveData({begin:h,chunk:f})}),t.addProgressListener((h,f)=>{this._onProgress({loaded:h,total:f})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:i}){const s=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const r=this._rangeReaders.some(function(o){return o._begin!==t?!1:(o._enqueue(s),!0)});Mt(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const i=this._rangeReaders.indexOf(t);i>=0&&this._rangeReaders.splice(i,1)}getFullReader(){Mt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new Iv(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new Hv(this,t,i);return this._pdfDataRangeTransport.requestDataRange(t,i),this._rangeReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeReaders.slice(0))i.cancel(t);this._pdfDataRangeTransport.abort()}}class Iv{constructor(t,i,s=!1,r=null){this._stream=t,this._done=s||!1,this._filename=Bu(r)?r:null,this._queuedChunks=i||[],this._loaded=0;for(const o of this._queuedChunks)this._loaded+=o.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Hv{constructor(t,i,s){this._stream=t,this._begin=i,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function jv(m){let t=!0,i=s("filename\\*","i").exec(m);if(i){i=i[1];let p=u(i);return p=unescape(p),p=h(p),p=f(p),o(p)}if(i=c(m),i){const p=f(i);return o(p)}if(i=s("filename","i").exec(m),i){i=i[1];let p=u(i);return p=f(p),o(p)}function s(p,y){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',y)}function r(p,y){if(p){if(!/^[\x00-\xFF]+$/.test(y))return y;try{const b=new TextDecoder(p,{fatal:!0}),A=$a(y);y=b.decode(A),t=!1}catch{}}return y}function o(p){return t&&/[\x80-\xff]/.test(p)&&(p=r("utf-8",p),t&&(p=r("iso-8859-1",p))),p}function c(p){const y=[];let b;const A=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(b=A.exec(p))!==null;){let[,S,x,E]=b;if(S=parseInt(S,10),S in y){if(S===0)break;continue}y[S]=[x,E]}const _=[];for(let S=0;S<y.length&&S in y;++S){let[x,E]=y[S];E=u(E),x&&(E=unescape(E),S===0&&(E=h(E))),_.push(E)}return _.join("")}function u(p){if(p.startsWith('"')){const y=p.slice(1).split('\\"');for(let b=0;b<y.length;++b){const A=y[b].indexOf('"');A!==-1&&(y[b]=y[b].slice(0,A),y.length=b+1),y[b]=y[b].replaceAll(/\\(.)/g,"$1")}p=y.join('"')}return p}function h(p){const y=p.indexOf("'");if(y===-1)return p;const b=p.slice(0,y),_=p.slice(y+1).replace(/^[^']*'/,"");return r(b,_)}function f(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(y,b,A,_){if(A==="q"||A==="Q")return _=_.replaceAll("_"," "),_=_.replaceAll(/=([0-9a-fA-F]{2})/g,function(S,x){return String.fromCharCode(parseInt(x,16))}),r(b,_);try{_=atob(_)}catch{}return r(b,_)})}return""}function am(m,t){const i=new Headers;if(!m||!t||typeof t!="object")return i;for(const s in t){const r=t[s];r!==void 0&&i.append(s,r)}return i}function Pl(m){return URL.parse(m)?.origin??null}function rm({responseHeaders:m,isHttp:t,rangeChunkSize:i,disableRange:s}){const r={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(m.get("Content-Length"),10);return!Number.isInteger(o)||(r.suggestedLength=o,o<=2*i)||s||!t||m.get("Accept-Ranges")!=="bytes"||(m.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function lm(m){const t=m.get("Content-Disposition");if(t){let i=jv(t);if(i.includes("%"))try{i=decodeURIComponent(i)}catch{}if(Bu(i))return i}return null}function tr(m,t){return new Dl(`Unexpected server response (${m}) while retrieving PDF "${t}".`,m,m===404||m===0&&t.startsWith("file:"))}function om(m){return m===200||m===206}function cm(m,t,i){return{method:"GET",headers:m,signal:i.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function um(m){return m instanceof Uint8Array?m.buffer:m instanceof ArrayBuffer?m:(pt(`getArrayBuffer - unexpected data format: ${m}`),new Uint8Array(m).buffer)}class Gv{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=am(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Mt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new qv(this),this._fullRequestReader}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new Vv(this,t,i);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class qv{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const i=t.source;this._withCredentials=i.withCredentials||!1,this._contentLength=i.length,this._headersCapability=Promise.withResolvers(),this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange;const s=new Headers(t.headers),r=i.url;fetch(r,cm(s,this._withCredentials,this._abortController)).then(o=>{if(t._responseOrigin=Pl(o.url),!om(o.status))throw tr(o.status,r);this._reader=o.body.getReader(),this._headersCapability.resolve();const c=o.headers,{allowRangeRequests:u,suggestedLength:h}=rm({responseHeaders:c,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=h||this._contentLength,this._filename=lm(c),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new An("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:um(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class Vv{constructor(t,i,s){this._stream=t,this._reader=null,this._loaded=0;const r=t.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const o=new Headers(t.headers);o.append("Range",`bytes=${i}-${s-1}`);const c=r.url;fetch(c,cm(o,this._withCredentials,this._abortController)).then(u=>{const h=Pl(u.url);if(h!==t._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${t._responseOrigin}".`);if(!om(u.status))throw tr(u.status,c);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:um(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const mu=200,yu=206;function Xv(m){const t=m.response;return typeof t!="string"?t:$a(t).buffer}class Yv{_responseOrigin=null;constructor({url:t,httpHeaders:i,withCredentials:s}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=am(this.isHttp,i),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const i=new XMLHttpRequest,s=this.currXhrId++,r=this.pendingRequests[s]={xhr:i};i.open("GET",this.url),i.withCredentials=this.withCredentials;for(const[o,c]of this.headers)i.setRequestHeader(o,c);return this.isHttp&&"begin"in t&&"end"in t?(i.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),r.expectedStatus=yu):r.expectedStatus=mu,i.responseType="arraybuffer",Mt(t.onError,"Expected `onError` callback to be provided."),i.onerror=()=>{t.onError(i.status)},i.onreadystatechange=this.onStateChange.bind(this,s),i.onprogress=this.onProgress.bind(this,s),r.onHeadersReceived=t.onHeadersReceived,r.onDone=t.onDone,r.onError=t.onError,r.onProgress=t.onProgress,i.send(null),s}onProgress(t,i){const s=this.pendingRequests[t];s&&s.onProgress?.(i)}onStateChange(t,i){const s=this.pendingRequests[t];if(!s)return;const r=s.xhr;if(r.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),r.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],r.status===0&&this.isHttp){s.onError(r.status);return}const o=r.status||mu;if(!(o===mu&&s.expectedStatus===yu)&&o!==s.expectedStatus){s.onError(r.status);return}const u=Xv(r);if(o===yu){const h=r.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);f?s.onDone({begin:parseInt(f[1],10),chunk:u}):(pt('Missing or invalid "Content-Range" header.'),s.onError(0))}else u?s.onDone({begin:0,chunk:u}):s.onError(r.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const i=this.pendingRequests[t].xhr;delete this.pendingRequests[t],i.abort()}}class Kv{constructor(t){this._source=t,this._manager=new Yv(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const i=this._rangeRequestReaders.indexOf(t);i>=0&&this._rangeRequestReaders.splice(i,1)}getFullReader(){return Mt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new $v(this._manager,this._source),this._fullRequestReader}getRangeReader(t,i){const s=new Qv(this._manager,t,i);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class $v{constructor(t,i){this._manager=t,this._url=i.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=i.disableRange||!1,this._contentLength=i.length,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,i=this._manager.getRequestXhr(t);this._manager._responseOrigin=Pl(i.responseURL);const s=i.getAllResponseHeaders(),r=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(u=>{const[h,...f]=u.split(": ");return[h,f.join(": ")]}):[]),{allowRangeRequests:o,suggestedLength:c}=rm({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});o&&(this._isRangeSupported=!0),this._contentLength=c||this._contentLength,this._filename=lm(r),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=tr(t,this._url),this._headersCapability.reject(this._storedError);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class Qv{constructor(t,i,s){this._manager=t,this._url=t.url,this._requestId=t.request({begin:i,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=Pl(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const i=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:i,done:!1}):this._queuedChunk=i,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=tr(t,this._url);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Zv=/^[a-z][a-z0-9\-+.]+:/i;function Wv(m){if(Zv.test(m))return new URL(m);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(m))}class Jv{constructor(t){this.source=t,this.url=Wv(t.url),Mt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Mt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new tA(this),this._fullRequestReader}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new eA(this,t,i);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class tA{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const i=t.source;this._contentLength=i.length,this._loaded=0,this._filename=null,this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=tr(0,this._url.href)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",i=>{this._error(i)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new An("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class eA{constructor(t,i,s){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=t.source;this._isStreamingSupported=!r.disableStream;const o=process.getBuiltinModule("fs");this._setReadableStream(o.createReadStream(this._url,{start:i,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",i=>{this._error(i)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Fa=Symbol("INITIAL_DATA");class hm{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:Fa}}get(t,i=null){if(i){const r=this.#e(t);return r.promise.then(()=>i(r.data)),null}const s=this.#t[t];if(!s||s.data===Fa)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return s.data}has(t){const i=this.#t[t];return!!i&&i.data!==Fa}delete(t){const i=this.#t[t];return!i||i.data===Fa?!1:(delete this.#t[t],!0)}resolve(t,i=null){const s=this.#e(t);s.data=i,s.resolve()}clear(){for(const t in this.#t){const{data:i}=this.#t[t];i?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:i}=this.#t[t];i!==Fa&&(yield[t,i])}}}const iA=1e5,zp=30;class We{#t=Promise.withResolvers();#e=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#r=null;#a=null;#s=0;#l=0;#c=null;#o=null;#d=0;#h=0;#f=Object.create(null);#m=[];#p=null;#u=[];#g=new WeakMap;#y=null;static#v=new Map;static#b=new Map;static#x=new WeakMap;static#w=null;static#S=new Set;constructor({textContentSource:t,container:i,viewport:s}){if(t instanceof ReadableStream)this.#p=t;else if(typeof t=="object")this.#p=new ReadableStream({start(h){h.enqueue(t),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#o=i,this.#h=s.scale*xi.pixelRatio,this.#d=s.rotation,this.#a={div:null,properties:null,ctx:null};const{pageWidth:r,pageHeight:o,pageX:c,pageY:u}=s.rawDims;this.#y=[1,0,0,-1,-c,u+o],this.#l=r,this.#s=o,We.#D(),i.style.setProperty("--min-font-size",We.#w),jn(i,s),this.#t.promise.finally(()=>{We.#S.delete(this),this.#a=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:i}=de.platform;return mt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&i?"Calibri, ":""}sans-serif`],["monospace",`${t&&i?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:i,done:s})=>{if(s){this.#t.resolve();return}this.#r??=i.lang,Object.assign(this.#f,i.styles),this.#C(i.items),t()},this.#t.reject)};return this.#c=this.#p.getReader(),We.#S.add(this),t(),this.#t.promise}update({viewport:t,onBefore:i=null}){const s=t.scale*xi.pixelRatio,r=t.rotation;if(r!==this.#d&&(i?.(),this.#d=r,jn(this.#o,{rotation:r})),s!==this.#h){i?.(),this.#h=s;const o={div:null,properties:null,ctx:We.#R(this.#r)};for(const c of this.#u)o.properties=this.#g.get(c),o.div=c,this.#E(o)}}cancel(){const t=new An("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#m}#C(t){if(this.#n)return;this.#a.ctx??=We.#R(this.#r);const i=this.#u,s=this.#m;for(const r of t){if(i.length>iA){pt("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const o=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),r.id&&this.#e.setAttribute("id",`${r.id}`),o.append(this.#e)}else r.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}s.push(r.str),this.#A(r)}}#A(t){const i=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#u.push(i);const r=it.transform(this.#y,t.transform);let o=Math.atan2(r[1],r[0]);const c=this.#f[t.fontName];c.vertical&&(o+=Math.PI/2);let u=this.#i&&c.fontSubstitution||c.fontFamily;u=We.fontFamilyMap.get(u)||u;const h=Math.hypot(r[2],r[3]),f=h*We.#P(u,c,this.#r);let p,y;o===0?(p=r[4],y=r[5]-f):(p=r[4]+f*Math.sin(o),y=r[5]-f*Math.cos(o));const b=i.style;b.left=`${(100*p/this.#l).toFixed(2)}%`,b.top=`${(100*y/this.#s).toFixed(2)}%`,b.setProperty("--font-height",`${h.toFixed(2)}px`),b.fontFamily=u,s.fontSize=h,i.setAttribute("role","presentation"),i.textContent=t.str,i.dir=t.dir,this.#i&&(i.dataset.fontName=c.fontSubstitutionLoadedName||t.fontName),o!==0&&(s.angle=o*(180/Math.PI));let A=!1;if(t.str.length>1)A=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const _=Math.abs(t.transform[0]),S=Math.abs(t.transform[3]);_!==S&&Math.max(_,S)/Math.min(_,S)>1.5&&(A=!0)}if(A&&(s.canvasWidth=c.vertical?t.height:t.width),this.#g.set(i,s),this.#a.div=i,this.#a.properties=s,this.#E(this.#a),s.hasText&&this.#e.append(i),s.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),this.#e.append(_)}}#E(t){const{div:i,properties:s,ctx:r}=t,{style:o}=i;if(s.canvasWidth!==0&&s.hasText){const{fontFamily:c}=o,{canvasWidth:u,fontSize:h}=s;We.#M(r,h*this.#h,c);const{width:f}=r.measureText(i.textContent);f>0&&o.setProperty("--scale-x",u*this.#h/f)}s.angle!==0&&o.setProperty("--rotate",`${s.angle}deg`)}static cleanup(){if(!(this.#S.size>0)){this.#v.clear();for(const{canvas:t}of this.#b.values())t.remove();this.#b.clear()}}static#R(t=null){let i=this.#b.get(t||="");if(!i){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=t,document.body.append(s),i=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#b.set(t,i),this.#x.set(i,{size:0,family:""})}return i}static#M(t,i,s){const r=this.#x.get(t);i===r.size&&s===r.family||(t.font=`${i}px ${s}`,r.size=i,r.family=s)}static#D(){if(this.#w!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#w=t.getBoundingClientRect().height,t.remove()}static#P(t,i,s){const r=this.#v.get(t);if(r)return r;const o=this.#R(s);o.canvas.width=o.canvas.height=zp,this.#M(o,zp,t);const c=o.measureText(""),u=c.fontBoundingBoxAscent,h=Math.abs(c.fontBoundingBoxDescent);o.canvas.width=o.canvas.height=0;let f=.8;return u?f=u/(u+h):(de.platform.isFirefox&&pt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),i.ascent?f=i.ascent:i.descent&&(f=1+i.descent)),this.#v.set(t,f),f}}const nA=100;function dm(m={}){typeof m=="string"||m instanceof URL?m={url:m}:(m instanceof ArrayBuffer||ArrayBuffer.isView(m))&&(m={data:m});const t=new ju,{docId:i}=t,s=m.url?uv(m.url):null,r=m.data?hv(m.data):null,o=m.httpHeaders||null,c=m.withCredentials===!0,u=m.password??null,h=m.range instanceof fm?m.range:null,f=Number.isInteger(m.rangeChunkSize)&&m.rangeChunkSize>0?m.rangeChunkSize:2**16;let p=m.worker instanceof Ee?m.worker:null;const y=m.verbosity,b=typeof m.docBaseUrl=="string"&&!Bl(m.docBaseUrl)?m.docBaseUrl:null,A=Al(m.cMapUrl),_=m.cMapPacked!==!1,S=m.CMapReaderFactory||(Re?vv:_p),x=Al(m.iccUrl),E=Al(m.standardFontDataUrl),D=m.StandardFontDataFactory||(Re?Av:wp),T=Al(m.wasmUrl),B=m.WasmFactory||(Re?Sv:Ep),N=m.stopAtErrors!==!0,k=Number.isInteger(m.maxImageSize)&&m.maxImageSize>-1?m.maxImageSize:-1,z=m.isEvalSupported!==!1,K=typeof m.isOffscreenCanvasSupported=="boolean"?m.isOffscreenCanvasSupported:!Re,Q=typeof m.isImageDecoderSupported=="boolean"?m.isImageDecoderSupported:!Re&&(de.platform.isFirefox||!globalThis.chrome),et=Number.isInteger(m.canvasMaxAreaInBytes)?m.canvasMaxAreaInBytes:-1,W=typeof m.disableFontFace=="boolean"?m.disableFontFace:Re,dt=m.fontExtraProperties===!0,_t=m.enableXfa===!0,ft=m.ownerDocument||globalThis.document,xt=m.disableRange===!0,O=m.disableStream===!0,G=m.disableAutoFetch===!0,J=m.pdfBug===!0,$=m.CanvasFactory||(Re?bv:pv),st=m.FilterFactory||(Re?yv:mv),C=m.enableHWA===!0,F=m.useWasm!==!1,Y=h?h.length:m.length??NaN,tt=typeof m.useSystemFonts=="boolean"?m.useSystemFonts:!Re&&!W,Z=typeof m.useWorkerFetch=="boolean"?m.useWorkerFetch:!!(S===_p&&D===wp&&B===Ep&&A&&E&&T&&Ha(A,document.baseURI)&&Ha(E,document.baseURI)&&Ha(T,document.baseURI)),lt=null;Pb(y);const ut={canvasFactory:new $({ownerDocument:ft,enableHWA:C}),filterFactory:new st({docId:i,ownerDocument:ft}),cMapReaderFactory:Z?null:new S({baseUrl:A,isCompressed:_}),standardFontDataFactory:Z?null:new D({baseUrl:E}),wasmFactory:Z?null:new B({baseUrl:T})};p||(p=Ee.create({verbosity:y,port:Is.workerPort}),t._worker=p);const Kt={docId:i,apiVersion:"5.4.530",data:r,password:u,disableAutoFetch:G,rangeChunkSize:f,length:Y,docBaseUrl:b,enableXfa:_t,evaluatorOptions:{maxImageSize:k,disableFontFace:W,ignoreErrors:N,isEvalSupported:z,isOffscreenCanvasSupported:K,isImageDecoderSupported:Q,canvasMaxAreaInBytes:et,fontExtraProperties:dt,useSystemFonts:tt,useWasm:F,useWorkerFetch:Z,cMapUrl:A,iccUrl:x,standardFontDataUrl:E,wasmUrl:T}},kt={ownerDocument:ft,pdfBug:J,styleElement:lt,loadingParams:{disableAutoFetch:G,enableXfa:_t}};return p.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const Xt=p.messageHandler.sendWithPromise("GetDocRequest",Kt,r?[r.buffer]:null);let fe;if(h)fe=new Uv(h,{disableRange:xt,disableStream:O});else if(!r){if(!s)throw new Error("getDocument - no `url` parameter provided.");const Ce=Ha(s)?Gv:Re?Jv:Kv;fe=new Ce({url:s,length:Y,httpHeaders:o,withCredentials:c,rangeChunkSize:f,disableRange:xt,disableStream:O})}return Xt.then(Ce=>{if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const _n=new ja(i,Ce,p.port),Ti=new rA(_n,t,fe,kt,ut,C);t._transport=Ti,_n.send("Ready",null)})}).catch(t._capability.reject),t}class ju{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${ju.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class fm{#t=Promise.withResolvers();#e=[];#n=[];#i=[];#r=[];constructor(t,i,s=!1,r=null){this.length=t,this.initialData=i,this.progressiveDone=s,this.contentDispositionFilename=r}addRangeListener(t){this.#r.push(t)}addProgressListener(t){this.#i.push(t)}addProgressiveReadListener(t){this.#n.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,i){for(const s of this.#r)s(t,i)}onDataProgress(t,i){this.#t.promise.then(()=>{for(const s of this.#i)s(t,i)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const i of this.#n)i(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,i){Gt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class sA{constructor(t,i){this._pdfInfo=t,this._transport=i}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return mt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,i){return this._transport.getAnnotationsByType(t,i)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:i}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(i)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(t){return this._transport.extractPages(t)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class aA{#t=!1;constructor(t,i,s,r=!1){this._pageIndex=t,this._pageInfo=i,this._transport=s,this._stats=r?new pp:null,this._pdfBug=r,this.commonObjs=s.commonObjs,this.objs=new hm,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:i=this.rotate,offsetX:s=0,offsetY:r=0,dontFlip:o=!1}={}){return new Za({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:i,offsetX:s,offsetY:r,dontFlip:o})}getAnnotations({intent:t="display"}={}){const{renderingIntent:i}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,i)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return mt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:i=t.canvas,viewport:s,intent:r="display",annotationMode:o=vn.ENABLE,transform:c=null,background:u=null,optionalContentConfigPromise:h=null,annotationCanvasMap:f=null,pageColors:p=null,printAnnotationStorage:y=null,isEditing:b=!1,recordOperations:A=!1,operationsFilter:_=null}){this._stats?.time("Overall");const S=this._transport.getRenderingIntent(r,o,y,b),{renderingIntent:x,cacheKey:E}=S;this.#t=!1,h||=this._transport.getOptionalContentConfig(x);let D=this._intentStates.get(E);D||(D=Object.create(null),this._intentStates.set(E,D)),D.streamReaderCancelTimeout&&(clearTimeout(D.streamReaderCancelTimeout),D.streamReaderCancelTimeout=null);const T=!!(x&Ze.PRINT);D.displayReadyCapability||(D.displayReadyCapability=Promise.withResolvers(),D.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(S));const B=!!(this._pdfBug&&globalThis.StepperManager?.enabled),N=!this.recordedBBoxes&&(A||B),k=Q=>{if(D.renderTasks.delete(z),N){const et=z.gfx?.dependencyTracker.take();et&&(z.stepper&&z.stepper.setOperatorBBoxes(et,z.gfx.dependencyTracker.takeDebugMetadata()),A&&(this.recordedBBoxes=et))}T&&(this.#t=!0),this.#e(),Q?(z.capability.reject(Q),this._abortOperatorList({intentState:D,reason:Q instanceof Error?Q:new Error(Q)})):z.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},z=new zs({callback:k,params:{canvas:i,canvasContext:t,dependencyTracker:N?new wv(i,D.operatorList.length,B):null,viewport:s,transform:c,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:D.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!T,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,operationsFilter:_});(D.renderTasks||=new Set).add(z);const K=z.task;return Promise.all([D.displayReadyCapability.promise,h]).then(([Q,et])=>{if(this.destroyed){k();return}if(this._stats?.time("Rendering"),!(et.renderingIntent&x))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");z.initializeGraphics({transparency:Q,optionalContentConfig:et}),z.operatorListChanged()}).catch(k),K}getOperatorList({intent:t="display",annotationMode:i=vn.ENABLE,printAnnotationStorage:s=null,isEditing:r=!1}={}){function o(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(h))}const c=this._transport.getRenderingIntent(t,i,s,r,!0);let u=this._intentStates.get(c.cacheKey);u||(u=Object.create(null),this._intentStates.set(c.cacheKey,u));let h;return u.opListReadCapability||(h=Object.create(null),h.operatorListChanged=o,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(h),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(c)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:i=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:i===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>Ya.textContent(s));const i=this.streamTextContent(t);return new Promise(function(s,r){function o(){c.read().then(function({value:h,done:f}){if(f){s(u);return}u.lang??=h.lang,Object.assign(u.styles,h.styles),u.items.push(...h.items),o()},r)}const c=i.getReader(),u={items:[],styles:Object.create(null),lang:null};o()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const i of this._intentStates.values())if(this._abortOperatorList({intentState:i,reason:new Error("Page was destroyed."),force:!0}),!i.opListReadCapability)for(const s of i.renderTasks)t.push(s.completed),s.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const i=this.#e();return t&&i&&(this._stats&&=new pp),i}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:i}of this._intentStates.values())if(t.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,i){const s=this._intentStates.get(i);s&&(this._stats?.timeEnd("Page Request"),s.displayReadyCapability?.resolve(t))}_renderPageChunk(t,i){for(let s=0,r=t.length;s<r;s++)i.operatorList.fnArray.push(t.fnArray[s]),i.operatorList.argsArray.push(t.argsArray[s]);i.operatorList.lastChunk=t.lastChunk,i.operatorList.separateAnnots=t.separateAnnots;for(const s of i.renderTasks)s.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:i,annotationStorageSerializable:s,modifiedIds:r}){const{map:o,transfer:c}=s,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:i,annotationStorage:o,modifiedIds:r},c).getReader(),f=this._intentStates.get(i);f.streamReader=h;const p=()=>{h.read().then(({value:y,done:b})=>{if(b){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(y,f),p())},y=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const b of f.renderTasks)b.operatorListChanged();this.#e()}if(f.displayReadyCapability)f.displayReadyCapability.reject(y);else if(f.opListReadCapability)f.opListReadCapability.reject(y);else throw y}})};p()}_abortOperatorList({intentState:t,reason:i,force:s=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!s){if(t.renderTasks.size>0)return;if(i instanceof ku){let r=nA;i.extraDelay>0&&i.extraDelay<1e3&&(r+=i.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:i,force:!0})},r);return}}if(t.streamReader.cancel(new An(i.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[r,o]of this._intentStates)if(o===t){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}class Ee{#t=Promise.withResolvers();#e=null;#n=null;#i=null;static#r=0;static#a=!1;static#s=new WeakMap;static{Re&&(this.#a=!0,Is.workerSrc||="./pdf.worker.mjs"),this._isSameOrigin=(t,i)=>{const s=URL.parse(t);if(!s?.origin||s.origin==="null")return!1;const r=new URL(i,s);return s.origin===r.origin},this._createCDNWrapper=t=>{const i=`await import("${t}");`;return URL.createObjectURL(new Blob([i],{type:"text/javascript"}))},this.fromPort=t=>{if(Qb("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return this.create(t)}}constructor({name:t=null,port:i=null,verbosity:s=Fb()}={}){if(this.name=t,this.destroyed=!1,this.verbosity=s,i){if(Ee.#s.has(i))throw new Error("Cannot use more than one PDFWorker per port.");Ee.#s.set(i,this),this.#c(i)}else this.#o()}get promise(){return this.#t.promise}#l(){this.#t.resolve(),this.#e.send("configure",{verbosity:this.verbosity})}get port(){return this.#n}get messageHandler(){return this.#e}#c(t){this.#n=t,this.#e=new ja("main","worker",t),this.#e.on("ready",()=>{}),this.#l()}#o(){if(Ee.#a||Ee.#h){this.#d();return}let{workerSrc:t}=Ee;try{Ee._isSameOrigin(window.location,t)||(t=Ee._createCDNWrapper(new URL(t,window.location).href));const i=new Worker(t,{type:"module"}),s=new ja("main","worker",i),r=()=>{o.abort(),s.destroy(),i.terminate(),this.destroyed?this.#t.reject(new Error("Worker was destroyed")):this.#d()},o=new AbortController;i.addEventListener("error",()=>{this.#i||r()},{signal:o.signal}),s.on("test",u=>{if(o.abort(),this.destroyed||!u){r();return}this.#e=s,this.#n=i,this.#i=i,this.#l()}),s.on("ready",u=>{if(o.abort(),this.destroyed){r();return}try{c()}catch{this.#d()}});const c=()=>{const u=new Uint8Array;s.send("test",u,[u.buffer])};c();return}catch{kl("The worker has been disabled.")}this.#d()}#d(){Ee.#a||(pt("Setting up fake worker."),Ee.#a=!0),Ee._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this.#t.reject(new Error("Worker was destroyed"));return}const i=new gv;this.#n=i;const s=`fake${Ee.#r++}`,r=new ja(s+"_worker",s,i);t.setup(r,i),this.#e=new ja(s,s+"_worker",i),this.#l()}).catch(t=>{this.#t.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){this.destroyed=!0,this.#i?.terminate(),this.#i=null,Ee.#s.delete(this.#n),this.#n=null,this.#e?.destroy(),this.#e=null}static create(t){const i=this.#s.get(t?.port);if(i){if(i._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return i}return new Ee(t)}static get workerSrc(){if(Is.workerSrc)return Is.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get#h(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){return mt(this,"_setupFakeWorkerGlobal",(async()=>this.#h?this.#h:(await import(this.workerSrc)).WorkerMessageHandler)())}}class rA{#t=new Map;#e=new Map;#n=new Map;#i=new Map;#r=null;constructor(t,i,s,r,o,c){this.messageHandler=t,this.loadingTask=i,this.commonObjs=new hm,this.fontLoader=new lv({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=o.canvasFactory,this.filterFactory=o.filterFactory,this.cMapReaderFactory=o.cMapReaderFactory,this.standardFontDataFactory=o.standardFontDataFactory,this.wasmFactory=o.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=c,this.setupMessageHandler()}#a(t,i=null){const s=this.#t.get(t);if(s)return s;const r=this.messageHandler.sendWithPromise(t,i);return this.#t.set(t,r),r}get annotationStorage(){return mt(this,"annotationStorage",new Fu)}getRenderingIntent(t,i=vn.ENABLE,s=null,r=!1,o=!1){let c=Ze.DISPLAY,u=xu;switch(t){case"any":c=Ze.ANY;break;case"display":break;case"print":c=Ze.PRINT;break;default:pt(`getRenderingIntent - invalid intent: ${t}`)}const h=c&Ze.PRINT&&s instanceof Jp?s:this.annotationStorage;switch(i){case vn.DISABLE:c+=Ze.ANNOTATIONS_DISABLE;break;case vn.ENABLE:break;case vn.ENABLE_FORMS:c+=Ze.ANNOTATIONS_FORMS;break;case vn.ENABLE_STORAGE:c+=Ze.ANNOTATIONS_STORAGE,u=h.serializable;break;default:pt(`getRenderingIntent - invalid annotationMode: ${i}`)}r&&(c+=Ze.IS_EDITING),o&&(c+=Ze.OPLIST);const{ids:f,hash:p}=h.modifiedIds,y=[c,u.hash,p];return{renderingIntent:c,cacheKey:y.join("_"),annotationStorageSerializable:u,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const s of this.#e.values())t.push(s._destroy());this.#e.clear(),this.#n.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const i=this.messageHandler.sendWithPromise("Terminate",null);return t.push(i),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),We.cleanup(),this._networkStream?.cancelAllRequests(new An("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:i}=this;t.on("GetReader",(s,r)=>{Mt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=o=>{this._lastProgress={loaded:o.loaded,total:o.total}},r.onPull=()=>{this._fullReader.read().then(function({value:o,done:c}){if(c){r.close();return}Mt(o instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{r.error(o)})},r.onCancel=o=>{this._fullReader.cancel(o),r.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("ReaderHeadersReady",async s=>{await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:o,contentLength:c}=this._fullReader;return(!r||!o)&&(this._lastProgress&&i.onProgress?.(this._lastProgress),this._fullReader.onProgress=u=>{i.onProgress?.({loaded:u.loaded,total:u.total})}),{isStreamingSupported:r,isRangeSupported:o,contentLength:c}}),t.on("GetRangeReader",(s,r)=>{Mt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const o=this._networkStream.getRangeReader(s.begin,s.end);if(!o){r.close();return}r.onPull=()=>{o.read().then(function({value:c,done:u}){if(u){r.close();return}Mt(c instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(c),1,[c])}).catch(c=>{r.error(c)})},r.onCancel=c=>{o.cancel(c),r.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,i._capability.resolve(new sA(s,this))}),t.on("DocException",s=>{i._capability.reject(Ue(s))}),t.on("PasswordRequest",s=>{this.#r=Promise.withResolvers();try{if(!i.onPassword)throw Ue(s);const r=o=>{o instanceof Error?this.#r.reject(o):this.#r.resolve({password:o})};i.onPassword(r,s.code)}catch(r){this.#r.reject(r)}return this.#r.promise}),t.on("DataLoaded",s=>{i.onProgress?.({loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),t.on("StartRenderPage",s=>{if(this.destroyed)return;this.#e.get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),t.on("commonobj",([s,r,o])=>{if(this.destroyed||this.commonObjs.has(s))return null;switch(r){case"Font":if("error"in o){const y=o.error;pt(`Error during font loading: ${y}`),this.commonObjs.resolve(s,y);break}const c=new Ht(o),u=this._params.pdfBug&&globalThis.FontInspector?.enabled?(y,b)=>globalThis.FontInspector.fontAdded(y,b):null,h=new ov(c,u,o.extra,o.charProcOperatorList);this.fontLoader.bind(h).catch(()=>t.sendWithPromise("FontFallback",{id:s})).finally(()=>{!h.fontExtraProperties&&h.data&&h.clearData(),this.commonObjs.resolve(s,h)});break;case"CopyLocalImage":const{imageRef:f}=o;Mt(f,"The imageRef must be defined.");for(const y of this.#e.values())for(const[,b]of y.objs)if(b?.ref===f)return b.dataLen?(this.commonObjs.resolve(s,structuredClone(b)),b.dataLen):null;break;case"FontPath":this.commonObjs.resolve(s,new cv(o));break;case"Image":this.commonObjs.resolve(s,o);break;case"Pattern":const p=new me(o);this.commonObjs.resolve(s,p.getIR());break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),t.on("obj",([s,r,o,c])=>{if(this.destroyed)return;const u=this.#e.get(r);if(!u.objs.has(s)){if(u._intentStates.size===0){c?.bitmap?.close();return}switch(o){case"Image":case"Pattern":u.objs.resolve(s,c);break;default:throw new Error(`Got unknown object type ${o}`)}}}),t.on("DocProgress",s=>{this.destroyed||i.onProgress?.({loaded:s.loaded,total:s.total})}),t.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const r=this[s.type];if(!r)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return r.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&pt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:i}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},i).finally(()=>{this.annotationStorage.resetModified()})}extractPages(t){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:t})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const i=t-1,s=this.#n.get(i);if(s)return s;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:i}).then(o=>{if(this.destroyed)throw new Error("Transport destroyed");o.refStr&&this.#i.set(o.refStr,t);const c=new aA(i,o,this,this._params.pdfBug);return this.#e.set(i,c),c});return this.#n.set(i,r),r}getPageIndex(t){return Tu(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,i){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:i})}getFieldObjects(){return this.#a("GetFieldObjects")}hasJSActions(){return this.#a("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,i){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:i})}getDocJSActions(){return this.#a("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#a("GetOptionalContentConfig").then(i=>new Fv(i,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",i=this.#t.get(t);if(i)return i;const s=this.messageHandler.sendWithPromise(t,null).then(r=>({info:r[0],metadata:r[1]?new zv(r[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null,hasStructTree:r[2]}));return this.#t.set(t,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const i of this.#e.values())if(!i.cleanup())throw new Error(`startCleanup: Page ${i.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),We.cleanup()}}cachedPageNumber(t){if(!Tu(t))return null;const i=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#i.get(i)??null}}class lA{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:i}=this.#t;return t.form||t.canvas&&i?.size>0}}class zs{#t=null;static#e=new WeakSet;constructor({callback:t,params:i,objs:s,commonObjs:r,annotationCanvasMap:o,operatorList:c,pageIndex:u,canvasFactory:h,filterFactory:f,useRequestAnimationFrame:p=!1,pdfBug:y=!1,pageColors:b=null,enableHWA:A=!1,operationsFilter:_=null}){this.callback=t,this.params=i,this.objs=s,this.commonObjs=r,this.annotationCanvasMap=o,this.operatorListIdx=null,this.operatorList=c,this._pageIndex=u,this.canvasFactory=h,this.filterFactory=f,this._pdfBug=y,this.pageColors=b,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new lA(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=i.canvas,this._canvasContext=i.canvas?null:i.canvasContext,this._enableHWA=A,this._dependencyTracker=i.dependencyTracker,this._operationsFilter=_}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:i}){if(this.cancelled)return;if(this._canvas){if(zs.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");zs.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:s,transform:r,background:o,dependencyTracker:c}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Us(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:i},this.annotationCanvasMap,this.pageColors,c),this.gfx.beginDrawing({transform:r,viewport:s,transparency:t,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,i=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),zs.#e.delete(this._canvas),t||=new ku(`Rendering cancelled, page ${this._pageIndex+1}`,i),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),zs.#e.delete(this._canvas),this.callback())))}}const oA="5.4.530",cA="50cc4adac";class di{#t=null;#e=null;#n;#i=null;#r=!1;#a=!1;#s=null;#l;#c=null;#o=null;static#d=null;static get _keyboardManager(){return mt(this,"_keyboardManager",new Ja([[["Escape","mac+Escape"],di.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],di.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],di.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],di.prototype._moveToPrevious],[["Home","mac+Home"],di.prototype._moveToBeginning],[["End","mac+End"],di.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:i=null}){t?(this.#a=!1,this.#s=t):this.#a=!0,this.#o=t?._uiManager||i,this.#l=this.#o._eventBus,this.#n=t?.color?.toUpperCase()||this.#o?.highlightColors.values().next().value||"#FFFF98",di.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#s&&(t.ariaControls=`${this.#s.id}_colorpicker_dropdown`);const i=this.#o._signal;t.addEventListener("click",this.#p.bind(this),{signal:i}),t.addEventListener("keydown",this.#m.bind(this),{signal:i});const s=this.#e=document.createElement("span");return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=this.#n,t.append(s),t}renderMainDropdown(){const t=this.#i=this.#h();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#h(){const t=document.createElement("div"),i=this.#o._signal;t.addEventListener("contextmenu",fi,{signal:i}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#s&&(t.id=`${this.#s.id}_colorpicker_dropdown`);for(const[s,r]of this.#o.highlightColors){const o=document.createElement("button");o.tabIndex="0",o.role="option",o.setAttribute("data-color",r),o.title=s,o.setAttribute("data-l10n-id",di.#d[s]);const c=document.createElement("span");o.append(c),c.className="swatch",c.style.backgroundColor=r,o.ariaSelected=r===this.#n,o.addEventListener("click",this.#f.bind(this,r),{signal:i}),t.append(o)}return t.addEventListener("keydown",this.#m.bind(this),{signal:i}),t}#f(t,i){i.stopPropagation(),this.#l.dispatch("switchannotationeditorparams",{source:this,type:Ct.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#p(t);return}const i=t.target.getAttribute("data-color");i&&this.#f(i,t)}_moveToNext(t){if(!this.#g){this.#p(t);return}if(t.target===this.#t){this.#i.firstElementChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#i?.firstElementChild||t.target===this.#t){this.#g&&this._hideDropdownFromKeyboard();return}this.#g||this.#p(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#g){this.#p(t);return}this.#i.firstElementChild?.focus()}_moveToEnd(t){if(!this.#g){this.#p(t);return}this.#i.lastElementChild?.focus()}#m(t){di._keyboardManager.exec(this,t)}#p(t){if(this.#g){this.hideDropdown();return}if(this.#r=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#o.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#i){this.#i.classList.remove("hidden");return}const i=this.#i=this.#h();this.#t.append(i)}#u(t){this.#i?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#g(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#a){if(!this.#g){this.#s?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#i)return;const i=this.#o.highlightColors.values();for(const s of this.#i.children)s.ariaSelected=i.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#i?.remove(),this.#i=null}}class Ka{#t=null;#e=null;#n=null;static#i=null;constructor(t){this.#e=t,this.#n=t._uiManager,Ka.#i||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:i,color:s}=this.#e,r=this.#t=document.createElement("input");return r.type="color",r.value=s||"#000000",r.className="basicColorPicker",r.tabIndex=0,r.setAttribute("data-l10n-id",Ka.#i[t]),r.addEventListener("input",()=>{this.#n.updateParams(i,r.value)},{signal:this.#n._signal}),r}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function Pp(m){return Math.floor(Math.max(0,Math.min(1,m))*255).toString(16).padStart(2,"0")}function Ua(m){return Math.max(0,Math.min(255,255*m))}class Fp{static CMYK_G([t,i,s,r]){return["G",1-Math.min(1,.3*t+.59*s+.11*i+r)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Ua(t),[t,t,t]}static G_HTML([t]){const i=Pp(t);return`#${i}${i}${i}`}static RGB_G([t,i,s]){return["G",.3*t+.59*i+.11*s]}static RGB_rgb(t){return t.map(Ua)}static RGB_HTML(t){return`#${t.map(Pp).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,i,s,r]){return["RGB",1-Math.min(1,t+r),1-Math.min(1,s+r),1-Math.min(1,i+r)]}static CMYK_rgb([t,i,s,r]){return[Ua(1-Math.min(1,t+r)),Ua(1-Math.min(1,s+r)),Ua(1-Math.min(1,i+r))]}static CMYK_HTML(t){const i=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(i)}static RGB_CMYK([t,i,s]){const r=1-t,o=1-i,c=1-s,u=Math.min(r,o,c);return["CMYK",r,o,c,u]}}class uA{create(t,i,s=!1){if(t<=0||i<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),s||(r.setAttribute("width",`${t}px`),r.setAttribute("height",`${i}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${t} ${i}`),r}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Gt("Abstract method `_createSVG` called.")}}class Ol extends uA{_createSVG(t){return document.createElementNS(Vi,t)}}const hA=9,Gn=new WeakSet,dA=new Date().getTimezoneOffset()*60*1e3;class bu{static create(t){switch(t.data.annotationType){case ce.LINK:return new Gu(t);case ce.TEXT:return new gA(t);case ce.WIDGET:switch(t.data.fieldType){case"Tx":return new pA(t);case"Btn":return t.data.radioButton?new gm(t):t.data.checkBox?new yA(t):new bA(t);case"Ch":return new vA(t);case"Sig":return new mA(t)}return new Vn(t);case ce.POPUP:return new Du(t);case ce.FREETEXT:return new pm(t);case ce.LINE:return new SA(t);case ce.SQUARE:return new _A(t);case ce.CIRCLE:return new wA(t);case ce.POLYLINE:return new mm(t);case ce.CARET:return new xA(t);case ce.INK:return new qu(t);case ce.POLYGON:return new EA(t);case ce.HIGHLIGHT:return new ym(t);case ce.UNDERLINE:return new TA(t);case ce.SQUIGGLY:return new CA(t);case ce.STRIKEOUT:return new MA(t);case ce.STAMP:return new bm(t);case ce.FILEATTACHMENT:return new DA(t);default:return new Qt(t)}}}class Qt{#t=null;#e=!1;#n=null;constructor(t,{isRenderable:i=!1,ignoreBorder:s=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=i,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,this.hasOwnCommentButton=!1,i&&(this.contentElement=this.container=this._createContainer(s)),r&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:i}){return!!(t?.str||i?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Qt._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,i=this.annotationStorage?.getEditor(t.id);return i?i.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:i,inkLists:s,rect:r}=this.data;let o=-1/0,c=-1/0;if(i?.length>=8){for(let u=0;u<i.length;u+=8)i[u+1]>c?(c=i[u+1],o=i[u+2]):i[u+1]===c&&(o=Math.max(o,i[u+2]));return[o,c]}if(s?.length>=1){for(const u of s)for(let h=0,f=u.length;h<f;h+=2)u[h+1]>c?(c=u[h+1],o=u[h]):u[h+1]===c&&(o=Math.max(o,u[h]));if(o!==1/0)return[o,c]}return r?[r[2],r[3]]:null}_normalizePoint(t){const{page:{view:i},viewport:{rawDims:{pageWidth:s,pageHeight:r,pageX:o,pageY:c}}}=this.parent;return t[1]=i[3]-t[1]+i[1],t[0]=100*(t[0]-o)/s,t[1]=100*(t[1]-c)/r,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${Va}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:i}=this,s={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(i.id,{popup:s})||this.annotationStorage.setValue(`${Va}${i.id}`,{id:i.id,annotationType:i.annotationType,pageIndex:this.parent.page._pageIndex,popup:s,popupRef:i.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#n?.popup||this.popup)?.remove(),this.#n=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:i,popup:s}=t;i&&this.#i(i);let r=this.#n?.popup||this.popup;!r&&s?.text&&(this._createPopup(s),r=this.#n.popup),r&&(r.updateEdited(t),s?.deleted&&(r.remove(),this.#n=null,this.popup=null))}resetEdited(){this.#t&&(this.#i(this.#t.rect),this.#n?.popup.resetEdited(),this.#t=null)}#i(t){const{container:{style:i},data:{rect:s,rotation:r},parent:{viewport:{rawDims:{pageWidth:o,pageHeight:c,pageX:u,pageY:h}}}}=this;s?.splice(0,4,...t),i.left=`${100*(t[0]-u)/o}%`,i.top=`${100*(c-t[3]+h)/c}%`,r===0?(i.width=`${100*(t[2]-t[0])/o}%`,i.height=`${100*(t[3]-t[1])/c}%`):this.setRotation(r)}_createContainer(t){const{data:i,parent:{page:s,viewport:r}}=this,o=document.createElement("section");o.setAttribute("data-annotation-id",i.id),!(this instanceof Vn)&&!(this instanceof Gu)&&(o.tabIndex=0);const{style:c}=o;if(c.zIndex=this.parent.zIndex,this.parent.zIndex+=2,i.alternativeText&&(o.title=i.alternativeText),i.noRotate&&o.classList.add("norotate"),!i.rect||this instanceof Du){const{rotation:S}=i;return!i.hasOwnCanvas&&S!==0&&this.setRotation(S,o),o}const{width:u,height:h}=this;if(!t&&i.borderStyle.width>0){c.borderWidth=`${i.borderStyle.width}px`;const S=i.borderStyle.horizontalCornerRadius,x=i.borderStyle.verticalCornerRadius;if(S>0||x>0){const D=`calc(${S}px * var(--total-scale-factor)) / calc(${x}px * var(--total-scale-factor))`;c.borderRadius=D}else if(this instanceof gm){const D=`calc(${u}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;c.borderRadius=D}switch(i.borderStyle.style){case Os.SOLID:c.borderStyle="solid";break;case Os.DASHED:c.borderStyle="dashed";break;case Os.BEVELED:pt("Unimplemented border style: beveled");break;case Os.INSET:pt("Unimplemented border style: inset");break;case Os.UNDERLINE:c.borderBottomStyle="solid";break}const E=i.borderColor||null;E?(this.#e=!0,c.borderColor=it.makeHexColor(E[0]|0,E[1]|0,E[2]|0)):c.borderWidth=0}const f=it.normalizeRect([i.rect[0],s.view[3]-i.rect[1]+s.view[1],i.rect[2],s.view[3]-i.rect[3]+s.view[1]]),{pageWidth:p,pageHeight:y,pageX:b,pageY:A}=r.rawDims;c.left=`${100*(f[0]-b)/p}%`,c.top=`${100*(f[1]-A)/y}%`;const{rotation:_}=i;return i.hasOwnCanvas||_===0?(c.width=`${100*u/p}%`,c.height=`${100*h/y}%`):this.setRotation(_,o),o}setRotation(t,i=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:r}=this.parent.viewport.rawDims;let{width:o,height:c}=this;t%180!==0&&([o,c]=[c,o]),i.style.width=`${100*o/s}%`,i.style.height=`${100*c/r}%`,i.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(i,s,r)=>{const o=r.detail[i],c=o[0],u=o.slice(1);r.target.style[s]=Fp[`${c}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[s]:Fp[`${c}_rgb`](u)})};return mt(this,"_commonActions",{display:i=>{const{display:s}=i.detail,r=s%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:s===1||s===2})},print:i=>{this.annotationStorage.setValue(this.data.id,{noPrint:!i.detail.print})},hidden:i=>{const{hidden:s}=i.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:i=>{setTimeout(()=>i.target.focus({preventScroll:!1}),0)},userName:i=>{i.target.title=i.detail.userName},readonly:i=>{i.target.disabled=i.detail.readonly},required:i=>{this._setRequired(i.target,i.detail.required)},bgColor:i=>{t("bgColor","backgroundColor",i)},fillColor:i=>{t("fillColor","backgroundColor",i)},fgColor:i=>{t("fgColor","color",i)},textColor:i=>{t("textColor","color",i)},borderColor:i=>{t("borderColor","borderColor",i)},strokeColor:i=>{t("strokeColor","borderColor",i)},rotation:i=>{const s=i.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(t,i){const s=this._commonActions;for(const r of Object.keys(i.detail))(t[r]||s[r])?.(i)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const i=this.annotationStorage.getRawValue(this.data.id);if(!i)return;const s=this._commonActions;for(const[r,o]of Object.entries(i)){const c=s[r];if(c){const u={detail:{[r]:o},target:t};c(u),delete i[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[i,s,r,o]=this.data.rect.map(S=>Math.fround(S));if(t.length===8){const[S,x,E,D]=t.subarray(2,6);if(r===S&&o===x&&i===E&&s===D)return}const{style:c}=this.container;let u;if(this.#e){const{borderColor:S,borderWidth:x}=c;c.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${S}" stroke-width="${x}">`],this.container.classList.add("hasBorder")}const h=r-i,f=o-s,{svgFactory:p}=this,y=p.createElement("svg");y.classList.add("quadrilateralsContainer"),y.setAttribute("width",0),y.setAttribute("height",0),y.role="none";const b=p.createElement("defs");y.append(b);const A=p.createElement("clipPath"),_=`clippath_${this.data.id}`;A.setAttribute("id",_),A.setAttribute("clipPathUnits","objectBoundingBox"),b.append(A);for(let S=2,x=t.length;S<x;S+=8){const E=t[S],D=t[S+1],T=t[S+2],B=t[S+3],N=p.createElement("rect"),k=(T-i)/h,z=(o-D)/f,K=(E-T)/h,Q=(D-B)/f;N.setAttribute("x",k),N.setAttribute("y",z),N.setAttribute("width",K),N.setAttribute("height",Q),A.append(N),u?.push(`<rect vector-effect="non-scaling-stroke" x="${k}" y="${z}" width="${K}" height="${Q}"/>`)}this.#e&&(u.push("</g></svg>')"),c.backgroundImage=u.join("")),this.container.append(y),this.container.style.clipPath=`url(#${_})`}_createPopup(t=null){const{data:i}=this;let s,r;t?(s={str:t.text},r=t.date):(s=i.contentsObj,r=i.modificationDate),this.#n=new Du({data:{color:i.color,titleObj:i.titleObj,modificationDate:r,contentsObj:s,richText:i.richText,parentRect:i.rect,borderStyle:0,id:`popup_${i.id}`,rotation:i.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#n||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#n}render(){Gt("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,i=null){const s=[];if(this._fieldObjects){const r=this._fieldObjects[t];if(r)for(const{page:o,id:c,exportValues:u}of r){if(o===-1||c===i)continue;const h=typeof u=="string"?u:null,f=document.querySelector(`[data-element-id="${c}"]`);if(f&&!Gn.has(f)){pt(`_getElementsByName - element not allowed: ${c}`);continue}s.push({id:c,exportValue:h,domElement:f})}return s}for(const r of document.getElementsByName(t)){const{exportValue:o}=r,c=r.getAttribute("data-element-id");c!==i&&Gn.has(r)&&s.push({id:c,exportValue:o,domElement:r})}return s}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const i of t)i.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:i}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:i,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class fA extends Qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&this._createPopup(t.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class Gu extends Qt{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!i?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let r=!1;return t.url?(i.addLinkAttributes(s,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(s,t.action,t.overlaidText),r=!0):t.attachment?(this.#e(s,t.attachment,t.overlaidText,t.attachmentDest),r=!0):t.setOCGState?(this.#n(s,t.setOCGState,t.overlaidText),r=!0):t.dest?(this._bindLink(s,t.dest,t.overlaidText),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),r=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(s,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&(this.contentElement=s,this.container.append(s)),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,i,s=""){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&this.#t(),s&&(t.title=s)}_bindNamedAction(t,i,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),s&&(t.title=s),this.#t()}#e(t,i,s="",r=null){t.href=this.linkService.getAnchorUrl(""),i.description?t.title=i.description:s&&(t.title=s),t.onclick=()=>(this.downloadManager?.openOrDownloadData(i.content,i.filename,r),!1),this.#t()}#n(t,i,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(i),!1),s&&(t.title=s),this.#t()}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(i.actions)){const o=s.get(r);o&&(t[o]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:r}}),!1))}i.overlaidText&&(t.title=i.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,i){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){pt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{s?.();const{fields:r,refs:o,include:c}=i,u=[];if(r.length!==0||o.length!==0){const p=new Set(o);for(const y of r){const b=this._fieldObjects[y]||[];for(const{id:A}of b)p.add(A)}for(const y of Object.values(this._fieldObjects))for(const b of y)p.has(b.id)===c&&u.push(b)}else for(const p of Object.values(this._fieldObjects))u.push(...p);const h=this.annotationStorage,f=[];for(const p of u){const{id:y}=p;switch(f.push(y),p.type){case"text":{const A=p.defaultValue||"";h.setValue(y,{value:A});break}case"checkbox":case"radiobutton":{const A=p.defaultValue===p.exportValues;h.setValue(y,{value:A});break}case"combobox":case"listbox":{const A=p.defaultValue||"";h.setValue(y,{value:A});break}default:continue}const b=document.querySelector(`[data-element-id="${y}"]`);if(b){if(!Gn.has(b)){pt(`_bindResetFormAction - element not allowed: ${y}`);continue}}else continue;b.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class gA extends Qt{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(t),this.container}}class Vn extends Qt{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return de.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,i,s,r,o){s.includes("mouse")?t.addEventListener(s,c=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:o(c),shift:c.shiftKey,modifier:this._getKeyModifier(c)}})}):t.addEventListener(s,c=>{if(s==="blur"){if(!i.focused||!c.relatedTarget)return;i.focused=!1}else if(s==="focus"){if(i.focused)return;i.focused=!0}o&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:o(c)}})})}_setEventListeners(t,i,s,r){for(const[o,c]of s)(c==="Action"||this.data.actions?.[c])&&((c==="Focus"||c==="Blur")&&(i||={focused:!1}),this._setEventListener(t,i,o,c,r),c==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,i,"blur","Blur",null):c==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,i,"focus","Focus",null))}_setBackgroundColor(t){const i=this.data.backgroundColor||null;t.style.backgroundColor=i===null?"transparent":it.makeHexColor(i[0],i[1],i[2])}_setTextStyle(t){const i=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||hA,o=t.style;let c;const u=2,h=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u),p=Math.round(f/(uu*r))||1,y=f/p;c=Math.min(r,h(y/uu))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u);c=Math.min(r,h(f/uu))}o.fontSize=`calc(${c}px * var(--total-scale-factor))`,o.color=it.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(o.textAlign=i[this.data.textAlignment])}_setRequired(t,i){i?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",i)}}class pA extends Vn{constructor(t){const i=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:i})}setPropertyOnSiblings(t,i,s,r){const o=this.annotationStorage;for(const c of this._getElementsByName(t.name,t.id))c.domElement&&(c.domElement[i]=s),o.setValue(c.id,{[r]:s})}render(){const t=this.annotationStorage,i=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const r=t.getValue(i,{value:this.data.fieldValue});let o=r.value||"";const c=t.getValue(i,{charLimit:this.data.maxLen}).charLimit;c&&o.length>c&&(o=o.slice(0,c));let u=r.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??o,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",u??o),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),Gn.add(s),this.contentElement=s,s.setAttribute("data-element-id",i),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const{datetimeFormat:f,datetimeType:p,timeStep:y}=this.data,b=!!p&&this.enableScripting;f&&(s.title=f),this._setRequired(s,this.data.required),c&&(s.maxLength=c),s.addEventListener("input",_=>{t.setValue(i,{value:_.target.value}),this.setPropertyOnSiblings(s,"value",_.target.value,"value"),h.formattedValue=null}),s.addEventListener("resetform",_=>{const S=this.data.defaultFieldValue??"";s.value=h.userValue=S,h.formattedValue=null});let A=_=>{const{formattedValue:S}=h;S!=null&&(_.target.value=S),_.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",S=>{if(h.focused)return;const{target:x}=S;if(b&&(x.type=p,y&&(x.step=y)),h.userValue){const E=h.userValue;if(b)if(p==="time"){const D=new Date(E),T=[D.getHours(),D.getMinutes(),D.getSeconds()];x.value=T.map(B=>B.toString().padStart(2,"0")).join(":")}else x.value=new Date(E-dA).toISOString().split(p==="date"?"T":".",1)[0];else x.value=E}h.lastCommittedValue=x.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),s.addEventListener("updatefromsandbox",S=>{this.showElementAndHideCanvas(S.target);const x={value(E){h.userValue=E.detail.value??"",b||t.setValue(i,{value:h.userValue.toString()}),E.target.value=h.userValue},formattedValue(E){const{formattedValue:D}=E.detail;h.formattedValue=D,D!=null&&E.target!==document.activeElement&&(E.target.value=D);const T={formattedValue:D};b&&(T.value=D),t.setValue(i,T)},selRange(E){E.target.setSelectionRange(...E.detail.selRange)},charLimit:E=>{const{charLimit:D}=E.detail,{target:T}=E;if(D===0){T.removeAttribute("maxLength");return}T.setAttribute("maxLength",D);let B=h.userValue;!B||B.length<=D||(B=B.slice(0,D),T.value=h.userValue=B,t.setValue(i,{value:B}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:B,willCommit:!0,commitKey:1,selStart:T.selectionStart,selEnd:T.selectionEnd}}))}};this._dispatchEventFromSandbox(x,S)}),s.addEventListener("keydown",S=>{h.commitKey=1;let x=-1;if(S.key==="Escape"?x=0:S.key==="Enter"&&!this.data.multiLine?x=2:S.key==="Tab"&&(h.commitKey=3),x===-1)return;const{value:E}=S.target;h.lastCommittedValue!==E&&(h.lastCommittedValue=E,h.userValue=E,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:E,willCommit:!0,commitKey:x,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}))});const _=A;A=null,s.addEventListener("blur",S=>{if(!h.focused||!S.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{target:x}=S;let{value:E}=x;if(b){if(E&&p==="time"){const D=E.split(":").map(T=>parseInt(T,10));E=new Date(2e3,0,1,D[0],D[1],D[2]||0).valueOf(),x.step=""}else E.includes("T")||(E=`${E}T00:00`),E=new Date(E).valueOf();x.type="text"}h.userValue=E,h.lastCommittedValue!==E&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:E,willCommit:!0,commitKey:h.commitKey,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}),_(S)}),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",S=>{h.lastCommittedValue=null;const{data:x,target:E}=S,{value:D,selectionStart:T,selectionEnd:B}=E;let N=T,k=B;switch(S.inputType){case"deleteWordBackward":{const z=D.substring(0,T).match(/\w*[^\w]*$/);z&&(N-=z[0].length);break}case"deleteWordForward":{const z=D.substring(T).match(/^[^\w]*\w*/);z&&(k+=z[0].length);break}case"deleteContentBackward":T===B&&(N-=1);break;case"deleteContentForward":T===B&&(k+=1);break}S.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:D,change:x||"",willCommit:!1,selStart:N,selEnd:k}})}),this._setEventListeners(s,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],S=>S.target.value)}if(A&&s.addEventListener("blur",A),this.data.comb){const S=(this.data.rect[2]-this.data.rect[0])/c;s.classList.add("comb"),s.style.letterSpacing=`calc(${S}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class mA extends Vn{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class yA extends Vn{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,i=this.data,s=i.id;let r=t.getValue(s,{value:i.exportValue===i.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",t.setValue(s,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const o=document.createElement("input");return Gn.add(o),o.setAttribute("data-element-id",s),o.disabled=i.readOnly,this._setRequired(o,this.data.required),o.type="checkbox",o.name=i.fieldName,r&&o.setAttribute("checked",!0),o.setAttribute("exportValue",i.exportValue),o.tabIndex=0,o.addEventListener("change",c=>{const{name:u,checked:h}=c.target;for(const f of this._getElementsByName(u,s)){const p=h&&f.exportValue===i.exportValue;f.domElement&&(f.domElement.checked=p),t.setValue(f.id,{value:p})}t.setValue(s,{value:h})}),o.addEventListener("resetform",c=>{const u=i.defaultFieldValue||"Off";c.target.checked=u===i.exportValue}),this.enableScripting&&this.hasJSActions&&(o.addEventListener("updatefromsandbox",c=>{const u={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(s,{value:h.target.checked})}};this._dispatchEventFromSandbox(u,c)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class gm extends Vn{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,i=this.data,s=i.id;let r=t.getValue(s,{value:i.fieldValue===i.buttonValue}).value;if(typeof r=="string"&&(r=r!==i.buttonValue,t.setValue(s,{value:r})),r)for(const c of this._getElementsByName(i.fieldName,s))t.setValue(c.id,{value:!1});const o=document.createElement("input");if(Gn.add(o),o.setAttribute("data-element-id",s),o.disabled=i.readOnly,this._setRequired(o,this.data.required),o.type="radio",o.name=i.fieldName,r&&o.setAttribute("checked",!0),o.tabIndex=0,o.addEventListener("change",c=>{const{name:u,checked:h}=c.target;for(const f of this._getElementsByName(u,s))t.setValue(f.id,{value:!1});t.setValue(s,{value:h})}),o.addEventListener("resetform",c=>{const u=i.defaultFieldValue;c.target.checked=u!=null&&u===i.buttonValue}),this.enableScripting&&this.hasJSActions){const c=i.buttonValue;o.addEventListener("updatefromsandbox",u=>{const h={value:f=>{const p=c===f.detail.value;for(const y of this._getElementsByName(f.target.name)){const b=p&&y.id===s;y.domElement&&(y.domElement.checked=b),t.setValue(y.id,{value:b})}}};this._dispatchEventFromSandbox(h,u)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class bA extends Gu{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const i=t.lastChild;return this.enableScripting&&this.hasJSActions&&i&&(this._setDefaultPropertiesFromJS(i),i.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),t}}class vA extends Vn{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,i=this.data.id,s=t.getValue(i,{value:this.data.fieldValue}),r=document.createElement("select");Gn.add(r),r.setAttribute("data-element-id",i),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=0;let o=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",p=>{const y=this.data.defaultFieldValue;for(const b of r.options)b.selected=b.value===y});for(const p of this.data.options){const y=document.createElement("option");y.textContent=p.displayValue,y.value=p.exportValue,s.value.includes(p.exportValue)&&(y.setAttribute("selected",!0),o=!1),r.append(y)}let c=null;if(o){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),r.prepend(p),c=()=>{p.remove(),r.removeEventListener("input",c),c=null},r.addEventListener("input",c)}const u=p=>{const y=p?"value":"textContent",{options:b,multiple:A}=r;return A?Array.prototype.filter.call(b,_=>_.selected).map(_=>_[y]):b.selectedIndex===-1?null:b[b.selectedIndex][y]};let h=u(!1);const f=p=>{const y=p.target.options;return Array.prototype.map.call(y,b=>({displayValue:b.textContent,exportValue:b.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",p=>{const y={value(b){c?.();const A=b.detail.value,_=new Set(Array.isArray(A)?A:[A]);for(const S of r.options)S.selected=_.has(S.value);t.setValue(i,{value:u(!0)}),h=u(!1)},multipleSelection(b){r.multiple=!0},remove(b){const A=r.options,_=b.detail.remove;A[_].selected=!1,r.remove(_),A.length>0&&Array.prototype.findIndex.call(A,x=>x.selected)===-1&&(A[0].selected=!0),t.setValue(i,{value:u(!0),items:f(b)}),h=u(!1)},clear(b){for(;r.length!==0;)r.remove(0);t.setValue(i,{value:null,items:[]}),h=u(!1)},insert(b){const{index:A,displayValue:_,exportValue:S}=b.detail.insert,x=r.children[A],E=document.createElement("option");E.textContent=_,E.value=S,x?x.before(E):r.append(E),t.setValue(i,{value:u(!0),items:f(b)}),h=u(!1)},items(b){const{items:A}=b.detail;for(;r.length!==0;)r.remove(0);for(const _ of A){const{displayValue:S,exportValue:x}=_,E=document.createElement("option");E.textContent=S,E.value=x,r.append(E)}r.options.length>0&&(r.options[0].selected=!0),t.setValue(i,{value:u(!0),items:f(b)}),h=u(!1)},indices(b){const A=new Set(b.detail.indices);for(const _ of b.target.options)_.selected=A.has(_.index);t.setValue(i,{value:u(!0)}),h=u(!1)},editable(b){b.target.disabled=!b.detail.editable}};this._dispatchEventFromSandbox(y,p)}),r.addEventListener("input",p=>{const y=u(!0),b=u(!1);t.setValue(i,{value:y}),p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:h,change:b,changeEx:y,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):r.addEventListener("input",function(p){t.setValue(i,{value:u(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class Du extends Qt{constructor(t){const{data:i,elements:s,parent:r}=t,o=!!r._commentManager;if(super(t,{isRenderable:!o&&Qt._hasPopupData(i)}),this.elements=s,o&&Qt._hasPopupData(i)){const c=this.popup=this.#t();for(const u of s)u.popup=c}else this.popup=null}#t(){return new AA({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const i=this.popup=this.#t(),s=[];for(const r of this.elements)r.popup=i,r.container.ariaHasPopup="dialog",s.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(r=>`${ks}${r}`).join(",")),this.container}}class AA{#t=null;#e=this.#q.bind(this);#n=this.#U.bind(this);#i=this.#L.bind(this);#r=this.#_.bind(this);#a=null;#s=null;#l=null;#c=null;#o=null;#d=null;#h=null;#f=!1;#m=null;#p=null;#u=null;#g=null;#y=null;#v=null;#b=null;#x=null;#w=null;#S=null;#C=!1;#A=null;#E=null;constructor({container:t,color:i,elements:s,titleObj:r,modificationDate:o,contentsObj:c,richText:u,parent:h,rect:f,parentRect:p,open:y,commentManager:b=null}){this.#s=t,this.#w=r,this.#l=c,this.#x=u,this.#d=h,this.#a=i,this.#b=f,this.#h=p,this.#o=s,this.#t=b,this.#A=s[0],this.#c=_u.toDateObject(o),this.trigger=s.flatMap(A=>A.getElementsToTriggerPopup()),b||(this.#R(),this.#s.hidden=!0,y&&this.#_())}#R(){if(this.#p)return;this.#p=new AbortController;const{signal:t}=this.#p;for(const i of this.trigger)i.addEventListener("click",this.#r,{signal:t}),i.addEventListener("pointerenter",this.#i,{signal:t}),i.addEventListener("pointerleave",this.#n,{signal:t}),i.classList.add("popupTriggerArea");for(const i of this.#o)i.container?.addEventListener("keydown",this.#e,{signal:t})}#M(){const t=this.#o.find(i=>i.hasCommentButton);t&&(this.#y=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#g){this.#g.parentNode||this.#A.container.after(this.#g);return}if(this.#y||this.#M(),!this.#y)return;const{signal:t}=this.#p=new AbortController,i=this.#A.hasOwnCommentButton,s=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!i)},r=()=>{this.#t.toggleCommentPopup(this,!1,!0,!i)},o=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(i){this.#g=this.#A.container;for(const c of this.trigger)c.ariaHasPopup="dialog",c.ariaControls="commentPopup",c.addEventListener("keydown",this.#e,{signal:t}),c.addEventListener("click",s,{signal:t}),c.addEventListener("pointerenter",r,{signal:t}),c.addEventListener("pointerleave",o,{signal:t}),c.classList.add("popupTriggerArea")}else{const c=this.#g=document.createElement("button");c.className="annotationCommentButton";const u=this.#A.container;c.style.zIndex=u.style.zIndex+1,c.tabIndex=0,c.ariaHasPopup="dialog",c.ariaControls="commentPopup",c.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#P(),this.#D(),c.addEventListener("keydown",this.#e,{signal:t}),c.addEventListener("click",s,{signal:t}),c.addEventListener("pointerenter",r,{signal:t}),c.addEventListener("pointerleave",o,{signal:t}),u.after(c)}}#D(){if(this.#A.extraPopupElement&&!this.#A.editor)return;this.#g||this.renderCommentButton();const[t,i]=this.#y,{style:s}=this.#g;s.left=`calc(${t}%)`,s.top=`calc(${i}% - var(--comment-button-dim))`}#P(){this.#A.extraPopupElement||(this.#g||this.renderCommentButton(),this.#g.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:i}=this.#A.commentData;return t?this.#d._commentManager.makeCommentColor(t,i):null}focusCommentButton(){setTimeout(()=>{this.#g?.focus()},0)}getData(){const{richText:t,color:i,opacity:s,creationDate:r,modificationDate:o}=this.#A.commentData;return{contentsObj:{str:this.comment},richText:t,color:i,opacity:s,creationDate:r,modificationDate:o}}get elementBeforePopup(){return this.#g}get comment(){return this.#E||=this.#A.commentText,this.#E}set comment(t){t!==this.comment&&(this.#A.commentText=this.#E=t)}focus(){this.#A.container?.focus()}get parentBoundingClientRect(){return this.#A.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:i}){this.#g&&(this.#g.classList.toggle("selected",t),this.#g.ariaExpanded=i)}setSelectedCommentButton(t){this.#g.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#v)return this.#v;const{x:t,y:i,height:s}=this.#g.getBoundingClientRect(),{x:r,y:o,width:c,height:u}=this.#A.layer.getBoundingClientRect();return[(t-r)/c,(i+s-o)/u]}set commentPopupPosition(t){this.#v=t}hasDefaultPopupPosition(){return this.#v===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#g.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[i,s]=this.#v||this.commentButtonPosition.map(f=>f/100),r=this.parentBoundingClientRect,{x:o,y:c,width:u,height:h}=r;this.#t.showDialog(null,this,o+i*u,c+s*h,{...t,parentDimensions:r})}render(){if(this.#m)return;const t=this.#m=document.createElement("div");if(t.className="popup",this.#a){const s=t.style.outlineColor=it.makeHexColor(...this.#a);t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const i=document.createElement("span");if(i.className="header",this.#w?.str){const s=document.createElement("span");s.className="title",i.append(s),{dir:s.dir,str:s.textContent}=this.#w}if(t.append(i),this.#c){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),s.dateTime=this.#c.toISOString(),i.append(s)}$p({html:this.#N||this.#l.str,dir:this.#l?.dir,className:"popupContent"},t),this.#s.append(t)}get#N(){const t=this.#x,i=this.#l;return t?.str&&(!i?.str||i.str===t.str)&&this.#x.html||null}get#k(){return this.#N?.attributes?.style?.fontSize||0}get#F(){return this.#N?.attributes?.style?.color||null}#B(t){const i=[],s={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:i}]}},r={style:{color:this.#F,fontSize:this.#k?`calc(${this.#k}px * var(--total-scale-factor))`:""}};for(const o of t.split(`
`))i.push({name:"span",value:o,attributes:r});return s}#q(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#_()}updateEdited({rect:t,popup:i,deleted:s}){if(this.#t){s?(this.remove(),this.#E=null):i&&(i.deleted?this.remove():(this.#P(),this.#E=i.text)),t&&(this.#y=null,this.#M(),this.#D());return}if(s||i?.deleted){this.remove();return}this.#R(),this.#S||={contentsObj:this.#l,richText:this.#x},t&&(this.#u=null),i&&i.text&&(this.#x=this.#B(i.text),this.#c=_u.toDateObject(i.date),this.#l=null),this.#m?.remove(),this.#m=null}resetEdited(){this.#S&&({contentsObj:this.#l,richText:this.#x}=this.#S,this.#S=null,this.#m?.remove(),this.#m=null,this.#u=null)}remove(){if(this.#p?.abort(),this.#p=null,this.#m?.remove(),this.#m=null,this.#C=!1,this.#f=!1,this.#g?.remove(),this.#g=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#T(){if(this.#u!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:o}}}=this.#d;let c=!!this.#h,u=c?this.#h:this.#b;for(const _ of this.#o)if(!u||it.intersect(_.data.rect,u)!==null){u=_.data.rect,c=!0;break}const h=it.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),p=c?u[2]-u[0]+5:0,y=h[0]+p,b=h[1];this.#u=[100*(y-r)/i,100*(b-o)/s];const{style:A}=this.#s;A.left=`${this.#u[0]}%`,A.top=`${this.#u[1]}%`}#_(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#L(),this.#s.addEventListener("click",this.#r),this.#s.addEventListener("keydown",this.#e)):(this.#U(),this.#s.removeEventListener("click",this.#r),this.#s.removeEventListener("keydown",this.#e))}#L(){this.#m||this.render(),this.isVisible?this.#f&&this.#s.classList.add("focused"):(this.#T(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#U(){this.#s.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#C=this.isVisible,this.#C&&(this.#s.hidden=!0)}maybeShow(){this.#t||(this.#R(),this.#C&&(this.#m||this.#L(),this.#C=!1,this.#s.hidden=!1))}get isVisible(){return this.#t?!1:this.#s.hidden===!1}}class pm extends Qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=yt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=this.contentElement=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const i of this.textContent){const s=document.createElement("span");s.textContent=i,t.append(s)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class SA extends Qt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),o=this.#t=this.svgFactory.createElement("svg:line");return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class _A extends Qt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),o=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:rect");return c.setAttribute("x",o/2),c.setAttribute("y",o/2),c.setAttribute("width",i-o),c.setAttribute("height",s-o),c.setAttribute("stroke-width",o||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),r.append(c),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class wA extends Qt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),o=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:ellipse");return c.setAttribute("cx",i/2),c.setAttribute("cy",s/2),c.setAttribute("rx",i/2-o/2),c.setAttribute("ry",s/2-o/2),c.setAttribute("stroke-width",o||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),r.append(c),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class mm extends Qt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:i,borderStyle:s,popupRef:r},width:o,height:c}=this;if(!i)return this.container;const u=this.svgFactory.create(o,c,!0);let h=[];for(let p=0,y=i.length;p<y;p+=2){const b=i[p]-t[0],A=t[3]-i[p+1];h.push(`${b},${A}`)}h=h.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",h),f.setAttribute("stroke-width",s.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),u.append(f),this.container.append(u),!r&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class EA extends mm{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class xA extends Qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class qu extends Qt{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?yt.HIGHLIGHT:yt.INK}#n(t,i){switch(t){case 90:return{transform:`rotate(90) translate(${-i[0]},${i[1]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};case 180:return{transform:`rotate(180) translate(${-i[2]},${i[1]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]};case 270:return{transform:`rotate(270) translate(${-i[2]},${i[3]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};default:return{transform:`translate(${-i[0]},${i[3]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:i,inkLists:s,borderStyle:r,popupRef:o}}=this,{transform:c,width:u,height:h}=this.#n(i,t),f=this.svgFactory.create(u,h,!0),p=this.#t=this.svgFactory.createElement("svg:g");f.append(p),p.setAttribute("stroke-width",r.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",c);for(let y=0,b=s.length;y<b;y++){const A=this.svgFactory.createElement(this.svgElementName);this.#e.push(A),A.setAttribute("points",s[y].join(",")),p.append(A)}return!o&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:i,points:s,rect:r}=t,o=this.#t;if(i>=0&&o.setAttribute("stroke-width",i||1),s)for(let c=0,u=this.#e.length;c<u;c++)this.#e[c].setAttribute("points",s[c].join(","));if(r){const{transform:c,width:u,height:h}=this.#n(this.data.rotation,r);o.parentElement.setAttribute("viewBox",`0 0 ${u} ${h}`),o.setAttribute("transform",c)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class ym extends Qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=yt.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class TA extends Qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class CA extends Qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class MA extends Qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),t){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class bm extends Qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=yt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class DA extends Qt{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:i}=this.data;this.filename=i.filename,this.content=i.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:i}=this;let s;i.hasAppearance||i.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),s.addEventListener("dblclick",this.#e.bind(this)),this.#t=s;const{isMac:r}=de.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(r?o.metaKey:o.ctrlKey)&&this.#e()}),!i.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Vu{#t=null;#e=null;#n=null;#i=new Map;#r=null;#a=null;#s=[];#l=!1;constructor({div:t,accessibilityManager:i,annotationCanvasMap:s,annotationEditorUIManager:r,page:o,viewport:c,structTreeLayer:u,commentManager:h,linkService:f,annotationStorage:p}){this.div=t,this.#t=i,this.#e=s,this.#r=u||null,this.#a=f||null,this.#n=p||new Fu,this.page=o,this.viewport=c,this.zIndex=0,this._annotationEditorUIManager=r,this._commentManager=h||null}hasEditableAnnotations(){return this.#i.size>0}async render(t){const{annotations:i}=t,s=this.div;jn(s,this.viewport);const r=new Map,o=[],c={data:null,layer:s,linkService:this.#a,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Ol,annotationStorage:this.#n,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const u of i){if(u.noHTML)continue;const h=u.annotationType===ce.POPUP;if(h){const y=r.get(u.id);if(!y)continue;if(!this._commentManager){o.push(u);continue}c.elements=y}else if(u.rect[2]===u.rect[0]||u.rect[3]===u.rect[1])continue;c.data=u;const f=bu.create(c);if(!f.isRenderable)continue;if(!h&&(this.#s.push(f),u.popupRef)){const y=r.get(u.popupRef);y?y.push(f):r.set(u.popupRef,[f])}const p=f.render();u.hidden&&(p.style.visibility="hidden"),f._isEditable&&(this.#i.set(f.data.id,f),this._annotationEditorUIManager?.renderAnnotationElement(f))}await this.#c();for(const u of o){const h=c.elements=r.get(u.id);c.data=u;const f=bu.create(c);if(!f.isRenderable)continue;const p=f.render();f.contentElement.id=`${ks}${u.id}`,u.hidden&&(p.style.visibility="hidden"),h.at(-1).container.after(p)}this.#o()}async#c(){if(this.#s.length===0)return;this.div.replaceChildren();const t=[];if(!this.#l){this.#l=!0;for(const{contentElement:s,data:{id:r}}of this.#s){const o=s.id=`${ks}${r}`;t.push(this.#r?.getAriaAttributes(o).then(c=>{if(c)for(const[u,h]of c)s.setAttribute(u,h)}))}}this.#s.sort(({data:{rect:[s,r,o,c]}},{data:{rect:[u,h,f,p]}})=>{if(s===o&&r===c)return 1;if(u===f&&h===p)return-1;const y=c,b=r,A=(r+c)/2,_=p,S=h,x=(h+p)/2;if(A>=_&&x<=b)return-1;if(x>=y&&A<=S)return 1;const E=(s+o)/2,D=(u+f)/2;return E-D});const i=document.createDocumentFragment();for(const s of this.#s)i.append(s.container),this._commentManager?(s.extraPopupElement?.popup||s.popup)?.renderCommentButton():s.extraPopupElement&&i.append(s.extraPopupElement.render());if(this.div.append(i),await Promise.all(t),this.#t)for(const s of this.#s)this.#t.addPointerInTextLayer(s.contentElement,!1)}async addLinkAnnotations(t){const i={data:null,layer:this.div,linkService:this.#a,svgFactory:new Ol,parent:this};for(const s of t){s.borderStyle||=Vu._defaultBorderStyle,i.data=s;const r=bu.create(i);r.isRenderable&&(r.render(),r.contentElement.id=`${ks}${s.id}`,this.#s.push(r))}await this.#c()}update({viewport:t}){const i=this.div;this.viewport=t,jn(i,{rotation:t.rotation}),this.#o(),i.hidden=!1}#o(){if(!this.#e)return;const t=this.div;for(const[i,s]of this.#e){const r=t.querySelector(`[data-annotation-id="${i}"]`);if(!r)continue;s.className="annotationContent";const{firstChild:o}=r;o?o.nodeName==="CANVAS"?o.replaceWith(s):o.classList.contains("annotationContent")?o.after(s):o.before(s):r.append(s);const c=this.#i.get(i);c&&(c._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(i,r.id,s),c._hasNoCanvas=!1):c.canvas=s)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#i.values())}getEditableAnnotation(t){return this.#i.get(t)}addFakeAnnotation(t){const{div:i}=this,{id:s,rotation:r}=t,o=new fA({data:{id:s,rect:t.getPDFRect(),rotation:r},editor:t,layer:i,parent:this,enableComment:!!this._commentManager,linkService:this.#a,annotationStorage:this.#n});return o.render(),o.contentElement.id=`${ks}${s}`,o.createOrUpdatePopup(),this.#s.push(o),o}removeAnnotation(t){const i=this.#s.findIndex(r=>r.data.id===t);if(i<0)return;const[s]=this.#s.splice(i,1);this.#t?.removePointerInTextLayer(s.contentElement)}updateFakeAnnotations(t){if(t.length!==0){for(const i of t)i.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}static get _defaultBorderStyle(){return mt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Os.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const Tl=/\r\n?|\n/g;class ye extends ct{#t="";#e=`${this.id}-editor`;#n=null;#i;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=ye.prototype,i=o=>o.isEmpty(),s=Sn.TRANSLATE_SMALL,r=Sn.TRANSLATE_BIG;return mt(this,"_keyboardManager",new Ja([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:i}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:i}]]))}static _type="freetext";static _editorType=yt.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||ye._defaultColor||ct._defaultLineColor,this.#i=t.fontSize||ye._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(t,i){ct.initialize(t,i);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,i){switch(t){case Ct.FREETEXT_SIZE:ye._defaultFontSize=i;break;case Ct.FREETEXT_COLOR:ye._defaultColor=i;break}}updateParams(t,i){switch(t){case Ct.FREETEXT_SIZE:this.#r(i);break;case Ct.FREETEXT_COLOR:this.#a(i);break}}static get defaultPropertiesToUpdate(){return[[Ct.FREETEXT_SIZE,ye._defaultFontSize],[Ct.FREETEXT_COLOR,ye._defaultColor||ct._defaultLineColor]]}get propertiesToUpdate(){return[[Ct.FREETEXT_SIZE,this.#i],[Ct.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new Ka(this),[["colorPicker",this._colorPicker]]}get colorType(){return Ct.FREETEXT_COLOR}#r(t){const i=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-this.#i)*this.parentScale),this.#i=r,this.#l()},s=this.#i;this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ct.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#a(t){const i=r=>{this.color=r,this.onUpdatedColor()},s=this.color;this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ct.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,i){this._uiManager.translateSelectedEditors(t,i,!0)}getInitialTranslation(){const t=this.parentScale;return[-ye._internalPadding*t,-(ye._internalPadding+this.#i)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#n=new AbortController;const t=this._uiManager.combinedSignal(this.#n);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#n?.abort(),this.#n=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#s(){const t=[];this.editorDiv.normalize();let i=null;for(const s of this.editorDiv.childNodes)i?.nodeType===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(ye.#c(s)),i=s);return t.join(`
`)}#l(){const[t,i]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:r,div:o}=this,c=o.style.display,u=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",r.div.append(this.div),s=o.getBoundingClientRect(),o.remove(),o.style.display=c,o.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/i):(this.width=s.height/t,this.height=s.width/i),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,i=this.#t=this.#s().trimEnd();if(t===i)return;const s=r=>{if(this.#t=r,!r){this.remove();return}this.#o(),this._uiManager.rebuild(this),this.#l()};this.addCommands({cmd:()=>{s(i)},undo:()=>{s(t)},mustExec:!1}),this.#l()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){ye._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,i;(this._isCopy||this.annotationElementId)&&(t=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,s.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,o]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[u,h]=this.getInitialTranslation();[u,h]=this.pageTranslationToScreen(u,h);const[f,p]=this.pageDimensions,[y,b]=this.pageTranslation;let A,_;switch(this.rotation){case 0:A=t+(c[0]-y)/f,_=i+this.height-(c[1]-b)/p;break;case 90:A=t+(c[0]-y)/f,_=i-(c[1]-b)/p,[u,h]=[h,-u];break;case 180:A=t-this.width+(c[0]-y)/f,_=i-(c[1]-b)/p,[u,h]=[-u,-h];break;case 270:A=t+(c[0]-y-this.height*p)/f,_=i+(c[1]-b-this.width*f)/p,[u,h]=[-h,u];break}this.setAt(A*r,_*o,u,h)}else this._moveAfterPaste(t,i);this.#o(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Tl,"")}editorDivPaste(t){const i=t.clipboardData||window.clipboardData,{types:s}=i;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const r=ye.#h(i.getData("text")||"").replaceAll(Tl,`
`);if(!r)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const c=o.getRangeAt(0);if(!r.includes(`
`)){c.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:u,startOffset:h}=c,f=[],p=[];if(u.nodeType===Node.TEXT_NODE){const A=u.parentElement;if(p.push(u.nodeValue.slice(h).replaceAll(Tl,"")),A!==this.editorDiv){let _=f;for(const S of this.editorDiv.childNodes){if(S===A){_=p;continue}_.push(ye.#c(S))}}f.push(u.nodeValue.slice(0,h).replaceAll(Tl,""))}else if(u===this.editorDiv){let A=f,_=0;for(const S of this.editorDiv.childNodes)_++===h&&(A=p),A.push(ye.#c(S))}this.#t=`${f.join(`
`)}${r}${p.join(`
`)}`,this.#o();const y=new Range;let b=Math.sumPrecise(f.map(A=>A.length));for(const{firstChild:A}of this.editorDiv.childNodes)if(A.nodeType===Node.TEXT_NODE){const _=A.nodeValue.length;if(b<=_){y.setStart(A,b),y.setEnd(A,b);break}b-=_}o.removeAllRanges(),o.addRange(y)}#o(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const i=document.createElement("div");i.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(i)}}#d(){return this.#t.replaceAll(""," ")}static#h(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=ye._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,i,s){let r=null;if(t instanceof pm){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:h,rotation:f,id:p,popupRef:y,richText:b,contentsObj:A,creationDate:_,modificationDate:S},textContent:x,textPosition:E,parent:{page:{pageNumber:D}}}=t;if(!x||x.length===0)return null;r=t={annotationType:yt.FREETEXT,color:Array.from(u),fontSize:c,value:x.join(`
`),position:E,pageIndex:D-1,rect:h.slice(0),rotation:f,annotationElementId:p,id:p,deleted:!1,popupRef:y,comment:A?.str||null,richText:b,creationDate:_,modificationDate:S}}const o=await super.deserialize(t,i,s);return o.#i=t.fontSize,o.color=it.makeHexColor(...t.color),o.#t=ye.#h(t.value),o._initialData=r,t.comment&&o.setCommentData(t),o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=ct._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),s=Object.assign(super.serialize(t),{color:i,fontSize:this.#i,value:this.#d()});return this.addComment(s),t?(s.isCopy=!0,s):this.annotationElementId&&!this.#f(s)?null:(s.id=this.annotationElementId,s)}#f(t){const{value:i,fontSize:s,color:r,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==i||t.fontSize!==s||t.color.some((c,u)=>c!==r[u])||t.pageIndex!==o}renderAnnotationElement(t){const i=super.renderAnnotationElement(t);if(!i)return null;const{style:s}=i;s.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,s.color=this.color,i.replaceChildren();for(const r of this.#t.split(`
`)){const o=document.createElement("div");o.append(r?document.createTextNode(r):document.createElement("br")),i.append(o)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),i}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class nt{static PRECISION=1e-4;toSVGPath(){Gt("Abstract method `toSVGPath` must be implemented.")}get box(){Gt("Abstract getter `box` must be implemented.")}serialize(t,i){Gt("Abstract method `serialize` must be implemented.")}static _rescale(t,i,s,r,o,c){c||=new Float32Array(t.length);for(let u=0,h=t.length;u<h;u+=2)c[u]=i+t[u]*r,c[u+1]=s+t[u+1]*o;return c}static _rescaleAndSwap(t,i,s,r,o,c){c||=new Float32Array(t.length);for(let u=0,h=t.length;u<h;u+=2)c[u]=i+t[u+1]*r,c[u+1]=s+t[u]*o;return c}static _translate(t,i,s,r){r||=new Float32Array(t.length);for(let o=0,c=t.length;o<c;o+=2)r[o]=i+t[o],r[o+1]=s+t[o+1];return r}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,i,s,r,o){switch(o){case 90:return[1-i/s,t/r];case 180:return[1-t/s,1-i/r];case 270:return[i/s,1-t/r];default:return[t/s,i/r]}}static _normalizePagePoint(t,i,s){switch(s){case 90:return[1-i,t];case 180:return[1-t,1-i];case 270:return[i,1-t];default:return[t,i]}}static createBezierPoints(t,i,s,r,o,c){return[(t+5*s)/6,(i+5*r)/6,(5*s+o)/6,(5*r+c)/6,(s+o)/2,(r+c)/2]}}class Hn{#t;#e=[];#n;#i;#r=[];#a=new Float32Array(18);#s;#l;#c;#o;#d;#h;#f=[];static#m=8;static#p=2;static#u=Hn.#m+Hn.#p;constructor({x:t,y:i},s,r,o,c,u=0){this.#t=s,this.#h=o*r,this.#i=c,this.#a.set([NaN,NaN,NaN,NaN,t,i],6),this.#n=u,this.#o=Hn.#m*r,this.#c=Hn.#u*r,this.#d=r,this.#f.push(t,i)}isEmpty(){return isNaN(this.#a[8])}#g(){const t=this.#a.subarray(4,6),i=this.#a.subarray(16,18),[s,r,o,c]=this.#t;return[(this.#s+(t[0]-i[0])/2-s)/o,(this.#l+(t[1]-i[1])/2-r)/c,(this.#s+(i[0]-t[0])/2-s)/o,(this.#l+(i[1]-t[1])/2-r)/c]}add({x:t,y:i}){this.#s=t,this.#l=i;const[s,r,o,c]=this.#t;let[u,h,f,p]=this.#a.subarray(8,12);const y=t-f,b=i-p,A=Math.hypot(y,b);if(A<this.#c)return!1;const _=A-this.#o,S=_/A,x=S*y,E=S*b;let D=u,T=h;u=f,h=p,f+=x,p+=E,this.#f?.push(t,i);const B=-E/_,N=x/_,k=B*this.#h,z=N*this.#h;return this.#a.set(this.#a.subarray(2,8),0),this.#a.set([f+k,p+z],4),this.#a.set(this.#a.subarray(14,18),12),this.#a.set([f-k,p-z],16),isNaN(this.#a[6])?(this.#r.length===0&&(this.#a.set([u+k,h+z],2),this.#r.push(NaN,NaN,NaN,NaN,(u+k-s)/o,(h+z-r)/c),this.#a.set([u-k,h-z],14),this.#e.push(NaN,NaN,NaN,NaN,(u-k-s)/o,(h-z-r)/c)),this.#a.set([D,T,u,h,f,p],6),!this.isEmpty()):(this.#a.set([D,T,u,h,f,p],6),Math.abs(Math.atan2(T-h,D-u)-Math.atan2(E,x))<Math.PI/2?([u,h,f,p]=this.#a.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((u+f)/2-s)/o,((h+p)/2-r)/c),[u,h,D,T]=this.#a.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((D+u)/2-s)/o,((T+h)/2-r)/c),!0):([D,T,u,h,f,p]=this.#a.subarray(0,6),this.#r.push(((D+5*u)/6-s)/o,((T+5*h)/6-r)/c,((5*u+f)/6-s)/o,((5*h+p)/6-r)/c,((u+f)/2-s)/o,((h+p)/2-r)/c),[f,p,u,h,D,T]=this.#a.subarray(12,18),this.#e.push(((D+5*u)/6-s)/o,((T+5*h)/6-r)/c,((5*u+f)/6-s)/o,((5*h+p)/6-r)/c,((u+f)/2-s)/o,((h+p)/2-r)/c),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#r,i=this.#e;if(isNaN(this.#a[6])&&!this.isEmpty())return this.#y();const s=[];s.push(`M${t[4]} ${t[5]}`);for(let r=6;r<t.length;r+=6)isNaN(t[r])?s.push(`L${t[r+4]} ${t[r+5]}`):s.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);this.#b(s);for(let r=i.length-6;r>=6;r-=6)isNaN(i[r])?s.push(`L${i[r+4]} ${i[r+5]}`):s.push(`C${i[r]} ${i[r+1]} ${i[r+2]} ${i[r+3]} ${i[r+4]} ${i[r+5]}`);return this.#v(s),s.join(" ")}#y(){const[t,i,s,r]=this.#t,[o,c,u,h]=this.#g();return`M${(this.#a[2]-t)/s} ${(this.#a[3]-i)/r} L${(this.#a[4]-t)/s} ${(this.#a[5]-i)/r} L${o} ${c} L${u} ${h} L${(this.#a[16]-t)/s} ${(this.#a[17]-i)/r} L${(this.#a[14]-t)/s} ${(this.#a[15]-i)/r} Z`}#v(t){const i=this.#e;t.push(`L${i[4]} ${i[5]} Z`)}#b(t){const[i,s,r,o]=this.#t,c=this.#a.subarray(4,6),u=this.#a.subarray(16,18),[h,f,p,y]=this.#g();t.push(`L${(c[0]-i)/r} ${(c[1]-s)/o} L${h} ${f} L${p} ${y} L${(u[0]-i)/r} ${(u[1]-s)/o}`)}newFreeDrawOutline(t,i,s,r,o,c){return new vm(t,i,s,r,o,c)}getOutlines(){const t=this.#r,i=this.#e,s=this.#a,[r,o,c,u]=this.#t,h=new Float32Array((this.#f?.length??0)+2);for(let y=0,b=h.length-2;y<b;y+=2)h[y]=(this.#f[y]-r)/c,h[y+1]=(this.#f[y+1]-o)/u;if(h[h.length-2]=(this.#s-r)/c,h[h.length-1]=(this.#l-o)/u,isNaN(s[6])&&!this.isEmpty())return this.#x(h);const f=new Float32Array(this.#r.length+24+this.#e.length);let p=t.length;for(let y=0;y<p;y+=2){if(isNaN(t[y])){f[y]=f[y+1]=NaN;continue}f[y]=t[y],f[y+1]=t[y+1]}p=this.#S(f,p);for(let y=i.length-6;y>=6;y-=6)for(let b=0;b<6;b+=2){if(isNaN(i[y+b])){f[p]=f[p+1]=NaN,p+=2;continue}f[p]=i[y+b],f[p+1]=i[y+b+1],p+=2}return this.#w(f,p),this.newFreeDrawOutline(f,h,this.#t,this.#d,this.#n,this.#i)}#x(t){const i=this.#a,[s,r,o,c]=this.#t,[u,h,f,p]=this.#g(),y=new Float32Array(36);return y.set([NaN,NaN,NaN,NaN,(i[2]-s)/o,(i[3]-r)/c,NaN,NaN,NaN,NaN,(i[4]-s)/o,(i[5]-r)/c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(i[16]-s)/o,(i[17]-r)/c,NaN,NaN,NaN,NaN,(i[14]-s)/o,(i[15]-r)/c],0),this.newFreeDrawOutline(y,t,this.#t,this.#d,this.#n,this.#i)}#w(t,i){const s=this.#e;return t.set([NaN,NaN,NaN,NaN,s[4],s[5]],i),i+=6}#S(t,i){const s=this.#a.subarray(4,6),r=this.#a.subarray(16,18),[o,c,u,h]=this.#t,[f,p,y,b]=this.#g();return t.set([NaN,NaN,NaN,NaN,(s[0]-o)/u,(s[1]-c)/h,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,y,b,NaN,NaN,NaN,NaN,(r[0]-o)/u,(r[1]-c)/h],i),i+=24}}class vm extends nt{#t;#e=new Float32Array(4);#n;#i;#r;#a;#s;constructor(t,i,s,r,o,c){super(),this.#s=t,this.#r=i,this.#t=s,this.#a=r,this.#n=o,this.#i=c,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#l(c);const[u,h,f,p]=this.#e;for(let y=0,b=t.length;y<b;y+=2)t[y]=(t[y]-u)/f,t[y+1]=(t[y+1]-h)/p;for(let y=0,b=i.length;y<b;y+=2)i[y]=(i[y]-u)/f,i[y+1]=(i[y+1]-h)/p}toSVGPath(){const t=[`M${this.#s[4]} ${this.#s[5]}`];for(let i=6,s=this.#s.length;i<s;i+=6){if(isNaN(this.#s[i])){t.push(`L${this.#s[i+4]} ${this.#s[i+5]}`);continue}t.push(`C${this.#s[i]} ${this.#s[i+1]} ${this.#s[i+2]} ${this.#s[i+3]} ${this.#s[i+4]} ${this.#s[i+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,i,s,r],o){const c=s-t,u=r-i;let h,f;switch(o){case 0:h=nt._rescale(this.#s,t,r,c,-u),f=nt._rescale(this.#r,t,r,c,-u);break;case 90:h=nt._rescaleAndSwap(this.#s,t,i,c,u),f=nt._rescaleAndSwap(this.#r,t,i,c,u);break;case 180:h=nt._rescale(this.#s,s,i,-c,u),f=nt._rescale(this.#r,s,i,-c,u);break;case 270:h=nt._rescaleAndSwap(this.#s,s,r,-c,-u),f=nt._rescaleAndSwap(this.#r,s,r,-c,-u);break}return{outline:Array.from(h),points:[Array.from(f)]}}#l(t){const i=this.#s;let s=i[4],r=i[5];const o=[s,r,s,r];let c=s,u=r,h=s,f=r;const p=t?Math.max:Math.min,y=new Float32Array(4);for(let A=6,_=i.length;A<_;A+=6){const S=i[A+4],x=i[A+5];isNaN(i[A])?(it.pointBoundingBox(S,x,o),u>x?(c=S,u=x):u===x&&(c=p(c,S)),f<x?(h=S,f=x):f===x&&(h=p(h,S))):(y[0]=y[1]=1/0,y[2]=y[3]=-1/0,it.bezierBoundingBox(s,r,...i.slice(A,A+6),y),it.rectBoundingBox(y[0],y[1],y[2],y[3],o),u>y[1]?(c=y[0],u=y[1]):u===y[1]&&(c=p(c,y[0])),f<y[3]?(h=y[2],f=y[3]):f===y[3]&&(h=p(h,y[2]))),s=S,r=x}const b=this.#e;b[0]=o[0]-this.#n,b[1]=o[1]-this.#n,b[2]=o[2]-o[0]+2*this.#n,b[3]=o[3]-o[1]+2*this.#n,this.firstPoint=[c,u],this.lastPoint=[h,f]}get box(){return this.#e}newOutliner(t,i,s,r,o,c=0){return new Hn(t,i,s,r,o,c)}getNewOutline(t,i){const[s,r,o,c]=this.#e,[u,h,f,p]=this.#t,y=o*f,b=c*p,A=s*f+u,_=r*p+h,S=this.newOutliner({x:this.#r[0]*y+A,y:this.#r[1]*b+_},this.#t,this.#a,t,this.#i,i??this.#n);for(let x=2;x<this.#r.length;x+=2)S.add({x:this.#r[x]*y+A,y:this.#r[x+1]*b+_});return S.getOutlines()}}class Ru{#t;#e;#n;#i=[];#r=[];constructor(t,i=0,s=0,r=!0){const o=[1/0,1/0,-1/0,-1/0],c=10**-4;for(const{x:S,y:x,width:E,height:D}of t){const T=Math.floor((S-i)/c)*c,B=Math.ceil((S+E+i)/c)*c,N=Math.floor((x-i)/c)*c,k=Math.ceil((x+D+i)/c)*c,z=[T,N,k,!0],K=[B,N,k,!1];this.#i.push(z,K),it.rectBoundingBox(T,N,B,k,o)}const u=o[2]-o[0]+2*s,h=o[3]-o[1]+2*s,f=o[0]-s,p=o[1]-s;let y=r?-1/0:1/0,b=1/0;const A=this.#i.at(r?-1:-2),_=[A[0],A[2]];for(const S of this.#i){const[x,E,D,T]=S;!T&&r?E<b?(b=E,y=x):E===b&&(y=Math.max(y,x)):T&&!r&&(E<b?(b=E,y=x):E===b&&(y=Math.min(y,x))),S[0]=(x-f)/u,S[1]=(E-p)/h,S[2]=(D-p)/h}this.#t=new Float32Array([f,p,u,h]),this.#e=[y,b],this.#n=_}getOutlines(){this.#i.sort((i,s)=>i[0]-s[0]||i[1]-s[1]||i[2]-s[2]);const t=[];for(const i of this.#i)i[3]?(t.push(...this.#o(i)),this.#l(i)):(this.#c(i),t.push(...this.#o(i)));return this.#a(t)}#a(t){const i=[],s=new Set;for(const c of t){const[u,h,f]=c;i.push([u,h,c],[u,f,c])}i.sort((c,u)=>c[1]-u[1]||c[0]-u[0]);for(let c=0,u=i.length;c<u;c+=2){const h=i[c][2],f=i[c+1][2];h.push(f),f.push(h),s.add(h),s.add(f)}const r=[];let o;for(;s.size>0;){const c=s.values().next().value;let[u,h,f,p,y]=c;s.delete(c);let b=u,A=h;for(o=[u,f],r.push(o);;){let _;if(s.has(p))_=p;else if(s.has(y))_=y;else break;s.delete(_),[u,h,f,p,y]=_,b!==u&&(o.push(b,A,u,A===h?h:f),b=u),A=A===h?f:h}o.push(b,A)}return new RA(r,this.#t,this.#e,this.#n)}#s(t){const i=this.#r;let s=0,r=i.length-1;for(;s<=r;){const o=s+r>>1,c=i[o][0];if(c===t)return o;c<t?s=o+1:r=o-1}return r+1}#l([,t,i]){const s=this.#s(t);this.#r.splice(s,0,[t,i])}#c([,t,i]){const s=this.#s(t);for(let r=s;r<this.#r.length;r++){const[o,c]=this.#r[r];if(o!==t)break;if(o===t&&c===i){this.#r.splice(r,1);return}}for(let r=s-1;r>=0;r--){const[o,c]=this.#r[r];if(o!==t)break;if(o===t&&c===i){this.#r.splice(r,1);return}}}#o(t){const[i,s,r]=t,o=[[i,s,r]],c=this.#s(r);for(let u=0;u<c;u++){const[h,f]=this.#r[u];for(let p=0,y=o.length;p<y;p++){const[,b,A]=o[p];if(!(f<=b||A<=h)){if(b>=h){if(A>f)o[p][1]=f;else{if(y===1)return[];o.splice(p,1),p--,y--}continue}o[p][2]=h,A>f&&o.push([i,f,A])}}}return o}}class RA extends nt{#t;#e;constructor(t,i,s,r){super(),this.#e=t,this.#t=i,this.firstPoint=s,this.lastPoint=r}toSVGPath(){const t=[];for(const i of this.#e){let[s,r]=i;t.push(`M${s} ${r}`);for(let o=2;o<i.length;o+=2){const c=i[o],u=i[o+1];c===s?(t.push(`V${u}`),r=u):u===r&&(t.push(`H${c}`),s=c)}t.push("Z")}return t.join(" ")}serialize([t,i,s,r],o){const c=[],u=s-t,h=r-i;for(const f of this.#e){const p=new Array(f.length);for(let y=0;y<f.length;y+=2)p[y]=t+f[y]*u,p[y+1]=r-f[y+1]*h;c.push(p)}return c}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class Ou extends Hn{newFreeDrawOutline(t,i,s,r,o,c){return new OA(t,i,s,r,o,c)}}class OA extends vm{newOutliner(t,i,s,r,o,c=0){return new Ou(t,i,s,r,o,c)}}class ie extends ct{#t=null;#e=0;#n;#i=null;#r=null;#a=null;#s=null;#l=0;#c=null;#o=null;#d=null;#h=!1;#f=null;#m=null;#p=null;#u="";#g;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=yt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=ie.prototype;return mt(this,"_keyboardManager",new Ja([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||ie._defaultColor,this.#g=t.thickness||ie._defaultThickness,this.opacity=t.opacity||ie._defaultOpacity,this.#n=t.boxes||null,this.#y=t.methodOfCreation||"",this.#u=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#h=!0,this.#b(t),this.#A()):this.#n&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#s=t.focusNode,this.#l=t.focusOffset,this.#v(),this.#A(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#g,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#v(){const t=new Ru(this.#n,.001);this.#o=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#o.box;const i=new Ru(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#a=i.getOutlines();const{firstPoint:s}=this.#o;this.#f=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height];const{lastPoint:r}=this.#a;this.#m=[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height]}#b({highlightOutlines:t,highlightId:i,clipPathId:s}){this.#o=t;const r=1.5;if(this.#a=t.getNewOutline(this.#g/2+r,.0025),i>=0)this.#d=i,this.#i=s,this.parent.drawLayer.finalizeDraw(i,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#a.box,path:{d:this.#a.toSVGPath()}},!0);else if(this.parent){const y=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:ie.#E(this.#o.box,(y-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:ie.#E(this.#a.box,y),path:{d:this.#a.toSVGPath()}})}const[o,c,u,h]=t.box;switch(this.rotation){case 0:this.x=o,this.y=c,this.width=u,this.height=h;break;case 90:{const[y,b]=this.parentDimensions;this.x=c,this.y=1-o,this.width=u*b/y,this.height=h*y/b;break}case 180:this.x=1-o,this.y=1-c,this.width=u,this.height=h;break;case 270:{const[y,b]=this.parentDimensions;this.x=1-c,this.y=o,this.width=u*b/y,this.height=h*y/b;break}}const{firstPoint:f}=t;this.#f=[(f[0]-o)/u,(f[1]-c)/h];const{lastPoint:p}=this.#a;this.#m=[(p[0]-o)/u,(p[1]-c)/h]}static initialize(t,i){ct.initialize(t,i),ie._defaultColor||=i.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,i){switch(t){case Ct.HIGHLIGHT_COLOR:ie._defaultColor=i;break;case Ct.HIGHLIGHT_THICKNESS:ie._defaultThickness=i;break}}translateInPage(t,i){}get toolbarPosition(){return this.#m}get commentButtonPosition(){return this.#f}updateParams(t,i){switch(t){case Ct.HIGHLIGHT_COLOR:this.#x(i);break;case Ct.HIGHLIGHT_THICKNESS:this.#w(i);break}}static get defaultPropertiesToUpdate(){return[[Ct.HIGHLIGHT_COLOR,ie._defaultColor],[Ct.HIGHLIGHT_THICKNESS,ie._defaultThickness]]}get propertiesToUpdate(){return[[Ct.HIGHLIGHT_COLOR,this.color||ie._defaultColor],[Ct.HIGHLIGHT_THICKNESS,this.#g||ie._defaultThickness],[Ct.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#r?.updateColor(this.color),super.onUpdatedColor()}#x(t){const i=(o,c)=>{this.color=o,this.opacity=c,this.onUpdatedColor()},s=this.color,r=this.opacity;this.addCommands({cmd:i.bind(this,t,ie._defaultOpacity),undo:i.bind(this,s,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ct.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#w(t){const i=this.#g,s=r=>{this.#g=r,this.#S(r)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ct.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#r=new di({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#D())}getBaseTranslation(){return[0,0]}getRect(t,i){return super.getRect(t,i,this.#D())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#A(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let i=!1;this.parent&&!t?this.#C():t&&(this.#A(t),i=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),i&&this.select()}#S(t){this.#h&&(this.#b({highlightOutlines:this.#o.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())}#C(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#A(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#i}=t.drawLayer.draw({bbox:this.#o.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#o.toSVGPath()}},!1,!0),this.#p=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#a.box,path:{d:this.#a.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#i))}static#E([t,i,s,r],o){switch(o){case 90:return[1-i-r,t,r,s];case 180:return[1-t-s,1-i-r,s,r];case 270:return[i,1-t-s,r,s]}return[t,i,s,r]}rotate(t){const{drawLayer:i}=this.parent;let s;this.#h?(t=(t-this.rotation+360)%360,s=ie.#E(this.#o.box,t)):s=ie.#E([this.x,this.y,this.width,this.height],t),i.updateProperties(this.#d,{bbox:s,root:{"data-main-rotation":t}}),i.updateProperties(this.#p,{bbox:ie.#E(this.#a.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#u&&(t.setAttribute("aria-label",this.#u),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#R.bind(this),{signal:this._uiManager._signal});const i=this.#c=document.createElement("div");return t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=this.#i,this.setDims(),Zp(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#R(t){ie._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#M(!0);break;case 1:case 3:this.#M(!1);break}}#M(t){if(!this.#t)return;const i=window.getSelection();t?i.setPosition(this.#t,this.#e):i.setPosition(this.#s,this.#l)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#h||this.#M(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!t}}))}#D(){return this.#h?this.rotation:0}#P(){if(this.#h)return null;const[t,i]=this.pageDimensions,[s,r]=this.pageTranslation,o=this.#n,c=new Float32Array(o.length*8);let u=0;for(const{x:h,y:f,width:p,height:y}of o){const b=h*t+s,A=(1-f)*i+r;c[u]=c[u+4]=b,c[u+1]=c[u+3]=A,c[u+2]=c[u+6]=b+p*t,c[u+5]=c[u+7]=A-y*i,u+=8}return c}#N(t){return this.#o.serialize(t,this.#D())}static startHighlighting(t,i,{target:s,x:r,y:o}){const{x:c,y:u,width:h,height:f}=s.getBoundingClientRect(),p=new AbortController,y=t.combinedSignal(p),b=A=>{p.abort(),this.#F(t,A)};window.addEventListener("blur",b,{signal:y}),window.addEventListener("pointerup",b,{signal:y}),window.addEventListener("pointerdown",Jt,{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",fi,{signal:y}),s.addEventListener("pointermove",this.#k.bind(this,t),{signal:y}),this._freeHighlight=new Ou({x:r,y:o},[c,u,h,f],t.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#k(t,i){this._freeHighlight.add(i)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#F(t,i){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,i,s){let r=null;if(t instanceof ym){const{data:{quadPoints:_,rect:S,rotation:x,id:E,color:D,opacity:T,popupRef:B,richText:N,contentsObj:k,creationDate:z,modificationDate:K},parent:{page:{pageNumber:Q}}}=t;r=t={annotationType:yt.HIGHLIGHT,color:Array.from(D),opacity:T,quadPoints:_,boxes:null,pageIndex:Q-1,rect:S.slice(0),rotation:x,annotationElementId:E,id:E,deleted:!1,popupRef:B,richText:N,comment:k?.str||null,creationDate:z,modificationDate:K}}else if(t instanceof qu){const{data:{inkLists:_,rect:S,rotation:x,id:E,color:D,borderStyle:{rawWidth:T},popupRef:B,richText:N,contentsObj:k,creationDate:z,modificationDate:K},parent:{page:{pageNumber:Q}}}=t;r=t={annotationType:yt.HIGHLIGHT,color:Array.from(D),thickness:T,inkLists:_,boxes:null,pageIndex:Q-1,rect:S.slice(0),rotation:x,annotationElementId:E,id:E,deleted:!1,popupRef:B,richText:N,comment:k?.str||null,creationDate:z,modificationDate:K}}const{color:o,quadPoints:c,inkLists:u,opacity:h}=t,f=await super.deserialize(t,i,s);f.color=it.makeHexColor(...o),f.opacity=h||1,u&&(f.#g=t.thickness),f._initialData=r,t.comment&&f.setCommentData(t);const[p,y]=f.pageDimensions,[b,A]=f.pageTranslation;if(c){const _=f.#n=[];for(let S=0;S<c.length;S+=8)_.push({x:(c[S]-b)/p,y:1-(c[S+1]-A)/y,width:(c[S+2]-c[S])/p,height:(c[S+1]-c[S+5])/y});f.#v(),f.#A(),f.rotate(f.rotation)}else if(u){f.#h=!0;const _=u[0],S={x:_[0]-b,y:y-(_[1]-A)},x=new Ou(S,[0,0,p,y],1,f.#g/2,!0,.001);for(let T=0,B=_.length;T<B;T+=2)S.x=_[T]-b,S.y=y-(_[T+1]-A),x.add(S);const{id:E,clipPathId:D}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:x.toSVGPath()}},!0,!0);f.#b({highlightOutlines:x.getOutlines(),highlightId:E,clipPathId:D}),f.#A(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const i=ct._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s=super.serialize(t);return Object.assign(s,{color:i,opacity:this.opacity,thickness:this.#g,quadPoints:this.#P(),outlines:this.#N(s.rect)}),this.addComment(s),this.annotationElementId&&!this.#B(s)?null:(s.id=this.annotationElementId,s)}#B(t){const{color:i}=this._initialData;return this.hasEditedComment||t.color.some((s,r)=>s!==i[r])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class Am{#t=Object.create(null);updateProperty(t,i){this[t]=i,this.updateSVGProperty(t,i)}updateProperties(t){if(t)for(const[i,s]of Object.entries(t))i.startsWith("_")||this.updateProperty(i,s)}updateSVGProperty(t,i){this.#t[t]=i}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){Gt("Not implemented")}}class Nt extends ct{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#i=null;static#r=null;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#a(t),this.#c())}#a({drawOutlines:t,drawId:i,drawingOptions:s}){this.#t=t,this._drawingOptions||=s,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,t.defaultProperties)):this._drawId=this.#s(t,this.parent),this.#h(t.box)}#s(t,i){const{id:s}=i.drawLayer.draw(Nt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s}static _mergeSVGProperties(t,i){const s=new Set(Object.keys(t));for(const[r,o]of Object.entries(i))s.has(r)?Object.assign(t[r],o):t[r]=o;return t}static getDefaultDrawingOptions(t){Gt("Not implemented")}static get typesMap(){Gt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,i){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,i),this._currentParent&&(Nt.#n.updateProperty(s,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,i){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,i)}static get defaultPropertiesToUpdate(){const t=[],i=this._defaultDrawingOptions;for(const[s,r]of this.typesMap)t.push([s,i[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:i}=this;for(const[s,r]of this.constructor.typesMap)t.push([s,i[r]]);return t}_updateProperty(t,i,s){const r=this._drawingOptions,o=r[i],c=u=>{r.updateProperty(i,u);const h=this.#t.updateProperty(i,u);h&&this.#h(h),this.parent?.drawLayer.updateProperties(this._drawId,r.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:c.bind(this,s),undo:c.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Nt._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#d()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Nt._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#d()),{bbox:this.#f()}))}_onTranslating(t,i){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Nt._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#d(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#l(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let i=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#l()):t&&(this._uiManager.addShouldRescale(this),this.#c(t),i=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),i&&this.select()}#l(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#s(this.#t,t)}}#o([t,i,s,r]){const{parentDimensions:[o,c],rotation:u}=this;switch(u){case 90:return[i,1-t,s*(c/o),r*(o/c)];case 180:return[1-t,1-i,s,r];case 270:return[1-i,t,s*(c/o),r*(o/c)];default:return[t,i,s,r]}}#d(){const{x:t,y:i,width:s,height:r,parentDimensions:[o,c],rotation:u}=this;switch(u){case 90:return[1-i,t,s*(o/c),r*(c/o)];case 180:return[1-t,1-i,s,r];case 270:return[i,1-t,s*(o/c),r*(c/o)];default:return[t,i,s,r]}}#h(t){[this.x,this.y,this.width,this.height]=this.#o(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:t,y:i,width:s,height:r,rotation:o,parentRotation:c,parentDimensions:[u,h]}=this;switch((o*4+c)/90){case 1:return[1-i-r,t,r,s];case 2:return[1-t-s,1-i-r,s,r];case 3:return[i,1-t-s,r,s];case 4:return[t,i-s*(u/h),r*(h/u),s*(u/h)];case 5:return[1-i,t,s*(u/h),r*(h/u)];case 6:return[1-t-r*(h/u),1-i,r*(h/u),s*(u/h)];case 7:return[i-s*(u/h),1-t-r*(h/u),s*(u/h),r*(h/u)];case 8:return[t-s,i-r,s,r];case 9:return[1-i,t-s,r,s];case 10:return[1-t,1-i,s,r];case 11:return[i-r,1-t,r,s];case 12:return[t-r*(h/u),i,r*(h/u),s*(u/h)];case 13:return[1-i-s*(u/h),t-r*(h/u),s*(u/h),r*(h/u)];case 14:return[1-t,1-i-s*(u/h),r*(h/u),s*(u/h)];case 15:return[i,1-t,s*(u/h),r*(h/u)];default:return[t,i,s,r]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Nt._mergeSVGProperties({bbox:this.#f()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,i;this._isCopy&&(t=this.x,i=this.y);const s=super.render();s.classList.add("draw");const r=document.createElement("div");return s.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,i),s}static createDrawerInstance(t,i,s,r,o){Gt("Not implemented")}static startDrawing(t,i,s,r){const{target:o,offsetX:c,offsetY:u,pointerId:h,pointerType:f}=r;if(Lt.isInitializedAndDifferentPointerType(f))return;const{viewport:{rotation:p}}=t,{width:y,height:b}=o.getBoundingClientRect(),A=Nt.#i=new AbortController,_=t.combinedSignal(A);if(Lt.setPointer(f,h),window.addEventListener("pointerup",S=>{Lt.isSamePointerIdOrRemove(S.pointerId)&&this._endDraw(S)},{signal:_}),window.addEventListener("pointercancel",S=>{Lt.isSamePointerIdOrRemove(S.pointerId)&&this._currentParent.endDrawingSession()},{signal:_}),window.addEventListener("pointerdown",S=>{Lt.isSamePointerType(S.pointerType)&&(Lt.initializeAndAddPointerId(S.pointerId),Nt.#n.isCancellable()&&(Nt.#n.removeLastElement(),Nt.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:_}),window.addEventListener("contextmenu",fi,{signal:_}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:_}),o.addEventListener("touchmove",S=>{Lt.isSameTimeStamp(S.timeStamp)&&Jt(S)},{signal:_}),t.toggleDrawing(),i._editorUndoBar?.hide(),Nt.#n){t.drawLayer.updateProperties(this._currentDrawId,Nt.#n.startNew(c,u,y,b,p));return}i.updateUIForDefaultProperties(this),Nt.#n=this.createDrawerInstance(c,u,y,b,p),Nt.#r=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(Nt.#r.toSVGProperties(),Nt.#n.defaultSVGProperties),!0,!1)}static _drawMove(t){if(Lt.isSameTimeStamp(t.timeStamp),!Nt.#n)return;const{offsetX:i,offsetY:s,pointerId:r}=t;if(Lt.isSamePointerId(r)){if(Lt.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Nt.#n.add(i,s)),Lt.setTimeStamp(t.timeStamp),Jt(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,Nt.#n=null,Nt.#r=null,Lt.clearTimeStamp()),Nt.#i&&(Nt.#i.abort(),Nt.#i=null,Lt.clearPointerIds())}static _endDraw(t){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),t?.target===i.div&&i.drawLayer.updateProperties(this._currentDrawId,Nt.#n.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=Nt.#n,r=this._currentDrawId,o=s.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(r,s.setLastElement(o))},undo:()=>{i.drawLayer.updateProperties(r,s.removeLastElement())},mustExec:!1,type:Ct.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(Ct.DRAW_STEP),!Nt.#n.isEmpty()){const{pageDimensions:[s,r],scale:o}=i,c=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Nt.#n.getOutlines(s*o,r*o,o,this._INNER_MARGIN),drawingOptions:Nt.#r,mustBeCommitted:!t});return this._cleanup(!0),c}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,i,s,r,o,c){Gt("Not implemented")}static async deserialize(t,i,s){const{rawDims:{pageWidth:r,pageHeight:o,pageX:c,pageY:u}}=i.viewport,h=this.deserializeDraw(c,u,r,o,this._INNER_MARGIN,t),f=await super.deserialize(t,i,s);return f.createDrawingOptions(t),f.#a({drawOutlines:h}),f.#c(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[i,s]=this.pageTranslation,[r,o]=this.pageDimensions;return this.#t.serialize([i,s,r,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class NA{#t=new Float64Array(6);#e;#n;#i;#r;#a;#s="";#l=0;#c=new er;#o;#d;constructor(t,i,s,r,o,c){this.#o=s,this.#d=r,this.#i=o,this.#r=c,[t,i]=this.#h(t,i);const u=this.#e=[NaN,NaN,NaN,NaN,t,i];this.#a=[t,i],this.#n=[{line:u,points:this.#a}],this.#t.set(u,0)}updateProperty(t,i){t==="stroke-width"&&(this.#r=i)}#h(t,i){return nt._normalizePoint(t,i,this.#o,this.#d,this.#i)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#a.length<=10}add(t,i){[t,i]=this.#h(t,i);const[s,r,o,c]=this.#t.subarray(2,6),u=t-o,h=i-c;return Math.hypot(this.#o*u,this.#d*h)<=2?null:(this.#a.push(t,i),isNaN(s)?(this.#t.set([o,c,t,i],2),this.#e.push(NaN,NaN,NaN,NaN,t,i),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([s,r,o,c,t,i],0),this.#e.push(...nt.createBezierPoints(s,r,o,c,t,i)),{path:{d:this.toSVGPath()}}))}end(t,i){const s=this.add(t,i);return s||(this.#a.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,i,s,r,o){this.#o=s,this.#d=r,this.#i=o,[t,i]=this.#h(t,i);const c=this.#e=[NaN,NaN,NaN,NaN,t,i];this.#a=[t,i];const u=this.#n.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#n.push({line:c,points:this.#a}),this.#t.set(c,0),this.#l=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(t){return this.#n?(this.#n.push(t),this.#e=t.line,this.#a=t.points,this.#l=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#n)return this.#c.removeLastElement();this.#n.pop(),this.#s="";for(let t=0,i=this.#n.length;t<i;t++){const{line:s,points:r}=this.#n[t];this.#e=s,this.#a=r,this.#l=0,this.toSVGPath()}return{path:{d:this.#s}}}toSVGPath(){const t=nt.svgRound(this.#e[4]),i=nt.svgRound(this.#e[5]);if(this.#a.length===2)return this.#s=`${this.#s} M ${t} ${i} Z`,this.#s;if(this.#a.length<=6){const r=this.#s.lastIndexOf("M");this.#s=`${this.#s.slice(0,r)} M ${t} ${i}`,this.#l=6}if(this.#a.length===4){const r=nt.svgRound(this.#e[10]),o=nt.svgRound(this.#e[11]);return this.#s=`${this.#s} L ${r} ${o}`,this.#l=12,this.#s}const s=[];this.#l===0&&(s.push(`M ${t} ${i}`),this.#l=6);for(let r=this.#l,o=this.#e.length;r<o;r+=6){const[c,u,h,f,p,y]=this.#e.slice(r,r+6).map(nt.svgRound);s.push(`C${c} ${u} ${h} ${f} ${p} ${y}`)}return this.#s+=s.join(" "),this.#l=this.#e.length,this.#s}getOutlines(t,i,s,r){const o=this.#n.at(-1);return o.line=new Float32Array(o.line),o.points=new Float32Array(o.points),this.#c.build(this.#n,t,i,s,this.#i,this.#r,r),this.#t=null,this.#e=null,this.#n=null,this.#s=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class er extends nt{#t;#e=0;#n;#i;#r;#a;#s;#l;#c;build(t,i,s,r,o,c,u){this.#r=i,this.#a=s,this.#s=r,this.#l=o,this.#c=c,this.#n=u??0,this.#i=t,this.#h()}get thickness(){return this.#c}setLastElement(t){return this.#i.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:i}of this.#i){if(t.push(`M${nt.svgRound(i[4])} ${nt.svgRound(i[5])}`),i.length===6){t.push("Z");continue}if(i.length===12&&isNaN(i[6])){t.push(`L${nt.svgRound(i[10])} ${nt.svgRound(i[11])}`);continue}for(let s=6,r=i.length;s<r;s+=6){const[o,c,u,h,f,p]=i.subarray(s,s+6).map(nt.svgRound);t.push(`C${o} ${c} ${u} ${h} ${f} ${p}`)}}return t.join("")}serialize([t,i,s,r],o){const c=[],u=[],[h,f,p,y]=this.#d();let b,A,_,S,x,E,D,T,B;switch(this.#l){case 0:B=nt._rescale,b=t,A=i+r,_=s,S=-r,x=t+h*s,E=i+(1-f-y)*r,D=t+(h+p)*s,T=i+(1-f)*r;break;case 90:B=nt._rescaleAndSwap,b=t,A=i,_=s,S=r,x=t+f*s,E=i+h*r,D=t+(f+y)*s,T=i+(h+p)*r;break;case 180:B=nt._rescale,b=t+s,A=i,_=-s,S=r,x=t+(1-h-p)*s,E=i+f*r,D=t+(1-h)*s,T=i+(f+y)*r;break;case 270:B=nt._rescaleAndSwap,b=t+s,A=i+r,_=-s,S=-r,x=t+(1-f-y)*s,E=i+(1-h-p)*r,D=t+(1-f)*s,T=i+(1-h)*r;break}for(const{line:N,points:k}of this.#i)c.push(B(N,b,A,_,S,o?new Array(N.length):null)),u.push(B(k,b,A,_,S,o?new Array(k.length):null));return{lines:c,points:u,rect:[x,E,D,T]}}static deserialize(t,i,s,r,o,{paths:{lines:c,points:u},rotation:h,thickness:f}){const p=[];let y,b,A,_,S;switch(h){case 0:S=nt._rescale,y=-t/s,b=i/r+1,A=1/s,_=-1/r;break;case 90:S=nt._rescaleAndSwap,y=-i/r,b=-t/s,A=1/r,_=1/s;break;case 180:S=nt._rescale,y=t/s+1,b=-i/r,A=-1/s,_=1/r;break;case 270:S=nt._rescaleAndSwap,y=i/r+1,b=t/s+1,A=-1/r,_=-1/s;break}if(!c){c=[];for(const E of u){const D=E.length;if(D===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1]]));continue}if(D===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1],NaN,NaN,NaN,NaN,E[2],E[3]]));continue}const T=new Float32Array(3*(D-2));c.push(T);let[B,N,k,z]=E.subarray(0,4);T.set([NaN,NaN,NaN,NaN,B,N],0);for(let K=4;K<D;K+=2){const Q=E[K],et=E[K+1];T.set(nt.createBezierPoints(B,N,k,z,Q,et),(K-2)*3),[B,N,k,z]=[k,z,Q,et]}}}for(let E=0,D=c.length;E<D;E++)p.push({line:S(c[E].map(T=>T??NaN),y,b,A,_),points:S(u[E].map(T=>T??NaN),y,b,A,_)});const x=new this.prototype.constructor;return x.build(p,s,r,1,h,f,o),x}#o(t=this.#c){const i=this.#n+t/2*this.#s;return this.#l%180===0?[i/this.#r,i/this.#a]:[i/this.#a,i/this.#r]}#d(){const[t,i,s,r]=this.#t,[o,c]=this.#o(0);return[t+o,i+c,s-2*o,r-2*c]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:r}of this.#i){if(r.length<=12){for(let u=4,h=r.length;u<h;u+=6)it.pointBoundingBox(r[u],r[u+1],t);continue}let o=r[4],c=r[5];for(let u=6,h=r.length;u<h;u+=6){const[f,p,y,b,A,_]=r.subarray(u,u+6);it.bezierBoundingBox(o,c,f,p,y,b,A,_,t),o=A,c=_}}const[i,s]=this.#o();t[0]=Oe(t[0]-i,0,1),t[1]=Oe(t[1]-s,0,1),t[2]=Oe(t[2]+i,0,1),t[3]=Oe(t[3]+s,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,i){return t==="stroke-width"?this.#f(i):null}#f(t){const[i,s]=this.#o();this.#c=t;const[r,o]=this.#o(),[c,u]=[r-i,o-s],h=this.#t;return h[0]-=c,h[1]-=u,h[2]+=2*c,h[3]+=2*u,h}updateParentDimensions([t,i],s){const[r,o]=this.#o();this.#r=t,this.#a=i,this.#s=s;const[c,u]=this.#o(),h=c-r,f=u-o,p=this.#t;return p[0]-=h,p[1]-=f,p[2]+=2*h,p[3]+=2*f,p}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(nt.svgRound).join(" ")}get defaultProperties(){const[t,i]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${nt.svgRound(t)} ${nt.svgRound(i)}`}}}get rotationTransform(){const[,,t,i]=this.#t;let s=0,r=0,o=0,c=0,u=0,h=0;switch(this.#e){case 90:r=i/t,o=-t/i,u=t;break;case 180:s=-1,c=-1,u=t,h=i;break;case 270:r=-i/t,o=t/i,h=i;break;default:return""}return`matrix(${s} ${r} ${o} ${c} ${nt.svgRound(u)} ${nt.svgRound(h)})`}getPathResizingSVGProperties([t,i,s,r]){const[o,c]=this.#o(),[u,h,f,p]=this.#t;if(Math.abs(f-o)<=nt.PRECISION||Math.abs(p-c)<=nt.PRECISION){const S=t+s/2-(u+f/2),x=i+r/2-(h+p/2);return{path:{"transform-origin":`${nt.svgRound(t)} ${nt.svgRound(i)}`,transform:`${this.rotationTransform} translate(${S} ${x})`}}}const y=(s-2*o)/(f-2*o),b=(r-2*c)/(p-2*c),A=f/s,_=p/r;return{path:{"transform-origin":`${nt.svgRound(u)} ${nt.svgRound(h)}`,transform:`${this.rotationTransform} scale(${A} ${_}) translate(${nt.svgRound(o)} ${nt.svgRound(c)}) scale(${y} ${b}) translate(${nt.svgRound(-o)} ${nt.svgRound(-c)})`}}}getPathResizedSVGProperties([t,i,s,r]){const[o,c]=this.#o(),u=this.#t,[h,f,p,y]=u;if(u[0]=t,u[1]=i,u[2]=s,u[3]=r,Math.abs(p-o)<=nt.PRECISION||Math.abs(y-c)<=nt.PRECISION){const x=t+s/2-(h+p/2),E=i+r/2-(f+y/2);for(const{line:D,points:T}of this.#i)nt._translate(D,x,E,D),nt._translate(T,x,E,T);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${nt.svgRound(t)} ${nt.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const b=(s-2*o)/(p-2*o),A=(r-2*c)/(y-2*c),_=-b*(h+o)+t+o,S=-A*(f+c)+i+c;if(b!==1||A!==1||_!==0||S!==0)for(const{line:x,points:E}of this.#i)nt._rescale(x,_,S,b,A,x),nt._rescale(E,_,S,b,A,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${nt.svgRound(t)} ${nt.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,i],s){const[r,o]=s,c=this.#t,u=t-c[0],h=i-c[1];if(this.#r===r&&this.#a===o)for(const{line:f,points:p}of this.#i)nt._translate(f,u,h,f),nt._translate(p,u,h,p);else{const f=this.#r/r,p=this.#a/o;this.#r=r,this.#a=o;for(const{line:y,points:b}of this.#i)nt._rescale(y,u,h,f,p,y),nt._rescale(b,u,h,f,p,b);c[2]*=f,c[3]*=p}return c[0]=t,c[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${nt.svgRound(t)} ${nt.svgRound(i)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${nt.svgRound(t[0])} ${nt.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class Fl extends Am{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:ct._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,i){t==="stroke-width"&&(i??=this["stroke-width"],i*=this._viewParameters.realScale),super.updateSVGProperty(t,i)}clone(){const t=new Fl(this._viewParameters);return t.updateAll(this),t}}class Xu extends Nt{static _type="ink";static _editorType=yt.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,i){ct.initialize(t,i),this._defaultDrawingOptions=new Fl(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!0}static get typesMap(){return mt(this,"typesMap",new Map([[Ct.INK_THICKNESS,"stroke-width"],[Ct.INK_COLOR,"stroke"],[Ct.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,i,s,r,o){return new NA(t,i,s,r,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,i,s,r,o,c){return er.deserialize(t,i,s,r,o,c)}static async deserialize(t,i,s){let r=null;if(t instanceof qu){const{data:{inkLists:c,rect:u,rotation:h,id:f,color:p,opacity:y,borderStyle:{rawWidth:b},popupRef:A,richText:_,contentsObj:S,creationDate:x,modificationDate:E},parent:{page:{pageNumber:D}}}=t;r=t={annotationType:yt.INK,color:Array.from(p),thickness:b,opacity:y,paths:{points:c},boxes:null,pageIndex:D-1,rect:u.slice(0),rotation:h,annotationElementId:f,id:f,deleted:!1,popupRef:A,richText:_,comment:S?.str||null,creationDate:x,modificationDate:E}}const o=await super.deserialize(t,i,s);return o._initialData=r,t.comment&&o.setCommentData(t),o}get toolbarButtons(){return this._colorPicker||=new Ka(this),[["colorPicker",this._colorPicker]]}get colorType(){return Ct.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:i,parent:s}=this;i.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,i.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:i,opacity:s}){this._drawingOptions=Xu.getDefaultDrawingOptions({stroke:it.makeHexColor(...t),"stroke-width":i,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:i,points:s}=this.serializeDraw(t),{_drawingOptions:{stroke:r,"stroke-opacity":o,"stroke-width":c}}=this,u=Object.assign(super.serialize(t),{color:ct._colorManager.convert(r),opacity:o,thickness:c,paths:{lines:i,points:s}});return this.addComment(u),t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:i,thickness:s,opacity:r,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((c,u)=>c!==i[u])||t.thickness!==s||t.opacity!==r||t.pageIndex!==o}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:i,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:i,popup:this.comment}),null}}class Nu extends er{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const Cl=8,Ia=3;class Ls{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,i,s,r){return s-=t,r-=i,s===0?r>0?0:4:s===1?r+6:2-r}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#i(t,i,s,r,o,c,u){const h=this.#e(s,r,o,c);for(let f=0;f<8;f++){const p=(-f+h-u+16)%8,y=this.#n[2*p],b=this.#n[2*p+1];if(t[(s+y)*i+(r+b)]!==0)return p}return-1}static#r(t,i,s,r,o,c,u){const h=this.#e(s,r,o,c);for(let f=0;f<8;f++){const p=(f+h+u+16)%8,y=this.#n[2*p],b=this.#n[2*p+1];if(t[(s+y)*i+(r+b)]!==0)return p}return-1}static#a(t,i,s,r){const o=t.length,c=new Int32Array(o);for(let p=0;p<o;p++)c[p]=t[p]<=r?1:0;for(let p=1;p<s-1;p++)c[p*i]=c[p*i+i-1]=0;for(let p=0;p<i;p++)c[p]=c[i*s-1-p]=0;let u=1,h;const f=[];for(let p=1;p<s-1;p++){h=1;for(let y=1;y<i-1;y++){const b=p*i+y,A=c[b];if(A===0)continue;let _=p,S=y;if(A===1&&c[b-1]===0)u+=1,S-=1;else if(A>=1&&c[b+1]===0)u+=1,S+=1,A>1&&(h=A);else{A!==1&&(h=Math.abs(A));continue}const x=[y,p],E=S===y+1,D={isHole:E,points:x,id:u,parent:0};f.push(D);let T;for(const W of f)if(W.id===h){T=W;break}T?T.isHole?D.parent=E?T.parent:h:D.parent=E?h:T.parent:D.parent=E?h:0;const B=this.#i(c,i,p,y,_,S,0);if(B===-1){c[b]=-u,c[b]!==1&&(h=Math.abs(c[b]));continue}let N=this.#n[2*B],k=this.#n[2*B+1];const z=p+N,K=y+k;_=z,S=K;let Q=p,et=y;for(;;){const W=this.#r(c,i,Q,et,_,S,1);N=this.#n[2*W],k=this.#n[2*W+1];const dt=Q+N,_t=et+k;x.push(_t,dt);const ft=Q*i+et;if(c[ft+1]===0?c[ft]=-u:c[ft]===1&&(c[ft]=u),dt===p&&_t===y&&Q===z&&et===K){c[b]!==1&&(h=Math.abs(c[b]));break}else _=Q,S=et,Q=dt,et=_t}}}return f}static#s(t,i,s,r){if(s-i<=4){for(let z=i;z<s-2;z+=2)r.push(t[z],t[z+1]);return}const o=t[i],c=t[i+1],u=t[s-4]-o,h=t[s-3]-c,f=Math.hypot(u,h),p=u/f,y=h/f,b=p*c-y*o,A=h/u,_=1/f,S=Math.atan(A),x=Math.cos(S),E=Math.sin(S),D=_*(Math.abs(x)+Math.abs(E)),T=_*(1-D+D**2),B=Math.max(Math.atan(Math.abs(E+x)*T),Math.atan(Math.abs(E-x)*T));let N=0,k=i;for(let z=i+2;z<s-2;z+=2){const K=Math.abs(b-p*t[z+1]+y*t[z]);K>N&&(k=z,N=K)}N>(f*B)**2?(this.#s(t,i,k+2,r),this.#s(t,k,s,r)):r.push(o,c)}static#l(t){const i=[],s=t.length;return this.#s(t,0,s,i),i.push(t[s-2],t[s-1]),i.length<=4?null:i}static#c(t,i,s,r,o,c){const u=new Float32Array(c**2),h=-2*r**2,f=c>>1;for(let S=0;S<c;S++){const x=(S-f)**2;for(let E=0;E<c;E++)u[S*c+E]=Math.exp((x+(E-f)**2)/h)}const p=new Float32Array(256),y=-2*o**2;for(let S=0;S<256;S++)p[S]=Math.exp(S**2/y);const b=t.length,A=new Uint8Array(b),_=new Uint32Array(256);for(let S=0;S<s;S++)for(let x=0;x<i;x++){const E=S*i+x,D=t[E];let T=0,B=0;for(let k=0;k<c;k++){const z=S+k-f;if(!(z<0||z>=s))for(let K=0;K<c;K++){const Q=x+K-f;if(Q<0||Q>=i)continue;const et=t[z*i+Q],W=u[k*c+K]*p[Math.abs(et-D)];T+=et*W,B+=W}}const N=A[E]=Math.round(T/B);_[N]++}return[A,_]}static#o(t){const i=new Uint32Array(256);for(const s of t)i[s]++;return i}static#d(t){const i=t.length,s=new Uint8ClampedArray(i>>2);let r=-1/0,o=1/0;for(let u=0,h=s.length;u<h;u++){const f=s[u]=t[u<<2];r=Math.max(r,f),o=Math.min(o,f)}const c=255/(r-o);for(let u=0,h=s.length;u<h;u++)s[u]=(s[u]-o)*c;return s}static#h(t){let i,s=-1/0,r=-1/0;const o=t.findIndex(h=>h!==0);let c=o,u=o;for(i=o;i<256;i++){const h=t[i];h>s&&(i-c>r&&(r=i-c,u=i-1),s=h,c=i)}for(i=u-1;i>=0&&!(t[i]>t[i+1]);i--);return i}static#f(t){const i=t,{width:s,height:r}=t,{maxDim:o}=this.#t;let c=s,u=r;if(s>o||r>o){let b=s,A=r,_=Math.log2(Math.max(s,r)/o);const S=Math.floor(_);_=_===S?S-1:S;for(let E=0;E<_;E++){c=Math.ceil(b/2),u=Math.ceil(A/2);const D=new OffscreenCanvas(c,u);D.getContext("2d").drawImage(t,0,0,b,A,0,0,c,u),b=c,A=u,t!==i&&t.close(),t=D.transferToImageBitmap()}const x=Math.min(o/c,o/u);c=Math.round(c*x),u=Math.round(u*x)}const f=new OffscreenCanvas(c,u).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,c,u),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,c,u);const p=f.getImageData(0,0,c,u).data;return[this.#d(p),c,u]}static extractContoursFromText(t,{fontFamily:i,fontStyle:s,fontWeight:r},o,c,u,h){let f=new OffscreenCanvas(1,1),p=f.getContext("2d",{alpha:!1});const y=200,b=p.font=`${s} ${r} ${y}px ${i}`,{actualBoundingBoxLeft:A,actualBoundingBoxRight:_,actualBoundingBoxAscent:S,actualBoundingBoxDescent:x,fontBoundingBoxAscent:E,fontBoundingBoxDescent:D,width:T}=p.measureText(t),B=1.5,N=Math.ceil(Math.max(Math.abs(A)+Math.abs(_)||0,T)*B),k=Math.ceil(Math.max(Math.abs(S)+Math.abs(x)||y,Math.abs(E)+Math.abs(D)||y)*B);f=new OffscreenCanvas(N,k),p=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),p.font=b,p.filter="grayscale(1)",p.fillStyle="white",p.fillRect(0,0,N,k),p.fillStyle="black",p.fillText(t,N*(B-1)/2,k*(3-B)/2);const z=this.#d(p.getImageData(0,0,N,k).data),K=this.#o(z),Q=this.#h(K),et=this.#a(z,N,k,Q);return this.processDrawnLines({lines:{curves:et,width:N,height:k},pageWidth:o,pageHeight:c,rotation:u,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(t,i,s,r,o){const[c,u,h]=this.#f(t),[f,p]=this.#c(c,u,h,Math.hypot(u,h)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),y=this.#h(p),b=this.#a(f,u,h,y);return this.processDrawnLines({lines:{curves:b,width:u,height:h},pageWidth:i,pageHeight:s,rotation:r,innerMargin:o,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:i,pageHeight:s,rotation:r,innerMargin:o,mustSmooth:c,areContours:u}){r%180!==0&&([i,s]=[s,i]);const{curves:h,width:f,height:p}=t,y=t.thickness??0,b=[],A=Math.min(i/f,s/p),_=A/i,S=A/s,x=[];for(const{points:D}of h){const T=c?this.#l(D):D;if(!T)continue;x.push(T);const B=T.length,N=new Float32Array(B),k=new Float32Array(3*(B===2?2:B-2));if(b.push({line:k,points:N}),B===2){N[0]=T[0]*_,N[1]=T[1]*S,k.set([NaN,NaN,NaN,NaN,N[0],N[1]],0);continue}let[z,K,Q,et]=T;z*=_,K*=S,Q*=_,et*=S,N.set([z,K,Q,et],0),k.set([NaN,NaN,NaN,NaN,z,K],0);for(let W=4;W<B;W+=2){const dt=N[W]=T[W]*_,_t=N[W+1]=T[W+1]*S;k.set(nt.createBezierPoints(z,K,Q,et,dt,_t),(W-2)*3),[z,K,Q,et]=[Q,et,dt,_t]}}if(b.length===0)return null;const E=u?new Nu:new er;return E.build(b,i,s,1,r,u?0:y,o),{outline:E,newCurves:x,areContours:u,thickness:y,width:f,height:p}}static async compressSignature({outlines:t,areContours:i,thickness:s,width:r,height:o}){let c=1/0,u=-1/0,h=0;for(const T of t){h+=T.length;for(let B=2,N=T.length;B<N;B++){const k=T[B]-T[B-2];c=Math.min(c,k),u=Math.max(u,k)}}let f;c>=-128&&u<=127?f=Int8Array:c>=-32768&&u<=32767?f=Int16Array:f=Int32Array;const p=t.length,y=Cl+Ia*p,b=new Uint32Array(y);let A=0;b[A++]=y*Uint32Array.BYTES_PER_ELEMENT+(h-2*p)*f.BYTES_PER_ELEMENT,b[A++]=0,b[A++]=r,b[A++]=o,b[A++]=i?0:1,b[A++]=Math.max(0,Math.floor(s??0)),b[A++]=p,b[A++]=f.BYTES_PER_ELEMENT;for(const T of t)b[A++]=T.length-2,b[A++]=T[0],b[A++]=T[1];const _=new CompressionStream("deflate-raw"),S=_.writable.getWriter();await S.ready,S.write(b);const x=f.prototype.constructor;for(const T of t){const B=new x(T.length-2);for(let N=2,k=T.length;N<k;N++)B[N-2]=T[N]-T[N-2];S.write(B)}S.close();const E=await new Response(_.readable).arrayBuffer(),D=new Uint8Array(E);return Yp(D)}static async decompressSignature(t){try{const i=Yb(t),{readable:s,writable:r}=new DecompressionStream("deflate-raw"),o=r.getWriter();await o.ready,o.write(i).then(async()=>{await o.ready,await o.close()}).catch(()=>{});let c=null,u=0;for await(const T of s)c||=new Uint8Array(new Uint32Array(T.buffer,0,4)[0]),c.set(T,u),u+=T.length;const h=new Uint32Array(c.buffer,0,c.length>>2),f=h[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const p=h[2],y=h[3],b=h[4]===0,A=h[5],_=h[6],S=h[7],x=[],E=(Cl+Ia*_)*Uint32Array.BYTES_PER_ELEMENT;let D;switch(S){case Int8Array.BYTES_PER_ELEMENT:D=new Int8Array(c.buffer,E);break;case Int16Array.BYTES_PER_ELEMENT:D=new Int16Array(c.buffer,E);break;case Int32Array.BYTES_PER_ELEMENT:D=new Int32Array(c.buffer,E);break}u=0;for(let T=0;T<_;T++){const B=h[Ia*T+Cl],N=new Float32Array(B+2);x.push(N);for(let k=0;k<Ia-1;k++)N[k]=h[Ia*T+Cl+k+1];for(let k=0;k<B;k++)N[k+2]=N[k]+D[u++]}return{areContours:b,thickness:A,outlines:x,width:p,height:y}}catch(i){return pt(`decompressSignature: ${i}`),null}}}class Yu extends Am{constructor(){super(),super.updateProperties({fill:ct._defaultLineColor,"stroke-width":0})}clone(){const t=new Yu;return t.updateAll(this),t}}class Ku extends Fl{constructor(t){super(t),super.updateProperties({stroke:ct._defaultLineColor,"stroke-width":1})}clone(){const t=new Ku(this._viewParameters);return t.updateAll(this),t}}class wi extends Nt{#t=!1;#e=null;#n=null;#i=null;static _type="signature";static _editorType=yt.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,i){ct.initialize(t,i),this._defaultDrawingOptions=new Yu,this._defaultDrawnSignatureOptions=new Ku(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!1}static get typesMap(){return mt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const i=t.get("hasDescription");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,i;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,t=this.x,i=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:r,mustSmooth:o,areContours:c,description:u,uuid:h,heightInPage:f}=this.#n,{rawDims:{pageWidth:p,pageHeight:y},rotation:b}=this.parent.viewport,A=Ls.processDrawnLines({lines:r,pageWidth:p,pageHeight:y,rotation:b,innerMargin:wi._INNER_MARGIN,mustSmooth:o,areContours:c});this.addSignature(A,f,u,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return s&&(this._isCopy=!0,this._moveAfterPaste(t,i)),this.div}setUuid(t){this.#i=t,this.addEditToolbar()}getUuid(){return this.#i}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(i=>{i?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:i,thickness:s,width:r,height:o}=this.#n,c=Math.max(r,o),u=Ls.processDrawnLines({lines:{curves:t.map(h=>({points:h})),thickness:s,width:r,height:o},pageWidth:c,pageHeight:c,rotation:0,innerMargin:0,mustSmooth:!1,areContours:i});return{areContours:i,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,i,s,r){const{x:o,y:c}=this,{outline:u}=this.#n=t;this.#t=u instanceof Nu,this.description=s;let h;this.#t?h=wi.getDefaultDrawingOptions():(h=wi._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:h});const[,f]=this.pageDimensions;let p=i/f;p=p>=1?.5:p,this.width*=p/this.height,this.width>=1&&(p*=.9/this.width,this.width=.9),this.height=p,this.setDims(),this.x=o,this.y=c,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:r}=this.parent.viewport;return Ls.process(t,i,s,r,wi._INNER_MARGIN)}getFromText(t,i){const{rawDims:{pageWidth:s,pageHeight:r},rotation:o}=this.parent.viewport;return Ls.extractContoursFromText(t,i,s,r,o,wi._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:r}=this.parent.viewport;return Ls.processDrawnLines({lines:t,pageWidth:i,pageHeight:s,rotation:r,innerMargin:wi._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:i}){t?this._drawingOptions=wi.getDefaultDrawingOptions():(this._drawingOptions=wi._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":i}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:i,points:s}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":r}}=this,o=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:r});return this.addComment(o),t?(o.paths={lines:i,points:s},o.uuid=this.#i,o.isCopy=!0):o.lines=i,this.#e&&(o.accessibilityData={type:"Figure",alt:this.#e}),o}static deserializeDraw(t,i,s,r,o,c){return c.areContours?Nu.deserialize(t,i,s,r,o,c):er.deserialize(t,i,s,r,o,c)}static async deserialize(t,i,s){const r=await super.deserialize(t,i,s);return r.#t=t.areContours,r.description=t.accessibilityData?.alt||"",r.#i=t.uuid,r}}class LA extends ct{#t=null;#e=null;#n=null;#i=null;#r=null;#a="";#s=null;#l=!1;#c=null;#o=!1;#d=!1;static _type="stamp";static _editorType=yt.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#i=t.bitmapUrl,this.#r=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,i){ct.initialize(t,i)}static isHandlingMimeForPasting(t){return wu.includes(t)}static paste(t,i){i.pasteEditor({mode:yt.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const i=t.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}#h(t,i=!1){if(!t){this.remove();return}this.#t=t.bitmap,i||(this.#e=t.id,this.#o=t.isSvg),t.file&&(this.#a=t.file.name),this.#p()}#f(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#s){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:o,height:c}=t||this.copyCanvas(null,null,!0).imageData,u=await s.guess({name:"altText",request:{data:r,width:o,height:c,channels:r.length/(o*c)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const h=u.output;return await this.setGuessedAltText(h),i&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#m(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(s=>this.#h(s,!0)).finally(()=>this.#f());return}if(this.#i){const s=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(s).then(r=>this.#h(r)).finally(()=>this.#f());return}if(this.#r){const s=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(s).then(r=>this.#h(r)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=wu.join(",");const i=this._uiManager._signal;this.#n=new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(r)}s()},{signal:i}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:i})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#s?.remove(),this.#s=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#m();return}super.rebuild(),this.div!==null&&(this.#e&&this.#s===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#i||this.#r||this.#e||this.#l)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,i;return this._isCopy&&(t=this.x,i=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#l||(this.#t?this.#p():this.#m()),this._isCopy&&this._moveAfterPaste(t,i),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,i){const{id:s,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,i);i.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(this.#e=s,r&&(this.#t=r),this.#l=!1,this.#p())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#g()},t)}#p(){const{div:t}=this;let{width:i,height:s}=this.#t;const[r,o]=this.pageDimensions,c=.75;if(this.width)i=this.width*r,s=this.height*o;else if(i>c*r||s>c*o){const h=Math.min(c*r/i,c*o/s);i*=h,s*=h}this._uiManager.enableWaiting(!1);const u=this.#s=document.createElement("canvas");u.setAttribute("role","img"),this.addContainer(u),this.width=i/r,this.height=s/o,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#g(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#a&&this.div.setAttribute("aria-description",this.#a),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,i,s=!1){t||(t=224);const{width:r,height:o}=this.#t,c=new xi;let u=this.#t,h=r,f=o,p=null;if(i){if(r>i||o>i){const k=Math.min(i/r,i/o);h=Math.floor(r*k),f=Math.floor(o*k)}p=document.createElement("canvas");const b=p.width=Math.ceil(h*c.sx),A=p.height=Math.ceil(f*c.sy);this.#o||(u=this.#u(b,A));const _=p.getContext("2d");_.filter=this._uiManager.hcmFilter;let S="white",x="#cfcfd8";this._uiManager.hcmFilter!=="none"?x="black":Jb.isDarkMode&&(S="#8f8f9d",x="#42414d");const E=15,D=E*c.sx,T=E*c.sy,B=new OffscreenCanvas(D*2,T*2),N=B.getContext("2d");N.fillStyle=S,N.fillRect(0,0,D*2,T*2),N.fillStyle=x,N.fillRect(0,0,D,T),N.fillRect(D,T,D,T),_.fillStyle=_.createPattern(B,"repeat"),_.fillRect(0,0,b,A),_.drawImage(u,0,0,u.width,u.height,0,0,b,A)}let y=null;if(s){let b,A;if(c.symmetric&&u.width<t&&u.height<t)b=u.width,A=u.height;else if(u=this.#t,r>t||o>t){const x=Math.min(t/r,t/o);b=Math.floor(r*x),A=Math.floor(o*x),this.#o||(u=this.#u(b,A))}const S=new OffscreenCanvas(b,A).getContext("2d",{willReadFrequently:!0});S.drawImage(u,0,0,u.width,u.height,0,0,b,A),y={width:b,height:A,data:S.getImageData(0,0,b,A).data}}return{canvas:p,width:h,height:f,imageData:y}}#u(t,i){const{width:s,height:r}=this.#t;let o=s,c=r,u=this.#t;for(;o>2*t||c>2*i;){const h=o,f=c;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),c>2*i&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const p=new OffscreenCanvas(o,c);p.getContext("2d").drawImage(u,0,0,h,f,0,0,o,c),u=p.transferToImageBitmap()}return u}#g(){const[t,i]=this.parentDimensions,{width:s,height:r}=this,o=new xi,c=Math.ceil(s*t*o.sx),u=Math.ceil(r*i*o.sy),h=this.#s;if(!h||h.width===c&&h.height===u)return;h.width=c,h.height=u;const f=this.#o?this.#t:this.#u(c,u),p=h.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(f,0,0,f.width,f.height,0,0,c,u)}#y(t){if(t){if(this.#o){const r=this._uiManager.imageManager.getSvgUrl(this.#e);if(r)return r}const i=document.createElement("canvas");return{width:i.width,height:i.height}=this.#t,i.getContext("2d").drawImage(this.#t,0,0),i.toDataURL()}if(this.#o){const[i,s]=this.pageDimensions,r=Math.round(this.width*i*Hs.PDF_TO_CSS_UNITS),o=Math.round(this.height*s*Hs.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(r,o);return c.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,r,o),c.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,i,s){let r=null,o=!1;if(t instanceof bm){const{data:{rect:S,rotation:x,id:E,structParent:D,popupRef:T,richText:B,contentsObj:N,creationDate:k,modificationDate:z},container:K,parent:{page:{pageNumber:Q}},canvas:et}=t;let W,dt;et?(delete t.canvas,{id:W,bitmap:dt}=s.imageManager.getFromCanvas(K.id,et),et.remove()):(o=!0,t._hasNoCanvas=!0);const _t=(await i._structTree.getAriaAttributes(`${ks}${E}`))?.get("aria-label")||"";r=t={annotationType:yt.STAMP,bitmapId:W,bitmap:dt,pageIndex:Q-1,rect:S.slice(0),rotation:x,annotationElementId:E,id:E,deleted:!1,accessibilityData:{decorative:!1,altText:_t},isSvg:!1,structParent:D,popupRef:T,richText:B,comment:N?.str||null,creationDate:k,modificationDate:z}}const c=await super.deserialize(t,i,s),{rect:u,bitmap:h,bitmapUrl:f,bitmapId:p,isSvg:y,accessibilityData:b}=t;o?(s.addMissingCanvas(t.id,c),c.#l=!0):p&&s.imageManager.isValidId(p)?(c.#e=p,h&&(c.#t=h)):c.#i=f,c.#o=y;const[A,_]=c.pageDimensions;return c.width=(u[2]-u[0])/A,c.height=(u[3]-u[1])/_,b&&(c.altTextData=b),c._initialData=r,t.comment&&c.setCommentData(t),c.#d=!!r,c}serialize(t=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#o});if(this.addComment(s),t)return s.bitmapUrl=this.#y(!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:r,altText:o}=this.serializeAltText(!1);if(!r&&o&&(s.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const u=this.#v(s);return u.isSame?null:(u.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1,s.id=this.annotationElementId,delete s.bitmapId,s)}if(i===null)return s;i.stamps||=new Map;const c=this.#o?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!i.stamps.has(this.#e))i.stamps.set(this.#e,{area:c,serialized:s}),s.bitmap=this.#y(!1);else if(this.#o){const u=i.stamps.get(this.#e);c>u.area&&(u.area=c,u.serialized.bitmap.close(),u.serialized.bitmap=this.#y(!1))}return s}#v(t){const{pageIndex:i,accessibilityData:{altText:s}}=this._initialData,r=t.pageIndex===i,o=(t.accessibilityData?.alt||"")===s;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&r&&o,isSameAltText:o}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class Xi{#t;#e=!1;#n=null;#i=null;#r=null;#a=new Map;#s=!1;#l=!1;#c=!1;#o=null;#d=null;#h=null;#f=null;#m=null;#p=-1;#u;static _initialized=!1;static#g=new Map([ye,Xu,LA,ie,wi].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:i,div:s,structTreeLayer:r,accessibilityManager:o,annotationLayer:c,drawLayer:u,textLayer:h,viewport:f,l10n:p}){const y=[...Xi.#g.values()];if(!Xi._initialized){Xi._initialized=!0;for(const b of y)b.initialize(p,t)}t.registerEditorTypes(y),this.#u=t,this.pageIndex=i,this.div=s,this.#t=o,this.#n=c,this.viewport=f,this.#h=h,this.drawLayer=u,this._structTree=r,this.#u.addLayer(this)}get isEmpty(){return this.#a.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===yt.NONE}updateToolbar(t){this.#u.updateToolbar(t)}updateMode(t=this.#u.getMode()){switch(this.#S(),t){case yt.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case yt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case yt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:i}=this.div;if(i.toggle("nonEditing",!1),t===yt.POPUP)i.toggle("commentEditing",!0);else{i.toggle("commentEditing",!1);for(const s of Xi.#g.values())i.toggle(`${s._type}Editing`,t===s._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#u.setEditingState(t)}addCommands(t){this.#u.addCommands(t)}cleanUndoStack(t){this.#u.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.togglePointerEvents(t)}get#y(){return this.#a.size!==0?this.#a.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#m?.abort(),this.#m=null;const t=new Set;for(const s of this.#y)s.enableEditing(),s.show(!0),s.annotationElementId&&(this.#u.removeChangedExistingAnnotation(s),t.add(s.annotationElementId));const i=this.#n;if(i)for(const s of i.getEditableAnnotations()){if(s.hide(),this.#u.isDeletedAnnotationElement(s.data.id)||t.has(s.data.id))continue;const r=await this.deserialize(s);r&&(this.addOrRebuild(r),r.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#l=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#m){this.#m=new AbortController;const r=this.#u.combinedSignal(this.#m);this.#h.div.addEventListener("pointerdown",o=>{const{clientX:u,clientY:h,timeStamp:f}=o,p=this.#p;if(f-p>500){this.#p=f;return}this.#p=-1;const{classList:y}=this.div;y.toggle("getElements",!0);const b=document.elementsFromPoint(u,h);if(y.toggle("getElements",!1),!this.div.contains(b[0]))return;let A;const _=new RegExp(`^${Va}[0-9]+$`);for(const x of b)if(_.test(x.id)){A=x.id;break}if(!A)return;const S=this.#a.get(A);S?.annotationElementId===null&&(o.stopPropagation(),o.preventDefault(),S.dblclick(o))},{signal:r,capture:!0})}const t=this.#n,i=[];if(t){const r=new Map,o=new Map;for(const u of this.#y){if(u.disableEditing(),!u.annotationElementId){i.push(u);continue}if(u.serialize()!==null){r.set(u.annotationElementId,u);continue}else o.set(u.annotationElementId,u);this.getEditableAnnotation(u.annotationElementId)?.show(),u.remove()}const c=t.getEditableAnnotations();for(const u of c){const{id:h}=u.data;if(this.#u.isDeletedAnnotationElement(h)){u.updateEdited({deleted:!0});continue}let f=o.get(h);if(f){f.resetAnnotationElement(u),f.show(!1),u.show();continue}f=r.get(h),f&&(this.#u.addChangedExistingAnnotation(f),f.renderAnnotationElement(u)&&f.show(!1)),u.show()}}this.#S(),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of Xi.#g.values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),t?.updateFakeAnnotations(i),this.#l=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#u.getActive()!==t&&this.#u.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const t=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#v.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#v(t){this.#u.unselectAll();const{target:i}=t;if(i===this.#h.div||(i.getAttribute("role")==="img"||i.classList.contains("endOfContent"))&&this.#h.div.contains(i)){const{isMac:s}=de.platform;if(t.button!==0||t.ctrlKey&&s)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),ie.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const t=this.#u.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const i=this.pointerup.bind(this);this.div.addEventListener("pointerup",i,{signal:t}),this.div.addEventListener("pointercancel",i,{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#a.set(t.id,t);const{annotationElementId:i}=t;i&&this.#u.isDeletedAnnotationElement(i)&&this.#u.removeDeletedAnnotationElement(t)}detach(t){this.#a.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#l&&t.annotationElementId&&this.#u.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#u.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#u.addDeletedAnnotationElement(t),ct.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#u.addEditor(t),this.attach(t),!t.isAttachedToDOM){const i=t.render();this.div.append(i),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#u.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:i}=document;t.div.contains(i)&&!this.#r&&(t._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),i.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const i=()=>t._uiManager.rebuild(t),s=()=>{t.remove()};this.addCommands({cmd:i,undo:s,mustExec:!1})}getEditorByUID(t){for(const i of this.#a.values())if(i.uid===t)return i;return null}getNextId(){return this.#u.getId()}get#b(){return Xi.#g.get(this.#u.getMode())}combinedSignal(t){return this.#u.combinedSignal(t)}#x(t){const i=this.#b;return i?new i.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#b?.canCreateNewEmptyEditor()}async pasteEditor(t,i){this.updateToolbar(t),await this.#u.updateMode(t.mode);const{offsetX:s,offsetY:r}=this.#w(),o=this.getNextId(),c=this.#x({parent:this,id:o,x:s,y:r,uiManager:this.#u,isCentered:!0,...i});c&&this.add(c)}async deserialize(t){return await Xi.#g.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#u)||null}createAndAddNewEditor(t,i,s={}){const r=this.getNextId(),o=this.#x({parent:this,id:r,x:t.offsetX,y:t.offsetY,uiManager:this.#u,isCentered:i,...s});return o&&this.add(o),o}get boundingClientRect(){return this.div.getBoundingClientRect()}#w(){const{x:t,y:i,width:s,height:r}=this.boundingClientRect,o=Math.max(0,t),c=Math.max(0,i),u=Math.min(window.innerWidth,t+s),h=Math.min(window.innerHeight,i+r),f=(o+u)/2-t,p=(c+h)/2-i,[y,b]=this.viewport.rotation%180===0?[f,p]:[p,f];return{offsetX:y,offsetY:b}}addNewEditor(t={}){this.createAndAddNewEditor(this.#w(),!0,t)}setSelected(t){this.#u.setSelected(t)}toggleSelected(t){this.#u.toggleSelected(t)}unselect(t){this.#u.unselect(t)}pointerup(t){const{isMac:i}=de.platform;if(t.button!==0||t.ctrlKey&&i||t.target!==this.div||!this.#s||(this.#s=!1,this.#b?.isDrawer&&this.#b.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const s=this.#u.getMode();if(s===yt.STAMP||s===yt.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#u.getMode()===yt.HIGHLIGHT&&this.enableTextSelection(),this.#s){this.#s=!1;return}const{isMac:i}=de.platform;if(t.button!==0||t.ctrlKey&&i||t.target!==this.div)return;if(this.#s=!0,this.#b?.isDrawer){this.startDrawingSession(t);return}const s=this.#u.getActive();this.#e=!s||s.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#o){this.#b.startDrawing(this,this.#u,!1,t);return}this.#u.setCurrentDrawingSession(this),this.#o=new AbortController;const i=this.#u.combinedSignal(this.#o);this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(this.#d=null,this.commitOrRemove())},{signal:i}),this.#b.startDrawing(this,this.#u,!1,t)}pause(t){if(t){const{activeElement:i}=document;this.div.contains(i)&&(this.#d=i);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#o?(this.#u.setCurrentDrawingSession(null),this.#o.abort(),this.#o=null,this.#d=null,this.#b.endDrawing(t)):null}findNewParent(t,i,s){const r=this.#u.findParent(i,s);return r===null||r===this?!1:(r.changeParent(t),!0)}commitOrRemove(){return this.#o?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#o&&this.#b.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(const t of this.#a.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#a.clear(),this.#u.removeLayer(this)}#S(){for(const t of this.#a.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,jn(this.div,t);for(const i of this.#u.getEditors(this.pageIndex))this.add(i),i.rebuild();this.updateMode()}update({viewport:t}){this.#u.commitOrRemove(),this.#S();const i=this.viewport.rotation,s=t.rotation;if(this.viewport=t,jn(this.div,{rotation:s}),i!==s)for(const r of this.#a.values())r.rotate(s)}get pageDimensions(){const{pageWidth:t,pageHeight:i}=this.viewport.rawDims;return[t,i]}get scale(){return this.#u.viewParameters.realScale}}class we{#t=null;#e=new Map;#n=new Map;static#i=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const i of this.#e.values())i.remove(),t.append(i);this.#t=t}}static get _svgFactory(){return mt(this,"_svgFactory",new Ol)}static#r(t,[i,s,r,o]){const{style:c}=t;c.top=`${100*s}%`,c.left=`${100*i}%`,c.width=`${100*r}%`,c.height=`${100*o}%`}#a(){const t=we._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#s(t,i){const s=we._svgFactory.createElement("clipPath");t.append(s);const r=`clip_${i}`;s.setAttribute("id",r),s.setAttribute("clipPathUnits","objectBoundingBox");const o=we._svgFactory.createElement("use");return s.append(o),o.setAttribute("href",`#${i}`),o.classList.add("clip"),r}#l(t,i){for(const[s,r]of Object.entries(i))r===null?t.removeAttribute(s):t.setAttribute(s,r)}draw(t,i=!1,s=!1){const r=we.#i++,o=this.#a(),c=we._svgFactory.createElement("defs");o.append(c);const u=we._svgFactory.createElement("path");c.append(u);const h=`path_p${this.pageIndex}_${r}`;u.setAttribute("id",h),u.setAttribute("vector-effect","non-scaling-stroke"),i&&this.#n.set(r,u);const f=s?this.#s(c,h):null,p=we._svgFactory.createElement("use");return o.append(p),p.setAttribute("href",`#${h}`),this.updateProperties(o,t),this.#e.set(r,o),{id:r,clipPathId:`url(#${f})`}}drawOutline(t,i){const s=we.#i++,r=this.#a(),o=we._svgFactory.createElement("defs");r.append(o);const c=we._svgFactory.createElement("path");o.append(c);const u=`path_p${this.pageIndex}_${s}`;c.setAttribute("id",u),c.setAttribute("vector-effect","non-scaling-stroke");let h;if(i){const y=we._svgFactory.createElement("mask");o.append(y),h=`mask_p${this.pageIndex}_${s}`,y.setAttribute("id",h),y.setAttribute("maskUnits","objectBoundingBox");const b=we._svgFactory.createElement("rect");y.append(b),b.setAttribute("width","1"),b.setAttribute("height","1"),b.setAttribute("fill","white");const A=we._svgFactory.createElement("use");y.append(A),A.setAttribute("href",`#${u}`),A.setAttribute("stroke","none"),A.setAttribute("fill","black"),A.setAttribute("fill-rule","nonzero"),A.classList.add("mask")}const f=we._svgFactory.createElement("use");r.append(f),f.setAttribute("href",`#${u}`),h&&f.setAttribute("mask",`url(#${h})`);const p=f.cloneNode();return r.append(p),f.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(r,t),this.#e.set(s,r),s}finalizeDraw(t,i){this.#n.delete(t),this.updateProperties(t,i)}updateProperties(t,i){if(!i)return;const{root:s,bbox:r,rootClass:o,path:c}=i,u=typeof t=="number"?this.#e.get(t):t;if(u){if(s&&this.#l(u,s),r&&we.#r(u,r),o){const{classList:h}=u;for(const[f,p]of Object.entries(o))h.toggle(f,p)}if(c){const f=u.firstElementChild.firstElementChild;this.#l(f,c)}}}updateParent(t,i){if(i===this)return;const s=this.#e.get(t);s&&(i.#t.append(s),this.#e.delete(t),i.#e.set(t,s))}remove(t){this.#n.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Ru};globalThis.pdfjsLib={AbortException:An,AnnotationEditorLayer:Xi,AnnotationEditorParamsType:Ct,AnnotationEditorType:yt,AnnotationEditorUIManager:Sn,AnnotationLayer:Vu,AnnotationMode:vn,AnnotationType:ce,applyOpacity:ev,build:cA,ColorPicker:di,createValidAbsoluteUrl:Gp,CSSConstants:tv,DOMSVGFactory:Ol,DrawLayer:we,FeatureTest:de,fetchData:Qa,findContrastColor:iv,getDocument:dm,getFilenameFromUrl:Kb,getPdfFilenameFromUrl:$b,getRGB:Wa,getUuid:Xp,getXfaPageViewport:Zb,GlobalWorkerOptions:Is,ImageKind:Ml,InvalidPDFException:Su,isDataScheme:Bl,isPdfFile:Bu,isValidExplicitDest:fv,MathClamp:Oe,noContextMenu:fi,normalizeUnicode:Vb,OPS:Xa,OutputScale:xi,PasswordResponses:zb,PDFDataRangeTransport:fm,PDFDateString:_u,PDFWorker:Ee,PermissionFlag:Bb,PixelsPerInch:Hs,RenderingCancelledException:ku,renderRichText:$p,ResponseException:Dl,setLayerDimensions:jn,shadow:mt,SignatureExtractor:Ls,stopEvent:Jt,SupportedImageMimeTypes:wu,TextLayer:We,TouchManager:zl,updateUrlHash:qp,Util:it,VerbosityLevel:Nl,version:oA,XfaLayer:Kp};const kA="5.4.530";Is.workerSrc=`https://cdn.jsdelivr.net/npm/pdfjs-dist@${kA}/build/pdf.worker.min.mjs`;const BA=async(m,t)=>{try{const i=await m.arrayBuffer(),r=await dm({data:i,useWorkerFetch:!0,isEvalSupported:!1}).promise,o=r.numPages,c=[];for(let u=1;u<=o;u++){const h=await r.getPage(u),f=h.getViewport({scale:1.5}),y=(await h.getTextContent()).items.map(_=>_.str).join(" ").replace(/\s+/g," ").trim(),b=document.createElement("canvas"),A=b.getContext("2d");if(A){b.height=f.height,b.width=f.width,await h.render({canvas:b,canvasContext:A,viewport:f}).promise;const _=b.toDataURL("image/jpeg",.8).split(",")[1];c.push({index:u,text:y,image:_})}t(u/o*100)}return c}catch(i){throw console.error("PDF parsing error:",i),new Error("Failed to parse PDF. This can happen if the worker fails to load or the file is corrupted.")}},zA=(m,t=1900)=>{const i=[];let s=m;for(;s.length>0;){if(s.length<=t){i.push(s);break}let r=s.lastIndexOf(". ",t);(r===-1||r<t/2)&&(r=s.lastIndexOf(" ",t)),r===-1&&(r=t),i.push(s.substring(0,r+1).trim()),s=s.substring(r+1).trim()}return i},Up=m=>m?m.replace(/[\w.-]+@[\w.-]+\.\w+/g,"").replace(/https?:\/\/[^\s]+/g,"").replace(/www\.[^\s]+/g,"").replace(/doi:\s*[\d./\w-]+/gi,"").replace(/\b10\.\d{4,}\/[^\s]+/g,"").replace(/arXiv:\s*[\d.]+/gi,"").replace(/\[\d+(?:[-,]\s*\d+)*\]/g,"").replace(/\([A-Z][a-z]+(?:\s+et\s+al\.?)?,?\s*\d{4}\)/g,"").replace(/\([A-Z][a-z]+\s+and\s+[A-Z][a-z]+,?\s*\d{4}\)/g,"").replace(/^(\d{3}\s+)+/gm,"").replace(/\b\d{3}\s+(?=\d{3}\b)/g,"").replace(/^\s*\d{1,3}\s+(?=[A-Z])/gm,"").replace(/\bPage\s+\d+\b/gi,"").replace(/\s*\d{4}[^.]*\./gi,"").replace(/copyright\s*\d{4}[^.]*\./gi,"").replace(/\bet\s+al\.\s*,?\s*\d{4}/g,"").replace(/[*]\d*/g,"").replace(/ORCID:\s*[\d-]+/gi,"").replace(/(?:Received|Accepted|Published|Submitted):\s*[^.]+\./gi,"").replace(/\*?\s*Corresponding author[.:]?/gi,"").replace(/\s+/g," ").trim():"",PA=async(m,t)=>{let i=[];if(t.length<=15)i=t.map((o,c)=>({pageNum:c+1,text:o}));else{const o=new Set;for(let c=0;c<4&&c<t.length;c++)o.add(c);for(let c=4;c<t.length-3;c+=2)o.add(c);for(let c=Math.max(0,t.length-3);c<t.length;c++)o.add(c);i=Array.from(o).sort((c,u)=>c-u).map(c=>({pageNum:c+1,text:t[c]}))}const s=i.map(o=>`--- PAGE ${o.pageNum} ---
${o.text}`).join(`

`),r=`Analyze this research paper and identify ALL of its sections. Be thorough - do not miss any sections.

COMMON SECTION TYPES (find all that exist):
- Abstract
- Introduction
- Background / Related Work / Prior Work / Literature Review
- Problem Statement / Motivation
- Methods / Methodology / Approach / Proposed Method / Our Approach
- Model / Architecture / System Design / Framework
- Implementation / Setup
- Experiments / Experimental Setup / Evaluation
- Results / Findings
- Analysis / Ablation Study
- Discussion
- Limitations / Future Work
- Conclusion / Summary
- Acknowledgments (include this)
- Skip: References / Bibliography / Appendix

The paper has ${t.length} total pages. I'm showing you samples from pages to help identify ALL section boundaries.

OUTPUT FORMAT: Return ONLY a valid JSON array:
[{"title": "Abstract", "pageStart": 1, "pageEnd": 1}, {"title": "Introduction", "pageStart": 1, "pageEnd": 3}]

CRITICAL RULES:
1. Find EVERY section - don't skip any
2. Use clean section names without numbering (e.g., "Methods" not "3. Methods")
3. Page numbers are 1-indexed
4. Sections must cover pages 1 through ${t.length} without gaps
5. Skip References/Bibliography section only

PAPER SAMPLES:
${s}`;try{const o=await fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${m}`,"HTTP-Referer":window.location.origin,"X-Title":"Paper Reader AI"},body:JSON.stringify({model:"xiaomi/mimo-v2-flash:free",messages:[{role:"user",content:r}]})});if(!o.ok)throw new Error(`OpenRouter API error: ${o.status}`);const u=(await o.json()).choices?.[0]?.message?.content||"[]";let h=u;const f=u.match(/```(?:json)?\s*([\s\S]*?)```/);if(f)h=f[1].trim();else{const y=u.match(/\[[\s\S]*\]/);y&&(h=y[0])}return JSON.parse(h).filter(y=>!y.title.toLowerCase().includes("reference")).map(y=>({title:y.title,pageStart:Math.max(1,y.pageStart),pageEnd:Math.min(t.length,y.pageEnd)}))}catch(o){return console.error("Failed to extract sections:",o),[{title:"Full Paper",pageStart:1,pageEnd:t.length}]}},FA=async(m,t,i,s)=>{const r=s.join(`

`),o=`You are an expert academic voice assistant. Process this section titled "${t}" from a research paper for reading aloud.

KEEP:
- Main scholarly content and section headings
- Paper title
- Author LAST NAMES and their companies/organizations (e.g., "Smith and Johnson from Google Research and OpenAI")
- Do NOT include full addresses, emails, or department details - just last names and company/organization names

REMOVE COMPLETELY:
- Line numbers (000, 001, 055, etc.)
- Email addresses, URLs, DOIs
- Citations: [1], [2,3], (Smith et al., 2023)
- Full postal addresses and department details
- Copyright notices, dates
- Footnote markers, ORCID IDs
- Grant acknowledgments
- Conference/journal headers

CRITICAL - HANDLING EQUATIONS AND MATH:
When you encounter mathematical equations or formulas, you MUST convert them to natural spoken language. Do NOT include LaTeX, symbols like $$, or raw math notation.

Examples of how to convert equations:
- "$$\\text{Attention}(Q, K, V) = \\text{softmax}(QK^T/\\sqrt{d_k})V$$"  "The Attention function takes Query, Key, and Value as inputs. It computes the softmax of the product of Query and Key-transpose, divided by the square root of the key dimension d-k, then multiplies the result by the Value matrix."
- "$$L = -\\sum_i y_i \\log(p_i)$$"  "The loss L equals the negative sum over all i of y-i times the log of p-i, which is the cross-entropy loss."
- "$$\\nabla_\\theta J(\\theta)$$"  "The gradient of the objective function J with respect to theta."
- "$$O(n^2)$$"  "O of n squared time complexity."
- "$$x \\in \\mathbb{R}^d$$"  "x is a d-dimensional real vector."

For figures and tables, describe what they show conceptually.

OUTPUT FORMAT: Return ONLY a valid JSON array:
[{"type": "text", "content": "Cleaned paragraph..."}, {"type": "description", "content": "The equation shows..."}]

SECTION TEXT:
${r}`;try{const c=await fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${m}`,"HTTP-Referer":window.location.origin,"X-Title":"Paper Reader AI"},body:JSON.stringify({model:"xiaomi/mimo-v2-flash:free",messages:[{role:"user",content:o}]})});if(!c.ok)throw c.status===401||c.status===403?new Error("INVALID_KEY"):new Error(`OpenRouter API error: ${c.status}`);const h=(await c.json()).choices?.[0]?.message?.content||"[]";let f=h;const p=h.match(/```(?:json)?\s*([\s\S]*?)```/);if(p)f=p[1].trim();else{const b=h.match(/\[[\s\S]*\]/);b&&(f=b[0])}return JSON.parse(f).map((b,A)=>({id:`${i}-block-${A}`,type:b.type,content:Up(b.content),sectionId:i}))}catch(c){if(console.error("Failed to process section:",c),c.message==="INVALID_KEY")throw c;return[{id:`${i}-fallback`,type:Ga.TEXT,content:Up(s.join(" ")),sectionId:i}]}},UA={Kore:"aura-2-thalia-en",Puck:"aura-2-orpheus-en"},IA=async(m,t,i,s="Kore")=>{try{const r=UA[s]||"aura-2-thalia-en",o=zA(t,1900);if(o.length===1)return await Ip(m,r,o[0],i);const c=[];for(const u of o){const h=await Ip(m,r,u,i);h&&c.push(h)}return c.length===0?null:HA(c,i)}catch(r){if(console.error("TTS generation failed:",r),r.message==="INVALID_KEY")throw r;return null}};async function Ip(m,t,i,s){const r=await fetch(`https://api.deepgram.com/v1/speak?model=${t}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Token ${m}`},body:JSON.stringify({text:i})});if(!r.ok){const c=await r.text();if(console.error("Deepgram TTS error:",r.status,c),r.status===401||r.status===403)throw new Error("INVALID_KEY");return null}const o=await r.arrayBuffer();return await s.decodeAudioData(o)}function HA(m,t){const i=m.reduce((u,h)=>u+h.length,0),s=m[0].numberOfChannels,r=m[0].sampleRate,o=t.createBuffer(s,i,r);let c=0;for(const u of m){for(let h=0;h<s;h++)o.getChannelData(h).set(u.getChannelData(h),c);c+=u.length}return o}const jA=[{value:.75,label:"Slow"},{value:1,label:"Normal"},{value:1.25,label:"Fast"},{value:1.5,label:"Faster"},{value:2,label:"2x"}],GA=()=>{const[m,t]=ne.useState(localStorage.getItem("openrouter_api_key")||""),[i,s]=ne.useState(localStorage.getItem("deepgram_api_key")||""),[r,o]=ne.useState(!m||!i),[c,u]=ne.useState(m),[h,f]=ne.useState(i),[p,y]=ne.useState(!1),[b,A]=ne.useState(!1),[_,S]=ne.useState({file:null,status:Pt.IDLE,progress:0,totalPages:0,currentPage:0,error:null,sections:[],currentSectionIndex:0,currentlyPlayingBlockId:null,selectedVoice:"female",playbackSpeed:1}),x=ne.useRef(null),E=ne.useRef([]),D=ne.useRef(0),T=ne.useRef([]),B=ne.useRef([]),N=ne.useRef(!1),k=ne.useRef(1),z=$=>{k.current=$,S(st=>({...st,playbackSpeed:$})),E.current.forEach(st=>{st.source.playbackRate.value=$})},K=()=>{c.trim()&&h.trim()&&(localStorage.setItem("openrouter_api_key",c.trim()),localStorage.setItem("deepgram_api_key",h.trim()),t(c.trim()),s(h.trim()),o(!1),S($=>({...$,error:null})))},Q=()=>{x.current||(x.current=new(window.AudioContext||window.webkitAudioContext)({sampleRate:24e3})),x.current.state==="suspended"&&x.current.resume()},et=async $=>{const st=$.target.files?.[0];if(!st)return;if(st.type!=="application/pdf"){S(F=>({...F,error:"Please upload a valid PDF file."}));return}S(F=>({...F,file:st,status:Pt.PARSING_PDF,progress:0,totalPages:0,currentPage:0,error:null,sections:[],currentSectionIndex:0,currentlyPlayingBlockId:null})),T.current=[],D.current=0,N.current=!1;const C=_.selectedVoice==="female"?"Kore":"Puck";try{const F=await BA(st,Z=>S(lt=>({...lt,progress:Z})));B.current=F.map(Z=>Z.text),S(Z=>({...Z,totalPages:F.length,status:Pt.EXTRACTING_SECTIONS})),Q();const tt=(await PA(m,B.current)).map((Z,lt)=>({id:`section-${lt}`,title:Z.title,pageStart:Z.pageStart,pageEnd:Z.pageEnd,blocks:[],status:"pending"}));S(Z=>({...Z,sections:tt,status:Pt.PROCESSING_SECTION,progress:0}));for(let Z=0;Z<tt.length;Z++){const lt=tt[Z];S(Xt=>({...Xt,currentSectionIndex:Z,sections:Xt.sections.map((fe,Ce)=>Ce===Z?{...fe,status:"processing"}:fe),progress:Z/tt.length*100}));const ut=B.current.slice(lt.pageStart-1,lt.pageEnd),Kt=await FA(m,lt.title,lt.id,ut);S(Xt=>{const fe=Xt.status===Pt.PAUSED||Xt.status===Pt.PLAYING?Xt.status:Pt.GENERATING_VOICE;return{...Xt,status:fe}});const kt=[];for(const Xt of Kt){const fe=await IA(i,Xt.content,x.current,C),Ce={...Xt,audioBuffer:fe};kt.push(Ce),T.current.push(Ce),fe&&W(Ce)}S(Xt=>{const fe=Xt.status===Pt.PAUSED||Xt.status===Pt.PLAYING?Xt.status:Pt.PROCESSING_SECTION;return{...Xt,sections:Xt.sections.map((Ce,_n)=>_n===Z?{...Ce,blocks:kt,status:"ready"}:Ce),status:fe}})}S(Z=>({...Z,status:Pt.COMPLETED,progress:100}))}catch(F){console.error(F),F.message==="INVALID_KEY"?(S(Y=>({...Y,status:Pt.ERROR,error:"Your API key seems invalid. Please check your key and try again."})),o(!0)):S(Y=>({...Y,status:Pt.ERROR,error:F.message||"An unexpected error occurred."}))}},W=$=>{if(!x.current||!$.audioBuffer)return;const st=x.current,C=st.createBufferSource();C.buffer=$.audioBuffer,C.playbackRate.value=k.current,C.connect(st.destination),D.current===0&&(D.current=st.currentTime+.1,S(Z=>Z.status===Pt.PAUSED?Z:{...Z,status:Pt.PLAYING}));const F=Math.max(D.current,st.currentTime);C.start(F);const Y=$.audioBuffer.duration/k.current,tt=(F-st.currentTime)*1e3;setTimeout(()=>{S(Z=>({...Z,currentlyPlayingBlockId:$.id}))},Math.max(0,tt)),D.current=F+Y,E.current.push({id:$.id,source:C}),C.onended=()=>{E.current=E.current.filter(Z=>Z.source!==C),S(Z=>E.current.length===0&&Z.status===Pt.COMPLETED?{...Z,currentlyPlayingBlockId:null}:Z)}},dt=()=>{E.current.forEach($=>{try{$.source.stop()}catch{}}),E.current=[],D.current=0},_t=()=>{x.current&&(x.current.state==="running"?(x.current.suspend(),S($=>({...$,status:Pt.PAUSED}))):(x.current.resume(),S($=>({...$,status:Pt.PLAYING}))))},ft=()=>{dt(),S($=>({...$,file:null,status:Pt.IDLE,progress:0,totalPages:0,currentPage:0,error:null,sections:[],currentSectionIndex:0,currentlyPlayingBlockId:null}))},xt=$=>{S(st=>({...st,selectedVoice:$}))},O=($,st)=>{const C=_.sections.find(F=>F.id===$);if(C&&C.blocks.length>0){const F=C.blocks[0].id,Y=document.getElementById(F);Y&&(Y.scrollIntoView({behavior:"smooth",block:"start"}),S(tt=>({...tt,currentSectionIndex:st})))}};if(r)return j.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-6 bg-slate-50 text-slate-900",children:j.jsxs("div",{className:"w-full max-w-md glass p-8 rounded-3xl shadow-xl border border-white animate-in fade-in zoom-in duration-500",children:[j.jsxs("div",{className:"text-center mb-8",children:[j.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-indigo-50 border border-indigo-100 text-indigo-600 text-xs font-semibold mb-4",children:[j.jsx(cu,{size:14}),j.jsx("span",{children:"Setup Required"})]}),j.jsx("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"Paper Reader AI"}),j.jsx("p",{className:"text-slate-500 text-sm",children:"Enter your API keys to get started"})]}),j.jsxs("div",{className:"space-y-4 text-left",children:[j.jsxs("div",{children:[j.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-2 block",children:"OpenRouter API Key (for text analysis)"}),j.jsxs("div",{className:"relative",children:[j.jsx("input",{type:p?"text":"password",value:c,onChange:$=>u($.target.value),placeholder:"Paste your OpenRouter API key here...",className:"w-full bg-slate-100 border border-slate-200 px-5 py-4 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all pr-12 font-mono"}),j.jsx("button",{onClick:()=>y(!p),className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 transition-colors",children:p?j.jsx(op,{size:18}):j.jsx(cp,{size:18})})]})]}),j.jsxs("div",{children:[j.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-2 block",children:"Deepgram API Key (for TTS audio)"}),j.jsxs("div",{className:"relative",children:[j.jsx("input",{type:b?"text":"password",value:h,onChange:$=>f($.target.value),placeholder:"Paste your Deepgram API key here...",className:"w-full bg-slate-100 border border-slate-200 px-5 py-4 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all pr-12 font-mono"}),j.jsx("button",{onClick:()=>A(!b),className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 transition-colors",children:b?j.jsx(op,{size:18}):j.jsx(cp,{size:18})})]})]}),j.jsxs("button",{onClick:K,disabled:!c.trim()||!h.trim(),className:"w-full bg-indigo-600 text-white py-4 rounded-2xl font-bold text-lg shadow-lg shadow-indigo-100 hover:bg-indigo-700 hover:-translate-y-0.5 transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:translate-y-0",children:[j.jsx(Cb,{size:18}),j.jsx("span",{children:"Save & Continue"})]}),j.jsxs("div",{className:"flex gap-4 justify-center",children:[j.jsxs("a",{href:"https://openrouter.ai/keys",target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-1.5 text-[11px] font-bold text-slate-400 hover:text-indigo-600 transition-colors uppercase tracking-widest",children:["Get OpenRouter Key ",j.jsx(lp,{size:10})]}),j.jsxs("a",{href:"https://console.deepgram.com/signup",target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-1.5 text-[11px] font-bold text-slate-400 hover:text-indigo-600 transition-colors uppercase tracking-widest",children:["Get Deepgram Key ",j.jsx(lp,{size:10})]})]})]})]})});const G=_.sections.flatMap($=>$.blocks),J=_.sections.filter($=>$.status==="ready"||$.status==="completed").length;return j.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 md:p-6 bg-slate-50 text-slate-900 selection:bg-indigo-100 selection:text-indigo-900",children:[j.jsxs("div",{className:"fixed top-0 left-0 w-full h-full overflow-hidden pointer-events-none -z-10",children:[j.jsx("div",{className:"absolute top-[-5%] left-[-5%] w-[35%] h-[35%] bg-indigo-100/60 blur-[100px] rounded-full"}),j.jsx("div",{className:"absolute bottom-[-5%] right-[-5%] w-[35%] h-[35%] bg-blue-100/60 blur-[100px] rounded-full"})]}),_.status===Pt.IDLE&&j.jsxs("header",{className:"mb-8 text-center animate-in fade-in slide-in-from-top duration-700 w-full max-w-xl",children:[j.jsxs("div",{className:"flex items-center justify-center gap-2 mb-6",children:[j.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-indigo-50 border border-indigo-100 text-indigo-600 text-xs font-semibold",children:[j.jsx(cu,{size:14}),j.jsx("span",{children:"AI Research Assistant"})]}),j.jsx("button",{onClick:()=>o(!0),className:"p-1.5 rounded-full bg-white border border-slate-200 text-slate-400 hover:text-indigo-600 transition-colors shadow-sm",title:"Change API Key",children:j.jsx(hp,{size:14})})]}),j.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[j.jsx("img",{src:"./images/logo.png",alt:"Paper Reader AI",className:"w-14 h-14 md:w-16 md:h-16 rounded-2xl"}),j.jsxs("h1",{className:"text-4xl md:text-6xl font-bold tracking-tight text-slate-900 font-['Inter']",children:["Paper Reader ",j.jsx("span",{className:"text-indigo-600",children:"AI"})]})]}),j.jsx("p",{className:"text-slate-600 max-w-lg mx-auto text-base md:text-lg leading-relaxed",children:"Upload your PDF and listen to research papers. Papers are intelligently split into sections for natural narration."})]}),j.jsxs("main",{className:"w-full max-w-4xl flex flex-col gap-6",children:[_.status===Pt.IDLE&&j.jsxs("div",{className:"glass p-8 md:p-12 rounded-[2rem] border-dashed border-2 border-indigo-200 flex flex-col items-center gap-8 transition-all hover:border-indigo-400 shadow-sm relative overflow-hidden",children:[j.jsxs("div",{className:"w-full flex flex-col items-center gap-4",children:[j.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Select Narrator"}),j.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-2xl border border-slate-200 shadow-inner",children:[j.jsxs("button",{onClick:()=>xt("female"),className:`flex items-center gap-2 px-6 py-2.5 rounded-xl text-sm font-bold transition-all ${_.selectedVoice==="female"?"bg-white text-indigo-600 shadow-sm ring-1 ring-slate-200":"text-slate-500 hover:text-slate-700"}`,children:[j.jsx(dp,{size:16}),"Female"]}),j.jsxs("button",{onClick:()=>xt("male"),className:`flex items-center gap-2 px-6 py-2.5 rounded-xl text-sm font-bold transition-all ${_.selectedVoice==="male"?"bg-white text-indigo-600 shadow-sm ring-1 ring-slate-200":"text-slate-500 hover:text-slate-700"}`,children:[j.jsx(dp,{size:16}),"Male"]})]})]}),j.jsxs("div",{className:"w-full flex flex-col items-center gap-6 py-4 border-t border-slate-100 group cursor-pointer active:scale-[0.99] transition-all",children:[j.jsx("div",{className:"w-20 h-20 bg-indigo-50 rounded-[1.5rem] flex items-center justify-center text-indigo-500 group-hover:scale-110 transition-transform shadow-inner border border-indigo-100",children:j.jsx(Ob,{size:36})}),j.jsxs("div",{className:"text-center",children:[j.jsx("h2",{className:"text-xl md:text-2xl font-bold text-slate-800 mb-1",children:"Ready to start?"}),j.jsx("p",{className:"text-slate-500 text-sm",children:"Select a PDF to begin intelligent narration"})]}),j.jsxs("label",{className:"relative cursor-pointer",children:[j.jsx("span",{className:"bg-indigo-600 text-white px-10 py-3.5 rounded-2xl font-bold text-base shadow-lg shadow-indigo-200 hover:bg-indigo-700 hover:-translate-y-0.5 transition-all inline-block",children:"Choose PDF File"}),j.jsx("input",{type:"file",className:"hidden",accept:"application/pdf",onChange:et})]})]}),j.jsxs("div",{className:"mt-2 flex gap-4 text-slate-400 text-[10px] md:text-xs font-medium uppercase tracking-wider",children:[j.jsxs("span",{className:"flex items-center gap-1",children:[j.jsx(hb,{size:12})," Section-based reading"]}),j.jsxs("span",{className:"flex items-center gap-1",children:[j.jsx(cu,{size:12})," Smart analysis"]})]})]}),_.status!==Pt.IDLE&&j.jsxs("div",{className:"glass rounded-[2rem] overflow-hidden shadow-xl border border-white flex flex-col h-[85vh] md:h-[75vh] animate-in fade-in zoom-in duration-500",children:[j.jsxs("div",{className:"px-6 md:px-10 py-5 md:py-6 border-b border-slate-100 flex items-center justify-between bg-white/40 sticky top-0 z-10",children:[j.jsxs("div",{className:"flex items-center gap-3 md:gap-4 overflow-hidden",children:[j.jsx("button",{onClick:ft,className:"p-2 hover:bg-slate-100 rounded-full transition-colors",children:j.jsx(cb,{size:20,className:"text-slate-500"})}),j.jsxs("div",{className:"overflow-hidden",children:[j.jsx("h3",{className:"text-slate-900 text-sm md:text-lg font-bold truncate",children:_.file?.name}),j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${_.status===Pt.PLAYING?"bg-indigo-500 animate-pulse":"bg-slate-300"}`}),j.jsxs("p",{className:"text-slate-500 text-[10px] md:text-xs font-semibold uppercase tracking-wider",children:[_.status===Pt.COMPLETED?"Finished":_.status.replace(/_/g," "),"  ",_.selectedVoice," voice"]})]})]})]}),j.jsxs("div",{className:"flex items-center gap-3",children:[j.jsx("button",{onClick:()=>o(!0),className:"p-2 rounded-full hover:bg-slate-100 text-slate-400 hover:text-indigo-600 transition-colors",title:"Settings",children:j.jsx(hp,{size:20})}),_.status!==Pt.COMPLETED&&_.status!==Pt.ERROR&&j.jsxs("div",{className:"px-3 py-1 bg-white rounded-full border border-slate-200 flex items-center gap-2 text-indigo-600 text-[10px] md:text-xs font-bold shadow-sm",children:[j.jsx(up,{size:12,className:"animate-spin"}),Math.round(_.progress),"%"]})]})]}),_.sections.length>0&&j.jsx("div",{className:"px-6 md:px-10 py-3 bg-slate-50/80 border-b border-slate-100 flex gap-2 overflow-x-auto custom-scrollbar",children:_.sections.map(($,st)=>j.jsxs("button",{onClick:()=>O($.id,st),disabled:$.blocks.length===0,className:`px-3 py-1.5 rounded-lg text-xs font-semibold whitespace-nowrap transition-all cursor-pointer hover:scale-105 disabled:cursor-not-allowed disabled:opacity-50 ${_.currentSectionIndex===st?"bg-indigo-600 text-white ring-2 ring-indigo-300":$.status==="ready"||$.status==="completed"?"bg-indigo-100 text-indigo-700 hover:bg-indigo-200":$.status==="processing"?"bg-amber-100 text-amber-700":"bg-slate-100 text-slate-500"}`,children:[$.status==="processing"&&j.jsx(up,{size:10,className:"inline mr-1 animate-spin"}),$.title]},$.id))}),j.jsx("div",{className:"flex-1 overflow-y-auto p-6 md:p-10 space-y-6 custom-scrollbar scroll-smooth bg-white/20",children:G.length>0?G.map($=>{const st=_.currentlyPlayingBlockId===$.id,C=_.sections.find(F=>F.id===$.sectionId);return j.jsxs("div",{id:$.id,className:`relative p-5 md:p-6 rounded-2xl transition-all duration-700 ${st?"bg-white ring-1 ring-slate-200 shadow-lg shadow-indigo-100/20 translate-x-1":"opacity-40 grayscale-[0.3]"} ${$.type===Ga.DESCRIPTION?"border-dashed border-2 border-indigo-100 bg-indigo-50/30":""}`,children:[st&&j.jsx("div",{className:"absolute -left-1 top-1/2 -translate-y-1/2 w-1 h-8 bg-indigo-600 rounded-full shadow-[0_0_10px_rgba(79,70,229,0.4)]"}),j.jsxs("div",{className:"flex items-center justify-between mb-3",children:[j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx("span",{className:`text-[9px] font-bold tracking-widest uppercase px-2 py-0.5 rounded ${$.type===Ga.DESCRIPTION?"bg-indigo-600 text-white":"bg-slate-100 text-slate-500"}`,children:$.type===Ga.DESCRIPTION?"Analysis":"Paper Text"}),C&&j.jsx("span",{className:"text-[9px] font-semibold text-indigo-600 bg-indigo-50 px-2 py-0.5 rounded",children:C.title})]}),st&&j.jsx(kb,{size:14,className:"text-indigo-600 animate-bounce"})]}),j.jsx("p",{className:`text-base md:text-lg font-['Inter'] leading-relaxed ${st?"text-slate-900 font-medium":"text-slate-600"}`,children:$.content})]},$.id)}):j.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-400 gap-4 opacity-50",children:[j.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center",children:j.jsx(Ab,{size:32,className:"animate-pulse"})}),j.jsx("p",{className:"italic text-base font-medium",children:_.status===Pt.EXTRACTING_SECTIONS?"Detecting paper sections...":"Processing sections..."})]})}),j.jsxs("div",{className:"px-6 md:px-10 py-6 md:py-8 bg-white border-t border-slate-100 flex flex-col md:flex-row items-center gap-6 shadow-[0_-10px_20px_rgba(0,0,0,0.02)]",children:[j.jsx("div",{className:"flex items-center gap-4 w-full md:w-auto justify-center",children:j.jsx("button",{onClick:_t,disabled:G.length===0,className:"w-14 h-14 md:w-16 md:h-16 bg-indigo-600 text-white rounded-2xl flex items-center justify-center hover:bg-indigo-700 hover:scale-105 active:scale-95 transition-all shadow-xl shadow-indigo-100 disabled:opacity-50 disabled:cursor-not-allowed group",children:_.status===Pt.PLAYING?j.jsx(wb,{size:28,fill:"currentColor"}):j.jsx(xb,{size:28,fill:"currentColor",className:"ml-1"})})}),j.jsxs("div",{className:"flex-1 w-full max-w-md",children:[j.jsxs("div",{className:"flex justify-between items-end mb-2 px-1",children:[j.jsx("div",{className:"flex flex-col",children:j.jsx("span",{className:"text-slate-800 text-[10px] md:text-xs font-bold uppercase tracking-wider",children:"Sections Progress"})}),j.jsxs("div",{className:"text-indigo-600 font-bold text-xs",children:[J,"/",_.sections.length," Sections"]})]}),j.jsx("div",{className:"h-1.5 w-full bg-slate-100 rounded-full overflow-hidden p-0 border border-slate-200",children:j.jsx("div",{className:"h-full bg-indigo-500 rounded-full transition-all duration-1000 ease-out shadow-[0_0_8px_rgba(79,70,229,0.2)]",style:{width:`${_.sections.length>0?J/_.sections.length*100:0}%`}})})]}),j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx(bb,{size:16,className:"text-slate-400"}),j.jsx("div",{className:"flex bg-slate-100 rounded-lg p-0.5 border border-slate-200",children:jA.map($=>j.jsx("button",{onClick:()=>z($.value),className:`px-2 py-1 text-[10px] md:text-xs font-bold rounded-md transition-all ${_.playbackSpeed===$.value?"bg-indigo-600 text-white shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:$.label},$.value))})]})]})]}),_.error&&j.jsxs("div",{className:"bg-red-50 border border-red-100 p-5 rounded-3xl flex items-center gap-4 text-red-600 shadow-sm animate-in fade-in slide-in-from-bottom duration-300",children:[j.jsx("div",{className:"p-2 bg-red-100 rounded-xl",children:j.jsx(fb,{size:24})}),j.jsxs("div",{children:[j.jsx("p",{className:"font-bold text-sm",children:"Action Required"}),j.jsx("p",{className:"text-xs font-medium opacity-80",children:_.error})]}),j.jsx("button",{onClick:()=>S($=>({...$,error:null})),className:"ml-auto text-xs font-bold bg-white px-3 py-1 rounded-lg border border-red-100",children:"Dismiss"})]})]}),j.jsxs("footer",{className:"mt-auto py-10 text-slate-400 text-xs flex flex-col items-center gap-2 w-full text-center",children:[j.jsxs("p",{className:"opacity-80",children:["Vibe coded by ",j.jsx("a",{href:"https://bhavinjawade.github.io",target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 font-semibold hover:underline",children:"Bhavin Jawade"})," with ",j.jsx("span",{className:"text-indigo-600",children:"Antigravity"})," + ",j.jsx("span",{className:"text-indigo-600",children:"Claude Opus 4.5"})]}),j.jsxs("p",{className:"opacity-60 text-[10px]",children:["LLM APIs from ",j.jsx("span",{className:"text-indigo-600",children:"OpenRouter"}),"  Speech Generation using ",j.jsx("span",{className:"text-indigo-600",children:"Deepgram"})]}),j.jsx("p",{className:"opacity-50 font-bold uppercase tracking-widest text-[9px] mt-1",children:"Your key is never sent to our servers."})]}),j.jsx("style",{children:`
        .custom-scrollbar::-webkit-scrollbar {
          width: 5px;
          height: 5px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
          background: transparent;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
          background: #e2e8f0;
          border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
          background: #cbd5e1;
        }
      `})]})},Sm=document.getElementById("root");if(!Sm)throw new Error("Could not find root element to mount to");const qA=ib.createRoot(Sm);qA.render(j.jsx(Ky.StrictMode,{children:j.jsx(GA,{})}));
